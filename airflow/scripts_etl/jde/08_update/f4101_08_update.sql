-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f4101_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[imitm] = cdc.[imitm]
	,[imlitm] = cdc.[imlitm]
	,[imlitm_conv] = cdc.[imlitm_conv]
	,[imaitm] = cdc.[imaitm]
	,[imaitm_conv] = cdc.[imaitm_conv]
	,[imdsc1] = cdc.[imdsc1]
	,[imdsc1_conv] = cdc.[imdsc1_conv]
	,[imdsc2] = cdc.[imdsc2]
	,[imdsc2_conv] = cdc.[imdsc2_conv]
	,[imsrtx] = cdc.[imsrtx]
	,[imsrtx_conv] = cdc.[imsrtx_conv]
	,[imaln] = cdc.[imaln]
	,[imaln_conv] = cdc.[imaln_conv]
	,[imsrp1] = cdc.[imsrp1]
	,[imsrp2] = cdc.[imsrp2]
	,[imsrp3] = cdc.[imsrp3]
	,[imsrp4] = cdc.[imsrp4]
	,[imsrp5] = cdc.[imsrp5]
	,[imsrp6] = cdc.[imsrp6]
	,[imsrp7] = cdc.[imsrp7]
	,[imsrp8] = cdc.[imsrp8]
	,[imsrp9] = cdc.[imsrp9]
	,[imsrp0] = cdc.[imsrp0]
	,[imprp1] = cdc.[imprp1]
	,[imprp2] = cdc.[imprp2]
	,[imprp3] = cdc.[imprp3]
	,[imprp4] = cdc.[imprp4]
	,[imprp5] = cdc.[imprp5]
	,[imprp6] = cdc.[imprp6]
	,[imprp7] = cdc.[imprp7]
	,[imprp8] = cdc.[imprp8]
	,[imprp9] = cdc.[imprp9]
	,[imprp0] = cdc.[imprp0]
	,[imcdcd] = cdc.[imcdcd]
	,[imcdcd_conv] = cdc.[imcdcd_conv]
	,[impdgr] = cdc.[impdgr]
	,[imdsgp] = cdc.[imdsgp]
	,[imprgr] = cdc.[imprgr]
	,[imrprc] = cdc.[imrprc]
	,[imorpr] = cdc.[imorpr]
	,[imbuyr] = cdc.[imbuyr]
	,[imbuyr_conv] = cdc.[imbuyr_conv]
	,[imdraw] = cdc.[imdraw]
	,[imdraw_conv] = cdc.[imdraw_conv]
	,[imrvno] = cdc.[imrvno]
	,[imrvno_conv] = cdc.[imrvno_conv]
	,[imdsze] = cdc.[imdsze]
	,[imdsze_conv] = cdc.[imdsze_conv]
	,[imvcud] = cdc.[imvcud]
	,[imvcud_conv] = cdc.[imvcud_conv]
	,[imcars] = cdc.[imcars]
	,[imcars_conv] = cdc.[imcars_conv]
	,[imcarp] = cdc.[imcarp]
	,[imcarp_conv] = cdc.[imcarp_conv]
	,[imshcn] = cdc.[imshcn]
	,[imshcm] = cdc.[imshcm]
	,[imuom1] = cdc.[imuom1]
	,[imuom2] = cdc.[imuom2]
	,[imuom3] = cdc.[imuom3]
	,[imuom4] = cdc.[imuom4]
	,[imuom6] = cdc.[imuom6]
	,[imuom8] = cdc.[imuom8]
	,[imuom9] = cdc.[imuom9]
	,[imuwum] = cdc.[imuwum]
	,[imuvm1] = cdc.[imuvm1]
	,[imsutm] = cdc.[imsutm]
	,[imumvw] = cdc.[imumvw]
	,[imcycl] = cdc.[imcycl]
	,[imglpt] = cdc.[imglpt]
	,[implev] = cdc.[implev]
	,[impplv] = cdc.[impplv]
	,[imclev] = cdc.[imclev]
	,[imprpo] = cdc.[imprpo]
	,[imckav] = cdc.[imckav]
	,[imckav_conv] = cdc.[imckav_conv]
	,[imbpfg] = cdc.[imbpfg]
	,[imsrce] = cdc.[imsrce]
	,[imot1y] = cdc.[imot1y]
	,[imot1y_conv] = cdc.[imot1y_conv]
	,[imot2y] = cdc.[imot2y]
	,[imot2y_conv] = cdc.[imot2y_conv]
	,[imstdp] = cdc.[imstdp]
	,[imstdp_conv] = cdc.[imstdp_conv]
	,[imfrmp] = cdc.[imfrmp]
	,[imfrmp_conv] = cdc.[imfrmp_conv]
	,[imthrp] = cdc.[imthrp]
	,[imthrp_conv] = cdc.[imthrp_conv]
	,[imstdg] = cdc.[imstdg]
	,[imfrgd] = cdc.[imfrgd]
	,[imthgd] = cdc.[imthgd]
	,[imcoty] = cdc.[imcoty]
	,[imstkt] = cdc.[imstkt]
	,[imlnty] = cdc.[imlnty]
	,[imlnty_conv] = cdc.[imlnty_conv]
	,[imcont] = cdc.[imcont]
	,[imcont_conv] = cdc.[imcont_conv]
	,[imback] = cdc.[imback]
	,[imback_conv] = cdc.[imback_conv]
	,[imifla] = cdc.[imifla]
	,[imtfla] = cdc.[imtfla]
	,[iminmg] = cdc.[iminmg]
	,[imabcs] = cdc.[imabcs]
	,[imabcm] = cdc.[imabcm]
	,[imabci] = cdc.[imabci]
	,[imovr] = cdc.[imovr]
	,[imovr_conv] = cdc.[imovr_conv]
	,[imwarr] = cdc.[imwarr]
	,[imwarr_conv] = cdc.[imwarr_conv]
	,[imcmcg] = cdc.[imcmcg]
	,[imcmcg_conv] = cdc.[imcmcg_conv]
	,[imsrnr] = cdc.[imsrnr]
	,[impmth] = cdc.[impmth]
	,[imfifo] = cdc.[imfifo]
	,[imfifo_conv] = cdc.[imfifo_conv]
	,[imlots] = cdc.[imlots]
	,[imsld] = cdc.[imsld]
	,[imsld_conv] = cdc.[imsld_conv]
	,[imanpl] = cdc.[imanpl]
	,[immpst] = cdc.[immpst]
	,[impctm] = cdc.[impctm]
	,[impctm_conv] = cdc.[impctm_conv]
	,[immmpc] = cdc.[immmpc]
	,[immmpc_conv] = cdc.[immmpc_conv]
	,[imptsc] = cdc.[imptsc]
	,[imsns] = cdc.[imsns]
	,[imltlv] = cdc.[imltlv]
	,[imltlv_conv] = cdc.[imltlv_conv]
	,[imltmf] = cdc.[imltmf]
	,[imltmf_conv] = cdc.[imltmf_conv]
	,[imltcm] = cdc.[imltcm]
	,[imltcm_conv] = cdc.[imltcm_conv]
	,[imopc] = cdc.[imopc]
	,[imopv] = cdc.[imopv]
	,[imopv_conv] = cdc.[imopv_conv]
	,[imacq] = cdc.[imacq]
	,[imacq_conv] = cdc.[imacq_conv]
	,[immlq] = cdc.[immlq]
	,[immlq_conv] = cdc.[immlq_conv]
	,[imltpu] = cdc.[imltpu]
	,[imltpu_conv] = cdc.[imltpu_conv]
	,[immpsp] = cdc.[immpsp]
	,[immrpp] = cdc.[immrpp]
	,[imitc] = cdc.[imitc]
	,[imordw] = cdc.[imordw]
	,[imordw_conv] = cdc.[imordw_conv]
	,[immtf1] = cdc.[immtf1]
	,[immtf1_conv] = cdc.[immtf1_conv]
	,[immtf2] = cdc.[immtf2]
	,[immtf2_conv] = cdc.[immtf2_conv]
	,[immtf3] = cdc.[immtf3]
	,[immtf3_conv] = cdc.[immtf3_conv]
	,[immtf4] = cdc.[immtf4]
	,[immtf4_conv] = cdc.[immtf4_conv]
	,[immtf5] = cdc.[immtf5]
	,[immtf5_conv] = cdc.[immtf5_conv]
	,[imexpd] = cdc.[imexpd]
	,[imexpd_conv] = cdc.[imexpd_conv]
	,[imdefd] = cdc.[imdefd]
	,[imdefd_conv] = cdc.[imdefd_conv]
	,[imsflt] = cdc.[imsflt]
	,[imsflt_conv] = cdc.[imsflt_conv]
	,[immake] = cdc.[immake]
	,[imcoby] = cdc.[imcoby]
	,[imllx] = cdc.[imllx]
	,[imcmgl] = cdc.[imcmgl]
	,[imcomh] = cdc.[imcomh]
	,[imurcd] = cdc.[imurcd]
	,[imurcd_conv] = cdc.[imurcd_conv]
	,[imurdt] = cdc.[imurdt]
	,[imurdt_conv] = cdc.[imurdt_conv]
	,[imurat] = cdc.[imurat]
	,[imurat_conv] = cdc.[imurat_conv]
	,[imurab] = cdc.[imurab]
	,[imurab_conv] = cdc.[imurab_conv]
	,[imurrf] = cdc.[imurrf]
	,[imurrf_conv] = cdc.[imurrf_conv]
	,[imuser] = cdc.[imuser]
	,[imuser_conv] = cdc.[imuser_conv]
	,[impid] = cdc.[impid]
	,[impid_conv] = cdc.[impid_conv]
	,[imjobn] = cdc.[imjobn]
	,[imjobn_conv] = cdc.[imjobn_conv]
	,[imupmj] = cdc.[imupmj]
	,[imupmj_conv] = cdc.[imupmj_conv]
	,[imtday] = cdc.[imtday]
	,[imupcn] = cdc.[imupcn]
	,[imupcn_conv] = cdc.[imupcn_conv]
	,[imscc0] = cdc.[imscc0]
	,[imscc0_conv] = cdc.[imscc0_conv]
	,[imumup] = cdc.[imumup]
	,[imumdf] = cdc.[imumdf]
	,[imums0] = cdc.[imums0]
	,[imums1] = cdc.[imums1]
	,[imums2] = cdc.[imums2]
	,[imums3] = cdc.[imums3]
	,[imums4] = cdc.[imums4]
	,[imums5] = cdc.[imums5]
	,[imums6] = cdc.[imums6]
	,[imums7] = cdc.[imums7]
	,[imums8] = cdc.[imums8]
	,[impoc] = cdc.[impoc]
	,[imavrt] = cdc.[imavrt]
	,[imavrt_conv] = cdc.[imavrt_conv]
	,[imeqty] = cdc.[imeqty]
	,[imwtrq] = cdc.[imwtrq]
	,[imwtrq_conv] = cdc.[imwtrq_conv]
	,[imtmpl] = cdc.[imtmpl]
	,[imtmpl_conv] = cdc.[imtmpl_conv]
	,[imseg1] = cdc.[imseg1]
	,[imseg1_conv] = cdc.[imseg1_conv]
	,[imseg2] = cdc.[imseg2]
	,[imseg2_conv] = cdc.[imseg2_conv]
	,[imseg3] = cdc.[imseg3]
	,[imseg3_conv] = cdc.[imseg3_conv]
	,[imseg4] = cdc.[imseg4]
	,[imseg4_conv] = cdc.[imseg4_conv]
	,[imseg5] = cdc.[imseg5]
	,[imseg5_conv] = cdc.[imseg5_conv]
	,[imseg6] = cdc.[imseg6]
	,[imseg6_conv] = cdc.[imseg6_conv]
	,[imseg7] = cdc.[imseg7]
	,[imseg7_conv] = cdc.[imseg7_conv]
	,[imseg8] = cdc.[imseg8]
	,[imseg8_conv] = cdc.[imseg8_conv]
	,[imseg9] = cdc.[imseg9]
	,[imseg9_conv] = cdc.[imseg9_conv]
	,[imseg0] = cdc.[imseg0]
	,[imseg0_conv] = cdc.[imseg0_conv]
	,[immic] = cdc.[immic]
	,[imaing] = cdc.[imaing]
	,[imaing_conv] = cdc.[imaing_conv]
	,[imbbdd] = cdc.[imbbdd]
	,[imbbdd_conv] = cdc.[imbbdd_conv]
	,[imcmdm] = cdc.[imcmdm]
	,[imlecm] = cdc.[imlecm]
	,[imledd] = cdc.[imledd]
	,[imledd_conv] = cdc.[imledd_conv]
	,[impefd] = cdc.[impefd]
	,[impefd_conv] = cdc.[impefd_conv]
	,[imsbdd] = cdc.[imsbdd]
	,[imsbdd_conv] = cdc.[imsbdd_conv]
	,[imu1dd] = cdc.[imu1dd]
	,[imu1dd_conv] = cdc.[imu1dd_conv]
	,[imu2dd] = cdc.[imu2dd]
	,[imu2dd_conv] = cdc.[imu2dd_conv]
	,[imu3dd] = cdc.[imu3dd]
	,[imu3dd_conv] = cdc.[imu3dd_conv]
	,[imu4dd] = cdc.[imu4dd]
	,[imu4dd_conv] = cdc.[imu4dd_conv]
	,[imu5dd] = cdc.[imu5dd]
	,[imu5dd_conv] = cdc.[imu5dd_conv]
	,[imdltl] = cdc.[imdltl]
	,[imdltl_conv] = cdc.[imdltl_conv]
	,[imdppo] = cdc.[imdppo]
	,[imdppo_conv] = cdc.[imdppo_conv]
	,[imdual] = cdc.[imdual]
	,[imdual_conv] = cdc.[imdual_conv]
	,[imxdck] = cdc.[imxdck]
	,[imxdck_conv] = cdc.[imxdck_conv]
	,[imlaf] = cdc.[imlaf]
	,[imlaf_conv] = cdc.[imlaf_conv]
	,[imltfm] = cdc.[imltfm]
	,[imltfm_conv] = cdc.[imltfm_conv]
	,[imrwla] = cdc.[imrwla]
	,[imrwla_conv] = cdc.[imrwla_conv]
	,[imlnpa] = cdc.[imlnpa]
	,[imlnpa_conv] = cdc.[imlnpa_conv]
	,[imlotc] = cdc.[imlotc]
	,[imlotc_conv] = cdc.[imlotc_conv]
	,[imapsc] = cdc.[imapsc]
	,[imauom] = cdc.[imauom]
	,[imauom_conv] = cdc.[imauom_conv]
	,[imconb] = cdc.[imconb]
	,[imconb_conv] = cdc.[imconb_conv]
	,[imgcmp] = cdc.[imgcmp]
	,[imgcmp_conv] = cdc.[imgcmp_conv]
	,[impri1] = cdc.[impri1]
	,[impri1_conv] = cdc.[impri1_conv]
	,[impri2] = cdc.[impri2]
	,[impri2_conv] = cdc.[impri2_conv]
	,[imashl] = cdc.[imashl]
	,[imashl_conv] = cdc.[imashl_conv]
	,[imvminv] = cdc.[imvminv]
	,[imvminv_conv] = cdc.[imvminv_conv]
	,[imcmeth] = cdc.[imcmeth]
	,[imexpi] = cdc.[imexpi]
	,[imexpi_conv] = cdc.[imexpi_conv]
	,[imopth] = cdc.[imopth]
	,[imopth_conv] = cdc.[imopth_conv]
	,[imcuth] = cdc.[imcuth]
	,[imcuth_conv] = cdc.[imcuth_conv]
	,[imumth] = cdc.[imumth]
	,[imlmfg] = cdc.[imlmfg]
	,[imlmfg_conv] = cdc.[imlmfg_conv]
	,[imline] = cdc.[imline]
	,[imline_conv] = cdc.[imline_conv]
	,[imdftpct] = cdc.[imdftpct]
	,[imdftpct_conv] = cdc.[imdftpct_conv]
	,[imkbit] = cdc.[imkbit]
	,[imkbit_conv] = cdc.[imkbit_conv]
	,[imdfenditm] = cdc.[imdfenditm]
	,[imdfenditm_conv] = cdc.[imdfenditm_conv]
	,[imkanexll] = cdc.[imkanexll]
	,[imkanexll_conv] = cdc.[imkanexll_conv]
	,[imscpsell] = cdc.[imscpsell]
	,[immopth] = cdc.[immopth]
	,[immopth_conv] = cdc.[immopth_conv]
	,[immcuth] = cdc.[immcuth]
	,[immcuth_conv] = cdc.[immcuth_conv]
	,[imcumth] = cdc.[imcumth]
	,[imatprn] = cdc.[imatprn]
	,[imatprn_conv] = cdc.[imatprn_conv]
	,[imatpca] = cdc.[imatpca]
	,[imatpac] = cdc.[imatpac]
	,[imcoore] = cdc.[imcoore]
	,[imcoore_conv] = cdc.[imcoore_conv]
	,[imvcpfc] = cdc.[imvcpfc]
	,[impnyn] = cdc.[impnyn]
	,[impnyn_conv] = cdc.[impnyn_conv] -- exclude distribution column
FROM stg_jde.tmp_upsert_f4101_cdc cdc
WHERE
    rep_jde.f4101_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f4101_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f4101_new AF:{{ task_instance_key_str }}' ) 
