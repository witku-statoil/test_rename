-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f38010_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[dndmct] = cdc.[dndmct]
	,[dndmct_conv] = cdc.[dndmct_conv]
	,[dndmcs] = cdc.[dndmcs]
	,[dndl01] = cdc.[dndl01]
	,[dndl01_conv] = cdc.[dndl01_conv]
	,[dndl02] = cdc.[dndl02]
	,[dndl02_conv] = cdc.[dndl02_conv]
	,[dndl03] = cdc.[dndl03]
	,[dndl03_conv] = cdc.[dndl03_conv]
	,[dnmcu] = cdc.[dnmcu]
	,[dnmcu_conv] = cdc.[dnmcu_conv]
	,[dnnwrn] = cdc.[dnnwrn]
	,[dnagrs] = cdc.[dnagrs]
	,[dnagrs_conv] = cdc.[dnagrs_conv]
	,[dncman] = cdc.[dncman]
	,[dncadm] = cdc.[dncadm]
	,[dnpanm] = cdc.[dnpanm]
	,[dnpanm_conv] = cdc.[dnpanm_conv]
	,[dncntd] = cdc.[dncntd]
	,[dncntd_conv] = cdc.[dncntd_conv]
	,[dndmtc] = cdc.[dndmtc]
	,[dndmpc] = cdc.[dndmpc]
	,[dndmsc] = cdc.[dndmsc]
	,[dneftj] = cdc.[dneftj]
	,[dneftj_conv] = cdc.[dneftj_conv]
	,[dnexdj] = cdc.[dnexdj]
	,[dnexdj_conv] = cdc.[dnexdj_conv]
	,[dnan8] = cdc.[dnan8]
	,[dnaagm] = cdc.[dnaagm]
	,[dnaagm_conv] = cdc.[dnaagm_conv]
	,[dnaags] = cdc.[dnaags]
	,[dnragm] = cdc.[dnragm]
	,[dnragm_conv] = cdc.[dnragm_conv]
	,[dnrags] = cdc.[dnrags]
	,[dncagm] = cdc.[dncagm]
	,[dncagm_conv] = cdc.[dncagm_conv]
	,[dncags] = cdc.[dncags]
	,[dnpagm] = cdc.[dnpagm]
	,[dnpagm_conv] = cdc.[dnpagm_conv]
	,[dnpags] = cdc.[dnpags]
	,[dnzd01] = cdc.[dnzd01]
	,[dnzd02] = cdc.[dnzd02]
	,[dnzd03] = cdc.[dnzd03]
	,[dnzd04] = cdc.[dnzd04]
	,[dnzd05] = cdc.[dnzd05]
	,[dnzd06] = cdc.[dnzd06]
	,[dnzd07] = cdc.[dnzd07]
	,[dnzd08] = cdc.[dnzd08]
	,[dnzd09] = cdc.[dnzd09]
	,[dnzd10] = cdc.[dnzd10]
	,[dnqedt] = cdc.[dnqedt]
	,[dnqedt_conv] = cdc.[dnqedt_conv]
	,[dncand] = cdc.[dncand]
	,[dncand_conv] = cdc.[dncand_conv]
	,[dncanr] = cdc.[dncanr]
	,[dnupgl] = cdc.[dnupgl]
	,[dnupgl_conv] = cdc.[dnupgl_conv]
	,[dnpras] = cdc.[dnpras]
	,[dncmoo] = cdc.[dncmoo]
	,[dncmoo_conv] = cdc.[dncmoo_conv]
	,[dncnqy] = cdc.[dncnqy]
	,[dntv01] = cdc.[dntv01]
	,[dntv01_conv] = cdc.[dntv01_conv]
	,[dntv02] = cdc.[dntv02]
	,[dntv02_conv] = cdc.[dntv02_conv]
	,[dntv03] = cdc.[dntv03]
	,[dntv03_conv] = cdc.[dntv03_conv]
	,[dnurcd] = cdc.[dnurcd]
	,[dnurcd_conv] = cdc.[dnurcd_conv]
	,[dnurdt] = cdc.[dnurdt]
	,[dnurdt_conv] = cdc.[dnurdt_conv]
	,[dnurat] = cdc.[dnurat]
	,[dnurat_conv] = cdc.[dnurat_conv]
	,[dnurab] = cdc.[dnurab]
	,[dnurab_conv] = cdc.[dnurab_conv]
	,[dnurrf] = cdc.[dnurrf]
	,[dnurrf_conv] = cdc.[dnurrf_conv]
	,[dnuser] = cdc.[dnuser]
	,[dnuser_conv] = cdc.[dnuser_conv]
	,[dnpid] = cdc.[dnpid]
	,[dnpid_conv] = cdc.[dnpid_conv]
	,[dnjobn] = cdc.[dnjobn]
	,[dnjobn_conv] = cdc.[dnjobn_conv]
	,[dnupmj] = cdc.[dnupmj]
	,[dnupmj_conv] = cdc.[dnupmj_conv]
	,[dntday] = cdc.[dntday]
	,[dnrpqt] = cdc.[dnrpqt]
	,[dnrpqt_conv] = cdc.[dnrpqt_conv]
	,[dnqed3] = cdc.[dnqed3]
	,[dnqed3_conv] = cdc.[dnqed3_conv]
	,[dnqed2] = cdc.[dnqed2]
	,[dnqed2_conv] = cdc.[dnqed2_conv] -- exclude distribution column
FROM stg_jde.tmp_upsert_f38010_cdc cdc
WHERE
    rep_jde.f38010_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f38010_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f38010_new AF:{{ task_instance_key_str }}' ) 
