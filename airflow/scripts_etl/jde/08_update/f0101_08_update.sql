-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f0101_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[aban8] = cdc.[aban8]
	,[abalky] = cdc.[abalky]
	,[abalky_conv] = cdc.[abalky_conv]
	,[abtax] = cdc.[abtax]
	,[abtax_conv] = cdc.[abtax_conv]
	,[abalph] = cdc.[abalph]
	,[abalph_conv] = cdc.[abalph_conv]
	,[abdc] = cdc.[abdc]
	,[abdc_conv] = cdc.[abdc_conv]
	,[abmcu] = cdc.[abmcu]
	,[abmcu_conv] = cdc.[abmcu_conv]
	,[absic] = cdc.[absic]
	,[ablngp] = cdc.[ablngp]
	,[abat1] = cdc.[abat1]
	,[abcm] = cdc.[abcm]
	,[abtaxc] = cdc.[abtaxc]
	,[abat2] = cdc.[abat2]
	,[abat3] = cdc.[abat3]
	,[abat4] = cdc.[abat4]
	,[abat5] = cdc.[abat5]
	,[abatp] = cdc.[abatp]
	,[abatr] = cdc.[abatr]
	,[abatpr] = cdc.[abatpr]
	,[abatpr_conv] = cdc.[abatpr_conv]
	,[abab3] = cdc.[abab3]
	,[abate] = cdc.[abate]
	,[absbli] = cdc.[absbli]
	,[abeftb] = cdc.[abeftb]
	,[abeftb_conv] = cdc.[abeftb_conv]
	,[aban81] = cdc.[aban81]
	,[aban82] = cdc.[aban82]
	,[aban83] = cdc.[aban83]
	,[aban84] = cdc.[aban84]
	,[aban86] = cdc.[aban86]
	,[aban85] = cdc.[aban85]
	,[abac01] = cdc.[abac01]
	,[abac02] = cdc.[abac02]
	,[abac03] = cdc.[abac03]
	,[abac04] = cdc.[abac04]
	,[abac05] = cdc.[abac05]
	,[abac06] = cdc.[abac06]
	,[abac07] = cdc.[abac07]
	,[abac08] = cdc.[abac08]
	,[abac09] = cdc.[abac09]
	,[abac10] = cdc.[abac10]
	,[abac11] = cdc.[abac11]
	,[abac12] = cdc.[abac12]
	,[abac13] = cdc.[abac13]
	,[abac14] = cdc.[abac14]
	,[abac15] = cdc.[abac15]
	,[abac16] = cdc.[abac16]
	,[abac17] = cdc.[abac17]
	,[abac18] = cdc.[abac18]
	,[abac19] = cdc.[abac19]
	,[abac20] = cdc.[abac20]
	,[abac21] = cdc.[abac21]
	,[abac22] = cdc.[abac22]
	,[abac23] = cdc.[abac23]
	,[abac24] = cdc.[abac24]
	,[abac25] = cdc.[abac25]
	,[abac26] = cdc.[abac26]
	,[abac27] = cdc.[abac27]
	,[abac28] = cdc.[abac28]
	,[abac29] = cdc.[abac29]
	,[abac30] = cdc.[abac30]
	,[abglba] = cdc.[abglba]
	,[abglba_conv] = cdc.[abglba_conv]
	,[abpti] = cdc.[abpti]
	,[abpdi] = cdc.[abpdi]
	,[abpdi_conv] = cdc.[abpdi_conv]
	,[abmsga] = cdc.[abmsga]
	,[abrmk] = cdc.[abrmk]
	,[abrmk_conv] = cdc.[abrmk_conv]
	,[abtxct] = cdc.[abtxct]
	,[abtxct_conv] = cdc.[abtxct_conv]
	,[abtx2] = cdc.[abtx2]
	,[abtx2_conv] = cdc.[abtx2_conv]
	,[abalp1] = cdc.[abalp1]
	,[abalp1_conv] = cdc.[abalp1_conv]
	,[aburcd] = cdc.[aburcd]
	,[aburcd_conv] = cdc.[aburcd_conv]
	,[aburdt] = cdc.[aburdt]
	,[aburdt_conv] = cdc.[aburdt_conv]
	,[aburat] = cdc.[aburat]
	,[aburat_conv] = cdc.[aburat_conv]
	,[aburab] = cdc.[aburab]
	,[aburab_conv] = cdc.[aburab_conv]
	,[aburrf] = cdc.[aburrf]
	,[aburrf_conv] = cdc.[aburrf_conv]
	,[abuser] = cdc.[abuser]
	,[abuser_conv] = cdc.[abuser_conv]
	,[abpid] = cdc.[abpid]
	,[abpid_conv] = cdc.[abpid_conv]
	,[abupmj] = cdc.[abupmj]
	,[abupmj_conv] = cdc.[abupmj_conv]
	,[abjobn] = cdc.[abjobn]
	,[abjobn_conv] = cdc.[abjobn_conv]
	,[abupmt] = cdc.[abupmt]
	,[abprgf] = cdc.[abprgf]
	,[abprgf_conv] = cdc.[abprgf_conv]
	,[absccltp] = cdc.[absccltp]
	,[abticker] = cdc.[abticker]
	,[abticker_conv] = cdc.[abticker_conv]
	,[abexchg] = cdc.[abexchg]
	,[abexchg_conv] = cdc.[abexchg_conv]
	,[abduns] = cdc.[abduns]
	,[abduns_conv] = cdc.[abduns_conv]
	,[abclass01] = cdc.[abclass01]
	,[abclass02] = cdc.[abclass02]
	,[abclass03] = cdc.[abclass03]
	,[abclass04] = cdc.[abclass04]
	,[abclass05] = cdc.[abclass05]
	,[abnoe] = cdc.[abnoe]
	,[abnoe_conv] = cdc.[abnoe_conv]
	,[abgrowthr] = cdc.[abgrowthr]
	,[abgrowthr_conv] = cdc.[abgrowthr_conv]
	,[abyearstar] = cdc.[abyearstar]
	,[abyearstar_conv] = cdc.[abyearstar_conv]
	,[abaempgp] = cdc.[abaempgp]
	,[abactin] = cdc.[abactin]
	,[abactin_conv] = cdc.[abactin_conv]
	,[abrevrng] = cdc.[abrevrng]
	,[absyncs] = cdc.[absyncs]
	,[abperrs] = cdc.[abperrs]
	,[abcaad] = cdc.[abcaad] -- exclude distribution column
FROM stg_jde.tmp_upsert_f0101_cdc cdc
WHERE
    rep_jde.f0101_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f0101_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f0101_new AF:{{ task_instance_key_str }}' ) 
