-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f4301_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[phkcoo] = cdc.[phkcoo]
	,[phkcoo_conv] = cdc.[phkcoo_conv]
	,[phdoco] = cdc.[phdoco]
	,[phdcto] = cdc.[phdcto]
	,[phsfxo] = cdc.[phsfxo]
	,[phsfxo_conv] = cdc.[phsfxo_conv]
	,[phmcu] = cdc.[phmcu]
	,[phmcu_conv] = cdc.[phmcu_conv]
	,[phokco] = cdc.[phokco]
	,[phokco_conv] = cdc.[phokco_conv]
	,[phoorn] = cdc.[phoorn]
	,[phoorn_conv] = cdc.[phoorn_conv]
	,[phocto] = cdc.[phocto]
	,[phrkco] = cdc.[phrkco]
	,[phrkco_conv] = cdc.[phrkco_conv]
	,[phrorn] = cdc.[phrorn]
	,[phrorn_conv] = cdc.[phrorn_conv]
	,[phrcto] = cdc.[phrcto]
	,[phan8] = cdc.[phan8]
	,[phshan] = cdc.[phshan]
	,[phdrqj] = cdc.[phdrqj]
	,[phdrqj_conv] = cdc.[phdrqj_conv]
	,[phtrdj] = cdc.[phtrdj]
	,[phtrdj_conv] = cdc.[phtrdj_conv]
	,[phpddj] = cdc.[phpddj]
	,[phpddj_conv] = cdc.[phpddj_conv]
	,[phopdj] = cdc.[phopdj]
	,[phopdj_conv] = cdc.[phopdj_conv]
	,[phaddj] = cdc.[phaddj]
	,[phaddj_conv] = cdc.[phaddj_conv]
	,[phcndj] = cdc.[phcndj]
	,[phcndj_conv] = cdc.[phcndj_conv]
	,[phpefj] = cdc.[phpefj]
	,[phpefj_conv] = cdc.[phpefj_conv]
	,[phppdj] = cdc.[phppdj]
	,[phppdj_conv] = cdc.[phppdj_conv]
	,[phpsdj] = cdc.[phpsdj]
	,[phpsdj_conv] = cdc.[phpsdj_conv]
	,[phvr01] = cdc.[phvr01]
	,[phvr01_conv] = cdc.[phvr01_conv]
	,[phvr02] = cdc.[phvr02]
	,[phvr02_conv] = cdc.[phvr02_conv]
	,[phdel1] = cdc.[phdel1]
	,[phdel1_conv] = cdc.[phdel1_conv]
	,[phdel2] = cdc.[phdel2]
	,[phdel2_conv] = cdc.[phdel2_conv]
	,[phrmk] = cdc.[phrmk]
	,[phrmk_conv] = cdc.[phrmk_conv]
	,[phdesc] = cdc.[phdesc]
	,[phdesc_conv] = cdc.[phdesc_conv]
	,[phinmg] = cdc.[phinmg]
	,[phasn] = cdc.[phasn]
	,[phprgp] = cdc.[phprgp]
	,[phptc] = cdc.[phptc]
	,[phptc_conv] = cdc.[phptc_conv]
	,[phexr1] = cdc.[phexr1]
	,[phtxa1] = cdc.[phtxa1]
	,[phtxa1_conv] = cdc.[phtxa1_conv]
	,[phtxct] = cdc.[phtxct]
	,[phtxct_conv] = cdc.[phtxct_conv]
	,[phhold] = cdc.[phhold]
	,[phatxt] = cdc.[phatxt]
	,[phatxt_conv] = cdc.[phatxt_conv]
	,[phinvc] = cdc.[phinvc]
	,[phinvc_conv] = cdc.[phinvc_conv]
	,[phntr] = cdc.[phntr]
	,[phcnid] = cdc.[phcnid]
	,[phcnid_conv] = cdc.[phcnid_conv]
	,[phfrth] = cdc.[phfrth]
	,[phzon] = cdc.[phzon]
	,[phanby] = cdc.[phanby]
	,[phancr] = cdc.[phancr]
	,[phmot] = cdc.[phmot]
	,[phcot] = cdc.[phcot]
	,[phrcd] = cdc.[phrcd]
	,[phfrtc] = cdc.[phfrtc]
	,[phfrtc_conv] = cdc.[phfrtc_conv]
	,[phfuf1] = cdc.[phfuf1]
	,[phfuf2] = cdc.[phfuf2]
	,[phfuf2_conv] = cdc.[phfuf2_conv]
	,[photot] = cdc.[photot]
	,[photot_conv] = cdc.[photot_conv]
	,[phpcrt] = cdc.[phpcrt]
	,[phpcrt_conv] = cdc.[phpcrt_conv]
	,[phrtnr] = cdc.[phrtnr]
	,[phrtnr_conv] = cdc.[phrtnr_conv]
	,[phwumd] = cdc.[phwumd]
	,[phvumd] = cdc.[phvumd]
	,[phpurg] = cdc.[phpurg]
	,[phpurg_conv] = cdc.[phpurg_conv]
	,[phlgct] = cdc.[phlgct]
	,[phlgct_conv] = cdc.[phlgct_conv]
	,[phprom] = cdc.[phprom]
	,[phmaty] = cdc.[phmaty]
	,[phosts] = cdc.[phosts]
	,[phosts_conv] = cdc.[phosts_conv]
	,[phavch] = cdc.[phavch]
	,[phprpy] = cdc.[phprpy]
	,[phprpy_conv] = cdc.[phprpy_conv]
	,[phcrmd] = cdc.[phcrmd]
	,[phprp5] = cdc.[phprp5]
	,[phartg] = cdc.[phartg]
	,[phartg_conv] = cdc.[phartg_conv]
	,[phcord] = cdc.[phcord]
	,[phcrrm] = cdc.[phcrrm]
	,[phcrcd] = cdc.[phcrcd]
	,[phcrcd_conv] = cdc.[phcrcd_conv]
	,[phcrr] = cdc.[phcrr]
	,[phlngp] = cdc.[phlngp]
	,[phfap] = cdc.[phfap]
	,[phfap_conv] = cdc.[phfap_conv]
	,[phorby] = cdc.[phorby]
	,[phorby_conv] = cdc.[phorby_conv]
	,[phtkby] = cdc.[phtkby]
	,[phtkby_conv] = cdc.[phtkby_conv]
	,[phurcd] = cdc.[phurcd]
	,[phurcd_conv] = cdc.[phurcd_conv]
	,[phurdt] = cdc.[phurdt]
	,[phurdt_conv] = cdc.[phurdt_conv]
	,[phurat] = cdc.[phurat]
	,[phurat_conv] = cdc.[phurat_conv]
	,[phurab] = cdc.[phurab]
	,[phurab_conv] = cdc.[phurab_conv]
	,[phurrf] = cdc.[phurrf]
	,[phurrf_conv] = cdc.[phurrf_conv]
	,[phuser] = cdc.[phuser]
	,[phuser_conv] = cdc.[phuser_conv]
	,[phpid] = cdc.[phpid]
	,[phpid_conv] = cdc.[phpid_conv]
	,[phjobn] = cdc.[phjobn]
	,[phjobn_conv] = cdc.[phjobn_conv]
	,[phupmj] = cdc.[phupmj]
	,[phupmj_conv] = cdc.[phupmj_conv]
	,[phtday] = cdc.[phtday]
	,[phrsht] = cdc.[phrsht]
	,[phrsht_conv] = cdc.[phrsht_conv]
	,[phdrqt] = cdc.[phdrqt]
	,[phdoc1] = cdc.[phdoc1]
	,[phdct4] = cdc.[phdct4]
	,[phbcrc] = cdc.[phbcrc]
	,[phbcrc_conv] = cdc.[phbcrc_conv]
	,[phmkfr] = cdc.[phmkfr]
	,[phpohp01] = cdc.[phpohp01]
	,[phpohp01_conv] = cdc.[phpohp01_conv]
	,[phpohp02] = cdc.[phpohp02]
	,[phpohp02_conv] = cdc.[phpohp02_conv]
	,[phpohp03] = cdc.[phpohp03]
	,[phpohp03_conv] = cdc.[phpohp03_conv]
	,[phpohp04] = cdc.[phpohp04]
	,[phpohp04_conv] = cdc.[phpohp04_conv]
	,[phpohp05] = cdc.[phpohp05]
	,[phpohp05_conv] = cdc.[phpohp05_conv]
	,[phpohp06] = cdc.[phpohp06]
	,[phpohp06_conv] = cdc.[phpohp06_conv]
	,[phpohp07] = cdc.[phpohp07]
	,[phpohp07_conv] = cdc.[phpohp07_conv]
	,[phpohp08] = cdc.[phpohp08]
	,[phpohp08_conv] = cdc.[phpohp08_conv]
	,[phpohp09] = cdc.[phpohp09]
	,[phpohp09_conv] = cdc.[phpohp09_conv]
	,[phpohp10] = cdc.[phpohp10]
	,[phpohp10_conv] = cdc.[phpohp10_conv]
	,[phpohp11] = cdc.[phpohp11]
	,[phpohp11_conv] = cdc.[phpohp11_conv]
	,[phpohp12] = cdc.[phpohp12]
	,[phpohp12_conv] = cdc.[phpohp12_conv]
	,[phpohc01] = cdc.[phpohc01]
	,[phpohc02] = cdc.[phpohc02]
	,[phpohc03] = cdc.[phpohc03]
	,[phpohc04] = cdc.[phpohc04]
	,[phpohc05] = cdc.[phpohc05]
	,[phpohc06] = cdc.[phpohc06]
	,[phpohc07] = cdc.[phpohc07]
	,[phpohc08] = cdc.[phpohc08]
	,[phpohc09] = cdc.[phpohc09]
	,[phpohc10] = cdc.[phpohc10]
	,[phpohc11] = cdc.[phpohc11]
	,[phpohc12] = cdc.[phpohc12]
	,[phpohd01] = cdc.[phpohd01]
	,[phpohd01_conv] = cdc.[phpohd01_conv]
	,[phpohd02] = cdc.[phpohd02]
	,[phpohd02_conv] = cdc.[phpohd02_conv]
	,[phpohab01] = cdc.[phpohab01]
	,[phpohab01_conv] = cdc.[phpohab01_conv]
	,[phpohab02] = cdc.[phpohab02]
	,[phpohab02_conv] = cdc.[phpohab02_conv]
	,[phcukid] = cdc.[phcukid]
	,[phcukid_conv] = cdc.[phcukid_conv]
	,[phpohp13] = cdc.[phpohp13]
	,[phpohp13_conv] = cdc.[phpohp13_conv]
	,[phpohu01] = cdc.[phpohu01]
	,[phpohu01_conv] = cdc.[phpohu01_conv]
	,[phpohu02] = cdc.[phpohu02]
	,[phpohu02_conv] = cdc.[phpohu02_conv]
	,[phreti] = cdc.[phreti]
	,[phreti_conv] = cdc.[phreti_conv]
	,[phclass01] = cdc.[phclass01]
	,[phclass02] = cdc.[phclass02]
	,[phclass03] = cdc.[phclass03]
	,[phclass04] = cdc.[phclass04]
	,[phclass05] = cdc.[phclass05] -- exclude distribution column
FROM stg_jde.tmp_upsert_f4301_cdc cdc
WHERE
    rep_jde.f4301_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f4301_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f4301_new AF:{{ task_instance_key_str }}' ) 
