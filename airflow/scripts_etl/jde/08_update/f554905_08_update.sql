-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f554905_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[rdmcu] = cdc.[rdmcu]
	,[rdmcu_conv] = cdc.[rdmcu_conv]
	,[rdmot] = cdc.[rdmot]
	,[rdan8] = cdc.[rdan8]
	,[rdvehi] = cdc.[rdvehi]
	,[rdvehi_conv] = cdc.[rdvehi_conv]
	,[rdrtnm] = cdc.[rdrtnm]
	,[rdcgc1] = cdc.[rdcgc1]
	,[rdcgc2] = cdc.[rdcgc2]
	,[rdfrtp] = cdc.[rdfrtp]
	,[rdrtgb] = cdc.[rdrtgb]
	,[rdrtum] = cdc.[rdrtum]
	,[rdfrcg] = cdc.[rdfrcg]
	,[rdfrcg_conv] = cdc.[rdfrcg_conv]
	,[rdeftj] = cdc.[rdeftj]
	,[rdeftj_conv] = cdc.[rdeftj_conv]
	,[rdexdj] = cdc.[rdexdj]
	,[rdexdj_conv] = cdc.[rdexdj_conv]
	,[rdcrcd] = cdc.[rdcrcd]
	,[rdcrcd_conv] = cdc.[rdcrcd_conv]
	,[rduser] = cdc.[rduser]
	,[rduser_conv] = cdc.[rduser_conv]
	,[rdpid] = cdc.[rdpid]
	,[rdpid_conv] = cdc.[rdpid_conv]
	,[rdjobn] = cdc.[rdjobn]
	,[rdjobn_conv] = cdc.[rdjobn_conv]
	,[rdupmj] = cdc.[rdupmj]
	,[rdupmj_conv] = cdc.[rdupmj_conv]
	,[rdupmt] = cdc.[rdupmt]
	,[rdurcd] = cdc.[rdurcd]
	,[rdurcd_conv] = cdc.[rdurcd_conv]
	,[rdurdt] = cdc.[rdurdt]
	,[rdurdt_conv] = cdc.[rdurdt_conv]
	,[rdurat] = cdc.[rdurat]
	,[rdurat_conv] = cdc.[rdurat_conv]
	,[rdurab] = cdc.[rdurab]
	,[rdurab_conv] = cdc.[rdurab_conv]
	,[rdurrf] = cdc.[rdurrf]
	,[rdurrf_conv] = cdc.[rdurrf_conv]
	,[rdy55char1] = cdc.[rdy55char1]
	,[rdy55char1_conv] = cdc.[rdy55char1_conv]
	,[rdy55char2] = cdc.[rdy55char2]
	,[rdy55char2_conv] = cdc.[rdy55char2_conv]
	,[rdy55date1] = cdc.[rdy55date1]
	,[rdy55date1_conv] = cdc.[rdy55date1_conv]
	,[rdy55date2] = cdc.[rdy55date2]
	,[rdy55date2_conv] = cdc.[rdy55date2_conv]
	,[rdy55strg1] = cdc.[rdy55strg1]
	,[rdy55strg1_conv] = cdc.[rdy55strg1_conv]
	,[rdy55strg2] = cdc.[rdy55strg2]
	,[rdy55strg2_conv] = cdc.[rdy55strg2_conv]
	,[rdy55time1] = cdc.[rdy55time1]
	,[rdy55time2] = cdc.[rdy55time2]
	,[rdy55amnt1] = cdc.[rdy55amnt1]
	,[rdy55amnt1_conv] = cdc.[rdy55amnt1_conv]
	,[rdy55amnt2] = cdc.[rdy55amnt2]
	,[rdy55amnt2_conv] = cdc.[rdy55amnt2_conv] -- exclude distribution column
FROM stg_jde.tmp_upsert_f554905_cdc cdc
WHERE
    rep_jde.f554905_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f554905_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f554905_new AF:{{ task_instance_key_str }}' ) 
