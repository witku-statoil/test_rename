-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f3002_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[ixtbm] = cdc.[ixtbm]
	,[ixkit] = cdc.[ixkit]
	,[ixkitl] = cdc.[ixkitl]
	,[ixkitl_conv] = cdc.[ixkitl_conv]
	,[ixkita] = cdc.[ixkita]
	,[ixkita_conv] = cdc.[ixkita_conv]
	,[ixmmcu] = cdc.[ixmmcu]
	,[ixmmcu_conv] = cdc.[ixmmcu_conv]
	,[ixitm] = cdc.[ixitm]
	,[ixlitm] = cdc.[ixlitm]
	,[ixlitm_conv] = cdc.[ixlitm_conv]
	,[ixaitm] = cdc.[ixaitm]
	,[ixaitm_conv] = cdc.[ixaitm_conv]
	,[ixcmcu] = cdc.[ixcmcu]
	,[ixcmcu_conv] = cdc.[ixcmcu_conv]
	,[ixcpnt] = cdc.[ixcpnt]
	,[ixsbnt] = cdc.[ixsbnt]
	,[ixsbnt_conv] = cdc.[ixsbnt_conv]
	,[ixprta] = cdc.[ixprta]
	,[ixprta_conv] = cdc.[ixprta_conv]
	,[ixqnty] = cdc.[ixqnty]
	,[ixqnty_conv] = cdc.[ixqnty_conv]
	,[ixum] = cdc.[ixum]
	,[ixbqty] = cdc.[ixbqty]
	,[ixbqty_conv] = cdc.[ixbqty_conv]
	,[ixuom] = cdc.[ixuom]
	,[ixfvbt] = cdc.[ixfvbt]
	,[ixfvbt_conv] = cdc.[ixfvbt_conv]
	,[ixefff] = cdc.[ixefff]
	,[ixefff_conv] = cdc.[ixefff_conv]
	,[ixefft] = cdc.[ixefft]
	,[ixefft_conv] = cdc.[ixefft_conv]
	,[ixfser] = cdc.[ixfser]
	,[ixfser_conv] = cdc.[ixfser_conv]
	,[ixtser] = cdc.[ixtser]
	,[ixtser_conv] = cdc.[ixtser_conv]
	,[ixitc] = cdc.[ixitc]
	,[ixftrc] = cdc.[ixftrc]
	,[ixftrc_conv] = cdc.[ixftrc_conv]
	,[ixoptk] = cdc.[ixoptk]
	,[ixforv] = cdc.[ixforv]
	,[ixforv_conv] = cdc.[ixforv_conv]
	,[ixcstm] = cdc.[ixcstm]
	,[ixcsmp] = cdc.[ixcsmp]
	,[ixcsmp_conv] = cdc.[ixcsmp_conv]
	,[ixordw] = cdc.[ixordw]
	,[ixordw_conv] = cdc.[ixordw_conv]
	,[ixforq] = cdc.[ixforq]
	,[ixcoby] = cdc.[ixcoby]
	,[ixcoty] = cdc.[ixcoty]
	,[ixfrmp] = cdc.[ixfrmp]
	,[ixfrmp_conv] = cdc.[ixfrmp_conv]
	,[ixthrp] = cdc.[ixthrp]
	,[ixthrp_conv] = cdc.[ixthrp_conv]
	,[ixfrgd] = cdc.[ixfrgd]
	,[ixthgd] = cdc.[ixthgd]
	,[ixopsq] = cdc.[ixopsq]
	,[ixopsq_conv] = cdc.[ixopsq_conv]
	,[ixbseq] = cdc.[ixbseq]
	,[ixbseq_conv] = cdc.[ixbseq_conv]
	,[ixftrp] = cdc.[ixftrp]
	,[ixftrp_conv] = cdc.[ixftrp_conv]
	,[ixf_2rp] = cdc.[ixf_2rp]
	,[ixf_2rp_conv] = cdc.[ixf_2rp_conv]
	,[ixrscp] = cdc.[ixrscp]
	,[ixrscp_conv] = cdc.[ixrscp_conv]
	,[ixscrp] = cdc.[ixscrp]
	,[ixscrp_conv] = cdc.[ixscrp_conv]
	,[ixrewp] = cdc.[ixrewp]
	,[ixrewp_conv] = cdc.[ixrewp_conv]
	,[ixasip] = cdc.[ixasip]
	,[ixasip_conv] = cdc.[ixasip_conv]
	,[ixcpyp] = cdc.[ixcpyp]
	,[ixcpyp_conv] = cdc.[ixcpyp_conv]
	,[ixstpp] = cdc.[ixstpp]
	,[ixstpp_conv] = cdc.[ixstpp_conv]
	,[ixlovd] = cdc.[ixlovd]
	,[ixlovd_conv] = cdc.[ixlovd_conv]
	,[ixeco] = cdc.[ixeco]
	,[ixeco_conv] = cdc.[ixeco_conv]
	,[ixecty] = cdc.[ixecty]
	,[ixecod] = cdc.[ixecod]
	,[ixecod_conv] = cdc.[ixecod_conv]
	,[ixdsc1] = cdc.[ixdsc1]
	,[ixdsc1_conv] = cdc.[ixdsc1_conv]
	,[ixlnty] = cdc.[ixlnty]
	,[ixlnty_conv] = cdc.[ixlnty_conv]
	,[ixpric] = cdc.[ixpric]
	,[ixpric_conv] = cdc.[ixpric_conv]
	,[ixuncs] = cdc.[ixuncs]
	,[ixuncs_conv] = cdc.[ixuncs_conv]
	,[ixpctk] = cdc.[ixpctk]
	,[ixpctk_conv] = cdc.[ixpctk_conv]
	,[ixshno] = cdc.[ixshno]
	,[ixshno_conv] = cdc.[ixshno_conv]
	,[ixomcu] = cdc.[ixomcu]
	,[ixomcu_conv] = cdc.[ixomcu_conv]
	,[ixobj] = cdc.[ixobj]
	,[ixobj_conv] = cdc.[ixobj_conv]
	,[ixsub] = cdc.[ixsub]
	,[ixsub_conv] = cdc.[ixsub_conv]
	,[ixbrev] = cdc.[ixbrev]
	,[ixbrev_conv] = cdc.[ixbrev_conv]
	,[ixcmrv] = cdc.[ixcmrv]
	,[ixcmrv_conv] = cdc.[ixcmrv_conv]
	,[ixrvno] = cdc.[ixrvno]
	,[ixrvno_conv] = cdc.[ixrvno_conv]
	,[ixuupg] = cdc.[ixuupg]
	,[ixurcd] = cdc.[ixurcd]
	,[ixurcd_conv] = cdc.[ixurcd_conv]
	,[ixurdt] = cdc.[ixurdt]
	,[ixurdt_conv] = cdc.[ixurdt_conv]
	,[ixurat] = cdc.[ixurat]
	,[ixurat_conv] = cdc.[ixurat_conv]
	,[ixurrf] = cdc.[ixurrf]
	,[ixurrf_conv] = cdc.[ixurrf_conv]
	,[ixurab] = cdc.[ixurab]
	,[ixurab_conv] = cdc.[ixurab_conv]
	,[ixuser] = cdc.[ixuser]
	,[ixuser_conv] = cdc.[ixuser_conv]
	,[ixpid] = cdc.[ixpid]
	,[ixpid_conv] = cdc.[ixpid_conv]
	,[ixjobn] = cdc.[ixjobn]
	,[ixjobn_conv] = cdc.[ixjobn_conv]
	,[ixupmj] = cdc.[ixupmj]
	,[ixupmj_conv] = cdc.[ixupmj_conv]
	,[ixtday] = cdc.[ixtday]
	,[ixaing] = cdc.[ixaing]
	,[ixaing_conv] = cdc.[ixaing_conv]
	,[ixsuco] = cdc.[ixsuco]
	,[ixsuco_conv] = cdc.[ixsuco_conv]
	,[ixstrc] = cdc.[ixstrc]
	,[ixstrc_conv] = cdc.[ixstrc_conv]
	,[ixendc] = cdc.[ixendc]
	,[ixendc_conv] = cdc.[ixendc_conv]
	,[ixapsc] = cdc.[ixapsc]
	,[ixcpnb] = cdc.[ixcpnb]
	,[ixcpnb_conv] = cdc.[ixcpnb_conv]
	,[ixbseqan] = cdc.[ixbseqan]
	,[ixbseqan_conv] = cdc.[ixbseqan_conv]
	,[ixbchar] = cdc.[ixbchar]
	,[ixbchar_conv] = cdc.[ixbchar_conv]
	,[ixbostr] = cdc.[ixbostr] -- exclude distribution column
FROM stg_jde.tmp_upsert_f3002_cdc cdc
WHERE
    rep_jde.f3002_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f3002_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f3002_new AF:{{ task_instance_key_str }}' ) 
