-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f554503_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[pry55qn] = cdc.[pry55qn]
	,[pry55qn_conv] = cdc.[pry55qn_conv]
	,[pry55qt] = cdc.[pry55qt]
	,[pry55qdte] = cdc.[pry55qdte]
	,[pry55qdte_conv] = cdc.[pry55qdte_conv]
	,[pry55qs] = cdc.[pry55qs]
	,[pry55quty] = cdc.[pry55quty]
	,[pry55quty_conv] = cdc.[pry55quty_conv]
	,[pruncs] = cdc.[pruncs]
	,[pruncs_conv] = cdc.[pruncs_conv]
	,[prcrcd] = cdc.[prcrcd]
	,[prcrcd_conv] = cdc.[prcrcd_conv]
	,[pruom] = cdc.[pruom]
	,[pry55avin] = cdc.[pry55avin]
	,[pry55jdqn] = cdc.[pry55jdqn]
	,[pry55jdqn_conv] = cdc.[pry55jdqn_conv]
	,[prflag] = cdc.[prflag]
	,[prflag_conv] = cdc.[prflag_conv]
	,[prurrf] = cdc.[prurrf]
	,[prurrf_conv] = cdc.[prurrf_conv]
	,[prurcd] = cdc.[prurcd]
	,[prurcd_conv] = cdc.[prurcd_conv]
	,[prurab] = cdc.[prurab]
	,[prurab_conv] = cdc.[prurab_conv]
	,[prurat] = cdc.[prurat]
	,[prurat_conv] = cdc.[prurat_conv]
	,[prurdt] = cdc.[prurdt]
	,[prurdt_conv] = cdc.[prurdt_conv]
	,[pruser] = cdc.[pruser]
	,[pruser_conv] = cdc.[pruser_conv]
	,[prpid] = cdc.[prpid]
	,[prpid_conv] = cdc.[prpid_conv]
	,[prjobn] = cdc.[prjobn]
	,[prjobn_conv] = cdc.[prjobn_conv]
	,[prupmt] = cdc.[prupmt]
	,[prupmj] = cdc.[prupmj]
	,[prupmj_conv] = cdc.[prupmj_conv]
	,[pry55char1] = cdc.[pry55char1]
	,[pry55char1_conv] = cdc.[pry55char1_conv]
	,[pry55char2] = cdc.[pry55char2]
	,[pry55char2_conv] = cdc.[pry55char2_conv]
	,[pry55date1] = cdc.[pry55date1]
	,[pry55date1_conv] = cdc.[pry55date1_conv]
	,[pry55date2] = cdc.[pry55date2]
	,[pry55date2_conv] = cdc.[pry55date2_conv]
	,[pry55strg1] = cdc.[pry55strg1]
	,[pry55strg1_conv] = cdc.[pry55strg1_conv]
	,[pry55strg2] = cdc.[pry55strg2]
	,[pry55strg2_conv] = cdc.[pry55strg2_conv]
	,[pry55time1] = cdc.[pry55time1]
	,[pry55time2] = cdc.[pry55time2]
	,[pry55amnt1] = cdc.[pry55amnt1]
	,[pry55amnt1_conv] = cdc.[pry55amnt1_conv]
	,[pry55amnt2] = cdc.[pry55amnt2]
	,[pry55amnt2_conv] = cdc.[pry55amnt2_conv] -- exclude distribution column
FROM stg_jde.tmp_upsert_f554503_cdc cdc
WHERE
    rep_jde.f554503_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f554503_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f554503_new AF:{{ task_instance_key_str }}' ) 
