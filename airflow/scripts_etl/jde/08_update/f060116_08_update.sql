-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f060116_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[yaan8] = cdc.[yaan8]
	,[yaalph] = cdc.[yaalph]
	,[yaalph_conv] = cdc.[yaalph_conv]
	,[yassn] = cdc.[yassn]
	,[yassn_conv] = cdc.[yassn_conv]
	,[yaoemp] = cdc.[yaoemp]
	,[yaoemp_conv] = cdc.[yaoemp_conv]
	,[yasex] = cdc.[yasex]
	,[yamstx] = cdc.[yamstx]
	,[yamsti] = cdc.[yamsti]
	,[yawsps] = cdc.[yawsps]
	,[yaeic] = cdc.[yaeic]
	,[yandep] = cdc.[yandep]
	,[yaest] = cdc.[yaest]
	,[yaecnt] = cdc.[yaecnt]
	,[yatarr] = cdc.[yatarr]
	,[yatarr_conv] = cdc.[yatarr_conv]
	,[yatara] = cdc.[yatara]
	,[yatara_conv] = cdc.[yatara_conv]
	,[yascdc] = cdc.[yascdc]
	,[yahmst] = cdc.[yahmst]
	,[yawkse] = cdc.[yawkse]
	,[yahmlc] = cdc.[yahmlc]
	,[yalwk1] = cdc.[yalwk1]
	,[yalwk2] = cdc.[yalwk2]
	,[yahmco] = cdc.[yahmco]
	,[yahmco_conv] = cdc.[yahmco_conv]
	,[yamcu] = cdc.[yamcu]
	,[yamcu_conv] = cdc.[yamcu_conv]
	,[yahmcu] = cdc.[yahmcu]
	,[yahmcu_conv] = cdc.[yahmcu_conv]
	,[yasg] = cdc.[yasg]
	,[yasg_conv] = cdc.[yasg_conv]
	,[yamail] = cdc.[yamail]
	,[yapast] = cdc.[yapast]
	,[yapfrq] = cdc.[yapfrq]
	,[yasaly] = cdc.[yasaly]
	,[yapycb] = cdc.[yapycb]
	,[yabcb] = cdc.[yabcb]
	,[yaun] = cdc.[yaun]
	,[yajbcd] = cdc.[yajbcd]
	,[yajbst] = cdc.[yajbst]
	,[yaeeoj] = cdc.[yaeeoj]
	,[yaeeom] = cdc.[yaeeom]
	,[yatrs] = cdc.[yatrs]
	,[yawcmp] = cdc.[yawcmp]
	,[yaflsa] = cdc.[yaflsa]
	,[yaws] = cdc.[yaws]
	,[yashft] = cdc.[yashft]
	,[yalmth] = cdc.[yalmth]
	,[yapbrt] = cdc.[yapbrt]
	,[yapbrt_conv] = cdc.[yapbrt_conv]
	,[yalf] = cdc.[yalf]
	,[yalf_conv] = cdc.[yalf_conv]
	,[yasal] = cdc.[yasal]
	,[yasal_conv] = cdc.[yasal_conv]
	,[yaphrt] = cdc.[yaphrt]
	,[yaphrt_conv] = cdc.[yaphrt_conv]
	,[yapprt] = cdc.[yapprt]
	,[yapprt_conv] = cdc.[yapprt_conv]
	,[yapwrn] = cdc.[yapwrn]
	,[yapwrn_conv] = cdc.[yapwrn_conv]
	,[yahrtn] = cdc.[yahrtn]
	,[yahrtn_conv] = cdc.[yahrtn_conv]
	,[yabrtn] = cdc.[yabrtn]
	,[yabrtn_conv] = cdc.[yabrtn_conv]
	,[yasaln] = cdc.[yasaln]
	,[yasaln_conv] = cdc.[yasaln_conv]
	,[yastdh] = cdc.[yastdh]
	,[yastdh_conv] = cdc.[yastdh_conv]
	,[yastdd] = cdc.[yastdd]
	,[yastdd_conv] = cdc.[yastdd_conv]
	,[yasdyy] = cdc.[yasdyy]
	,[yasdyy_conv] = cdc.[yasdyy_conv]
	,[yausr] = cdc.[yausr]
	,[yausr_conv] = cdc.[yausr_conv]
	,[yauflg] = cdc.[yauflg]
	,[yauflg_conv] = cdc.[yauflg_conv]
	,[yans] = cdc.[yans]
	,[yaifn] = cdc.[yaifn]
	,[yaifn_conv] = cdc.[yaifn_conv]
	,[yaimn] = cdc.[yaimn]
	,[yaimn_conv] = cdc.[yaimn_conv]
	,[yadob] = cdc.[yadob]
	,[yadob_conv] = cdc.[yadob_conv]
	,[yadsi] = cdc.[yadsi]
	,[yadsi_conv] = cdc.[yadsi_conv]
	,[yadt] = cdc.[yadt]
	,[yadt_conv] = cdc.[yadt_conv]
	,[yadst] = cdc.[yadst]
	,[yadst_conv] = cdc.[yadst_conv]
	,[yapsdt] = cdc.[yapsdt]
	,[yapsdt_conv] = cdc.[yapsdt_conv]
	,[yaptdt] = cdc.[yaptdt]
	,[yaptdt_conv] = cdc.[yaptdt_conv]
	,[yanrdt] = cdc.[yanrdt]
	,[yanrdt_conv] = cdc.[yanrdt_conv]
	,[yanbdt] = cdc.[yanbdt]
	,[yanbdt_conv] = cdc.[yanbdt_conv]
	,[yanpdt] = cdc.[yanpdt]
	,[yanpdt_conv] = cdc.[yanpdt_conv]
	,[yalcdt] = cdc.[yalcdt]
	,[yalcdt_conv] = cdc.[yalcdt_conv]
	,[yadr] = cdc.[yadr]
	,[yadr_conv] = cdc.[yadr_conv]
	,[yactdt] = cdc.[yactdt]
	,[yactdt_conv] = cdc.[yactdt_conv]
	,[yaladt] = cdc.[yaladt]
	,[yaladt_conv] = cdc.[yaladt_conv]
	,[yabsdt] = cdc.[yabsdt]
	,[yabsdt_conv] = cdc.[yabsdt_conv]
	,[yacpdt] = cdc.[yacpdt]
	,[yacpdt_conv] = cdc.[yacpdt_conv]
	,[yaficm] = cdc.[yaficm]
	,[yap001] = cdc.[yap001]
	,[yap002] = cdc.[yap002]
	,[yap003] = cdc.[yap003]
	,[yap004] = cdc.[yap004]
	,[yap005] = cdc.[yap005]
	,[yap006] = cdc.[yap006]
	,[yap007] = cdc.[yap007]
	,[yap008] = cdc.[yap008]
	,[yap009] = cdc.[yap009]
	,[yap010] = cdc.[yap010]
	,[yap011] = cdc.[yap011]
	,[yap012] = cdc.[yap012]
	,[yap013] = cdc.[yap013]
	,[yap014] = cdc.[yap014]
	,[yap015] = cdc.[yap015]
	,[yap016] = cdc.[yap016]
	,[yap017] = cdc.[yap017]
	,[yap018] = cdc.[yap018]
	,[yap019] = cdc.[yap019]
	,[yap020] = cdc.[yap020]
	,[yae001] = cdc.[yae001]
	,[yae002] = cdc.[yae002]
	,[yae003] = cdc.[yae003]
	,[yae004] = cdc.[yae004]
	,[yae005] = cdc.[yae005]
	,[yae006] = cdc.[yae006]
	,[yae007] = cdc.[yae007]
	,[yae008] = cdc.[yae008]
	,[yae009] = cdc.[yae009]
	,[yae010] = cdc.[yae010]
	,[yaicc] = cdc.[yaicc]
	,[yanmax] = cdc.[yanmax]
	,[yanmax_conv] = cdc.[yanmax_conv]
	,[yasocc] = cdc.[yasocc]
	,[yaiusr] = cdc.[yaiusr]
	,[yaiusr_conv] = cdc.[yaiusr_conv]
	,[yaitrm] = cdc.[yaitrm]
	,[yaitrm_conv] = cdc.[yaitrm_conv]
	,[yainbt] = cdc.[yainbt]
	,[yainbt_conv] = cdc.[yainbt_conv]
	,[yaregn] = cdc.[yaregn]
	,[yapstp] = cdc.[yapstp]
	,[yapstp_conv] = cdc.[yapstp_conv]
	,[yaih] = cdc.[yaih]
	,[yaih_conv] = cdc.[yaih_conv]
	,[yaccpr] = cdc.[yaccpr]
	,[yaadpn] = cdc.[yaadpn]
	,[yatcnf] = cdc.[yatcnf]
	,[yatcnf_conv] = cdc.[yatcnf_conv]
	,[yaraf] = cdc.[yaraf]
	,[yaraf_conv] = cdc.[yaraf_conv]
	,[yatipe] = cdc.[yatipe]
	,[yarccd] = cdc.[yarccd]
	,[yabdrt] = cdc.[yabdrt]
	,[yabdrt_conv] = cdc.[yabdrt_conv]
	,[yaborn] = cdc.[yaborn]
	,[yaborn_conv] = cdc.[yaborn_conv]
	,[yanbdr] = cdc.[yanbdr]
	,[yanbdr_conv] = cdc.[yanbdr_conv]
	,[yawet] = cdc.[yawet]
	,[yaaflg] = cdc.[yaaflg]
	,[yaaflg_conv] = cdc.[yaaflg_conv]
	,[yarmst] = cdc.[yarmst]
	,[yalmst] = cdc.[yalmst]
	,[yasmkr] = cdc.[yasmkr]
	,[yacbac] = cdc.[yacbac]
	,[yacbac_conv] = cdc.[yacbac_conv]
	,[yacbaf] = cdc.[yacbaf]
	,[yacbaf_conv] = cdc.[yacbaf_conv]
	,[yapccd] = cdc.[yapccd]
	,[yarcdt] = cdc.[yarcdt]
	,[yarcdt_conv] = cdc.[yarcdt_conv]
	,[yalsdt] = cdc.[yalsdt]
	,[yalsdt_conv] = cdc.[yalsdt_conv]
	,[yapadt] = cdc.[yapadt]
	,[yapadt_conv] = cdc.[yapadt_conv]
	,[yapymh] = cdc.[yapymh]
	,[yapymh_conv] = cdc.[yapymh_conv]
	,[yauyst] = cdc.[yauyst]
	,[yauyst_conv] = cdc.[yauyst_conv]
	,[yadtsp] = cdc.[yadtsp]
	,[yadtsp_conv] = cdc.[yadtsp_conv]
	,[yaann8] = cdc.[yaann8]
	,[yappnb] = cdc.[yappnb]
	,[yappnb_conv] = cdc.[yappnb_conv]
	,[yapydt] = cdc.[yapydt]
	,[yapydt_conv] = cdc.[yapydt_conv]
	,[yacben] = cdc.[yacben]
	,[yadobm] = cdc.[yadobm]
	,[yadstm] = cdc.[yadstm]
	,[yapsal] = cdc.[yapsal]
	,[yapsal_conv] = cdc.[yapsal_conv]
	,[yahipn] = cdc.[yahipn]
	,[yahipn_conv] = cdc.[yahipn_conv]
	,[yacm] = cdc.[yacm]
	,[yalsal] = cdc.[yalsal]
	,[yalsal_conv] = cdc.[yalsal_conv]
	,[yadivc] = cdc.[yadivc]
	,[yadivc_conv] = cdc.[yadivc_conv]
	,[yavshf] = cdc.[yavshf]
	,[yapyrv] = cdc.[yapyrv]
	,[yapyrv_conv] = cdc.[yapyrv_conv]
	,[yaanpa] = cdc.[yaanpa]
	,[yapgrd] = cdc.[yapgrd]
	,[yapgrd_conv] = cdc.[yapgrd_conv]
	,[yapgrs] = cdc.[yapgrs]
	,[yapgrs_conv] = cdc.[yapgrs_conv]
	,[yasloc] = cdc.[yasloc]
	,[yanrvw] = cdc.[yanrvw]
	,[yanrvw_conv] = cdc.[yanrvw_conv]
	,[yatinc] = cdc.[yatinc]
	,[yahm01] = cdc.[yahm01]
	,[yahm02] = cdc.[yahm02]
	,[yahm03] = cdc.[yahm03]
	,[yahm04] = cdc.[yahm04]
	,[yapos] = cdc.[yapos]
	,[yapos_conv] = cdc.[yapos_conv]
	,[yaed01] = cdc.[yaed01]
	,[yaed01_conv] = cdc.[yaed01_conv]
	,[yaed02] = cdc.[yaed02]
	,[yaed02_conv] = cdc.[yaed02_conv]
	,[yaed03] = cdc.[yaed03]
	,[yaed03_conv] = cdc.[yaed03_conv]
	,[yaed04] = cdc.[yaed04]
	,[yaed04_conv] = cdc.[yaed04_conv]
	,[yaed05] = cdc.[yaed05]
	,[yaed05_conv] = cdc.[yaed05_conv]
	,[yaed06] = cdc.[yaed06]
	,[yaed06_conv] = cdc.[yaed06_conv]
	,[yaed07] = cdc.[yaed07]
	,[yaed07_conv] = cdc.[yaed07_conv]
	,[yaed08] = cdc.[yaed08]
	,[yaed08_conv] = cdc.[yaed08_conv]
	,[yaed09] = cdc.[yaed09]
	,[yaed09_conv] = cdc.[yaed09_conv]
	,[yaed10] = cdc.[yaed10]
	,[yaed10_conv] = cdc.[yaed10_conv]
	,[yaed11] = cdc.[yaed11]
	,[yaed11_conv] = cdc.[yaed11_conv]
	,[yaed12] = cdc.[yaed12]
	,[yaed12_conv] = cdc.[yaed12_conv]
	,[yaed13] = cdc.[yaed13]
	,[yaed13_conv] = cdc.[yaed13_conv]
	,[yaed14] = cdc.[yaed14]
	,[yaed14_conv] = cdc.[yaed14_conv]
	,[yaed15] = cdc.[yaed15]
	,[yaed15_conv] = cdc.[yaed15_conv]
	,[yaed16] = cdc.[yaed16]
	,[yaed16_conv] = cdc.[yaed16_conv]
	,[yaed17] = cdc.[yaed17]
	,[yaed17_conv] = cdc.[yaed17_conv]
	,[yaed18] = cdc.[yaed18]
	,[yaed18_conv] = cdc.[yaed18_conv]
	,[yaed19] = cdc.[yaed19]
	,[yaed19_conv] = cdc.[yaed19_conv]
	,[yaed20] = cdc.[yaed20]
	,[yaed20_conv] = cdc.[yaed20_conv]
	,[yadept] = cdc.[yadept]
	,[yadept_conv] = cdc.[yadept_conv]
	,[yafage] = cdc.[yafage]
	,[yafsal] = cdc.[yafsal]
	,[yafsal_conv] = cdc.[yafsal_conv]
	,[yaadsd] = cdc.[yaadsd]
	,[yaadsd_conv] = cdc.[yaadsd_conv]
	,[yacmpa] = cdc.[yacmpa]
	,[yacmpa_conv] = cdc.[yacmpa_conv]
	,[yaepnt] = cdc.[yaepnt]
	,[yaepnt_conv] = cdc.[yaepnt_conv]
	,[yajobn] = cdc.[yajobn]
	,[yajobn_conv] = cdc.[yajobn_conv]
	,[yauser] = cdc.[yauser]
	,[yauser_conv] = cdc.[yauser_conv]
	,[yapid] = cdc.[yapid]
	,[yapid_conv] = cdc.[yapid_conv]
	,[yaupmj] = cdc.[yaupmj]
	,[yaupmj_conv] = cdc.[yaupmj_conv]
	,[yak001] = cdc.[yak001]
	,[yak002] = cdc.[yak002]
	,[yak003] = cdc.[yak003]
	,[yak004] = cdc.[yak004]
	,[yak005] = cdc.[yak005]
	,[yak006] = cdc.[yak006]
	,[yak007] = cdc.[yak007]
	,[yak008] = cdc.[yak008]
	,[yak009] = cdc.[yak009]
	,[yak010] = cdc.[yak010]
	,[yaatpy] = cdc.[yaatpy]
	,[yapens] = cdc.[yapens]
	,[yaorg] = cdc.[yaorg]
	,[yabens] = cdc.[yabens]
	,[yafte] = cdc.[yafte]
	,[yafte_conv] = cdc.[yafte_conv]
	,[yaaaf] = cdc.[yaaaf]
	,[yasui] = cdc.[yasui]
	,[yadtsf] = cdc.[yadtsf]
	,[yadtsf_conv] = cdc.[yadtsf_conv]
	,[yasmoy] = cdc.[yasmoy]
	,[yasmoy_conv] = cdc.[yasmoy_conv]
	,[yaldid] = cdc.[yaldid]
	,[yattar] = cdc.[yattar] -- exclude distribution column
FROM stg_jde.tmp_upsert_f060116_cdc cdc
WHERE
    rep_jde.f060116_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f060116_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f060116_new AF:{{ task_instance_key_str }}' ) 
