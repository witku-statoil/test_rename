-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f554231h_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[szan83] = cdc.[szan83]
	,[szdoc] = cdc.[szdoc]
	,[szaddj] = cdc.[szaddj]
	,[szaddj_conv] = cdc.[szaddj_conv]
	,[szcmtb] = cdc.[szcmtb]
	,[szcmtb_conv] = cdc.[szcmtb_conv]
	,[szptmb] = cdc.[szptmb]
	,[szcmte] = cdc.[szcmte]
	,[szcmte_conv] = cdc.[szcmte_conv]
	,[szptme] = cdc.[szptme]
	,[sztx1] = cdc.[sztx1]
	,[sztx1_conv] = cdc.[sztx1_conv]
	,[szlnid] = cdc.[szlnid]
	,[szlnid_conv] = cdc.[szlnid_conv]
	,[szaexp] = cdc.[szaexp]
	,[szaexp_conv] = cdc.[szaexp_conv]
	,[szuprc] = cdc.[szuprc]
	,[szuprc_conv] = cdc.[szuprc_conv]
	,[szecst] = cdc.[szecst]
	,[szecst_conv] = cdc.[szecst_conv]
	,[szlprc] = cdc.[szlprc]
	,[szlprc_conv] = cdc.[szlprc_conv]
	,[sztcst] = cdc.[sztcst]
	,[sztcst_conv] = cdc.[sztcst_conv]
	,[szaopn] = cdc.[szaopn]
	,[szaopn_conv] = cdc.[szaopn_conv]
	,[szdl02] = cdc.[szdl02]
	,[szdl02_conv] = cdc.[szdl02_conv]
	,[szdods] = cdc.[szdods]
	,[szdods_conv] = cdc.[szdods_conv]
	,[szcrcd] = cdc.[szcrcd]
	,[szcrcd_conv] = cdc.[szcrcd_conv]
	,[sztdty] = cdc.[sztdty]
	,[sztdty_conv] = cdc.[sztdty_conv]
	,[sztx2] = cdc.[sztx2]
	,[sztx2_conv] = cdc.[sztx2_conv]
	,[szan81] = cdc.[szan81]
	,[szan82] = cdc.[szan82]
	,[szafit] = cdc.[szafit]
	,[szafit_conv] = cdc.[szafit_conv]
	,[szgfl3] = cdc.[szgfl3]
	,[szgfl3_conv] = cdc.[szgfl3_conv]
	,[szlitm] = cdc.[szlitm]
	,[szlitm_conv] = cdc.[szlitm_conv]
	,[szcsht] = cdc.[szcsht]
	,[szcsht_conv] = cdc.[szcsht_conv]
	,[sztkid] = cdc.[sztkid]
	,[sztkid_conv] = cdc.[sztkid_conv]
	,[szuorg] = cdc.[szuorg]
	,[szuorg_conv] = cdc.[szuorg_conv]
	,[szukid] = cdc.[szukid]
	,[szctr] = cdc.[szctr]
	,[szaccd21] = cdc.[szaccd21]
	,[szaccd21_conv] = cdc.[szaccd21_conv]
	,[szshan] = cdc.[szshan]
	,[szan8] = cdc.[szan8]
	,[szcitm] = cdc.[szcitm]
	,[szcitm_conv] = cdc.[szcitm_conv]
	,[szvend] = cdc.[szvend]
	,[szvend_conv] = cdc.[szvend_conv]
	,[szemcu] = cdc.[szemcu]
	,[szemcu_conv] = cdc.[szemcu_conv]
	,[szmcu] = cdc.[szmcu]
	,[szmcu_conv] = cdc.[szmcu_conv]
	,[sza801] = cdc.[sza801]
	,[sza801_conv] = cdc.[sza801_conv]
	,[szlocn] = cdc.[szlocn]
	,[szlocn_conv] = cdc.[szlocn_conv]
	,[szttem] = cdc.[szttem]
	,[szttem_conv] = cdc.[szttem_conv]
	,[szstpu] = cdc.[szstpu]
	,[szdend] = cdc.[szdend]
	,[szdend_conv] = cdc.[szdend_conv]
	,[szdntp] = cdc.[szdntp]
	,[szlnty] = cdc.[szlnty]
	,[szlnty_conv] = cdc.[szlnty_conv]
	,[szgfl5] = cdc.[szgfl5]
	,[szgfl5_conv] = cdc.[szgfl5_conv]
	,[szgfl4] = cdc.[szgfl4]
	,[szgfl4_conv] = cdc.[szgfl4_conv]
	,[szgfl6] = cdc.[szgfl6]
	,[szgfl6_conv] = cdc.[szgfl6_conv]
	,[szekco] = cdc.[szekco]
	,[szekco_conv] = cdc.[szekco_conv]
	,[szedct] = cdc.[szedct]
	,[szedct_conv] = cdc.[szedct_conv]
	,[szedoc] = cdc.[szedoc]
	,[szedln] = cdc.[szedln]
	,[szedln_conv] = cdc.[szedln_conv]
	,[szedsp] = cdc.[szedsp]
	,[szedsp_conv] = cdc.[szedsp_conv]
	,[szokco] = cdc.[szokco]
	,[szokco_conv] = cdc.[szokco_conv]
	,[szoorn] = cdc.[szoorn]
	,[szoorn_conv] = cdc.[szoorn_conv]
	,[szocto] = cdc.[szocto]
	,[szogno] = cdc.[szogno]
	,[szogno_conv] = cdc.[szogno_conv]
	,[szgfl7] = cdc.[szgfl7]
	,[szgfl7_conv] = cdc.[szgfl7_conv]
	,[szkcoo] = cdc.[szkcoo]
	,[szkcoo_conv] = cdc.[szkcoo_conv]
	,[szdoco] = cdc.[szdoco]
	,[szdcto] = cdc.[szdcto]
	,[szlnic] = cdc.[szlnic]
	,[szlnic_conv] = cdc.[szlnic_conv]
	,[szgfl8] = cdc.[szgfl8]
	,[szgfl8_conv] = cdc.[szgfl8_conv]
	,[szrkco] = cdc.[szrkco]
	,[szrkco_conv] = cdc.[szrkco_conv]
	,[szrorn] = cdc.[szrorn]
	,[szrorn_conv] = cdc.[szrorn_conv]
	,[szrcto] = cdc.[szrcto]
	,[szrlln] = cdc.[szrlln]
	,[szrlln_conv] = cdc.[szrlln_conv]
	,[szgfl2] = cdc.[szgfl2]
	,[szgfl2_conv] = cdc.[szgfl2_conv]
	,[szgflag1] = cdc.[szgflag1]
	,[szgflag1_conv] = cdc.[szgflag1_conv]
	,[szgflag2] = cdc.[szgflag2]
	,[szgflag2_conv] = cdc.[szgflag2_conv]
	,[szgflg] = cdc.[szgflg]
	,[szgflg_conv] = cdc.[szgflg_conv]
	,[szdtbs] = cdc.[szdtbs]
	,[szbbdj] = cdc.[szbbdj]
	,[szbbdj_conv] = cdc.[szbbdj_conv]
	,[szecod] = cdc.[szecod]
	,[szecod_conv] = cdc.[szecod_conv]
	,[szedck] = cdc.[szedck]
	,[szedck_conv] = cdc.[szedck_conv]
	,[szurat] = cdc.[szurat]
	,[szurat_conv] = cdc.[szurat_conv]
	,[szurab] = cdc.[szurab]
	,[szurab_conv] = cdc.[szurab_conv]
	,[szurnum12] = cdc.[szurnum12]
	,[szurnum12_conv] = cdc.[szurnum12_conv]
	,[szurnum13] = cdc.[szurnum13]
	,[szurnum13_conv] = cdc.[szurnum13_conv]
	,[szaa] = cdc.[szaa]
	,[szaa_conv] = cdc.[szaa_conv]
	,[szaa1] = cdc.[szaa1]
	,[szaa1_conv] = cdc.[szaa1_conv]
	,[szaa2] = cdc.[szaa2]
	,[szaa2_conv] = cdc.[szaa2_conv]
	,[szaa3] = cdc.[szaa3]
	,[szaa3_conv] = cdc.[szaa3_conv]
	,[szdsc] = cdc.[szdsc]
	,[szdsc_conv] = cdc.[szdsc_conv]
	,[szdsc1] = cdc.[szdsc1]
	,[szdsc1_conv] = cdc.[szdsc1_conv]
	,[szdsc2] = cdc.[szdsc2]
	,[szdsc2_conv] = cdc.[szdsc2_conv]
	,[szdsc3] = cdc.[szdsc3]
	,[szdsc3_conv] = cdc.[szdsc3_conv]
	,[szdsc4] = cdc.[szdsc4]
	,[szdsc4_conv] = cdc.[szdsc4_conv]
	,[szdate01] = cdc.[szdate01]
	,[szdate01_conv] = cdc.[szdate01_conv]
	,[szdate02] = cdc.[szdate02]
	,[szdate02_conv] = cdc.[szdate02_conv]
	,[szdate03] = cdc.[szdate03]
	,[szdate03_conv] = cdc.[szdate03_conv]
	,[szdate04] = cdc.[szdate04]
	,[szdate04_conv] = cdc.[szdate04_conv]
	,[szcm01] = cdc.[szcm01]
	,[szcm01_conv] = cdc.[szcm01_conv]
	,[szcm02] = cdc.[szcm02]
	,[szcm02_conv] = cdc.[szcm02_conv]
	,[szcm03] = cdc.[szcm03]
	,[szcm03_conv] = cdc.[szcm03_conv]
	,[szcm04] = cdc.[szcm04]
	,[szcm04_conv] = cdc.[szcm04_conv]
	,[szcm05] = cdc.[szcm05]
	,[szcm05_conv] = cdc.[szcm05_conv]
	,[szedtn] = cdc.[szedtn]
	,[szedtn_conv] = cdc.[szedtn_conv]
	,[szeffutime] = cdc.[szeffutime]
	,[szeffutime_conv] = cdc.[szeffutime_conv]
	,[szeetm] = cdc.[szeetm]
	,[szeetm_conv] = cdc.[szeetm_conv]
	,[szedbt] = cdc.[szedbt]
	,[szedbt_conv] = cdc.[szedbt_conv]
	,[szgfl1] = cdc.[szgfl1]
	,[szgfl1_conv] = cdc.[szgfl1_conv]
	,[szaitm] = cdc.[szaitm]
	,[szaitm_conv] = cdc.[szaitm_conv]
	,[szy55char1] = cdc.[szy55char1]
	,[szy55char1_conv] = cdc.[szy55char1_conv]
	,[szy55char2] = cdc.[szy55char2]
	,[szy55char2_conv] = cdc.[szy55char2_conv]
	,[szy55strg1] = cdc.[szy55strg1]
	,[szy55strg1_conv] = cdc.[szy55strg1_conv]
	,[szy55strg2] = cdc.[szy55strg2]
	,[szy55strg2_conv] = cdc.[szy55strg2_conv]
	,[szy55strg3] = cdc.[szy55strg3]
	,[szy55strg3_conv] = cdc.[szy55strg3_conv]
	,[szy55strg4] = cdc.[szy55strg4]
	,[szy55strg4_conv] = cdc.[szy55strg4_conv]
	,[szy55strg5] = cdc.[szy55strg5]
	,[szy55strg5_conv] = cdc.[szy55strg5_conv]
	,[szy55amnt1] = cdc.[szy55amnt1]
	,[szy55amnt1_conv] = cdc.[szy55amnt1_conv]
	,[szy55amnt2] = cdc.[szy55amnt2]
	,[szy55amnt2_conv] = cdc.[szy55amnt2_conv]
	,[szaaq1] = cdc.[szaaq1]
	,[szaaq1_conv] = cdc.[szaaq1_conv]
	,[szaaq2] = cdc.[szaaq2]
	,[szaaq2_conv] = cdc.[szaaq2_conv]
	,[szaaq3] = cdc.[szaaq3]
	,[szaaq3_conv] = cdc.[szaaq3_conv]
	,[szaaq4] = cdc.[szaaq4]
	,[szaaq4_conv] = cdc.[szaaq4_conv]
	,[szy55time1] = cdc.[szy55time1]
	,[szy55time2] = cdc.[szy55time2]
	,[szy55date1] = cdc.[szy55date1]
	,[szy55date1_conv] = cdc.[szy55date1_conv]
	,[szy55date2] = cdc.[szy55date2]
	,[szy55date2_conv] = cdc.[szy55date2_conv]
	,[szuser] = cdc.[szuser]
	,[szuser_conv] = cdc.[szuser_conv]
	,[szupmj] = cdc.[szupmj]
	,[szupmj_conv] = cdc.[szupmj_conv]
	,[szupmt] = cdc.[szupmt]
	,[szjobn] = cdc.[szjobn]
	,[szjobn_conv] = cdc.[szjobn_conv]
	,[szpid] = cdc.[szpid]
	,[szpid_conv] = cdc.[szpid_conv] -- exclude distribution column
FROM stg_jde.tmp_upsert_f554231h_cdc cdc
WHERE
    rep_jde.f554231h_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f554231h_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f554231h_new AF:{{ task_instance_key_str }}' ) 
