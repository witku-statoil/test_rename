-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f4981_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[fhuk01] = cdc.[fhuk01]
	,[fhshpn] = cdc.[fhshpn]
	,[fhrssn] = cdc.[fhrssn]
	,[fhvmcu] = cdc.[fhvmcu]
	,[fhvmcu_conv] = cdc.[fhvmcu_conv]
	,[fhldnm] = cdc.[fhldnm]
	,[fhdlno] = cdc.[fhdlno]
	,[fhoseq] = cdc.[fhoseq]
	,[fhoseq_conv] = cdc.[fhoseq_conv]
	,[fhnmfc] = cdc.[fhnmfc]
	,[fhdsgp] = cdc.[fhdsgp]
	,[fhfrt1] = cdc.[fhfrt1]
	,[fhfrt2] = cdc.[fhfrt2]
	,[fhorgn] = cdc.[fhorgn]
	,[fhnmcu] = cdc.[fhnmcu]
	,[fhnmcu_conv] = cdc.[fhnmcu_conv]
	,[fhblpb] = cdc.[fhblpb]
	,[fhblpb_conv] = cdc.[fhblpb_conv]
	,[fhovfg] = cdc.[fhovfg]
	,[fhovfh] = cdc.[fhovfh]
	,[fhovfh_conv] = cdc.[fhovfh_conv]
	,[fhmot] = cdc.[fhmot]
	,[fhcars] = cdc.[fhcars]
	,[fhcars_conv] = cdc.[fhcars_conv]
	,[fhcamd] = cdc.[fhcamd]
	,[fhcamd_conv] = cdc.[fhcamd_conv]
	,[fhwgts] = cdc.[fhwgts]
	,[fhwgts_conv] = cdc.[fhwgts_conv]
	,[fhwtum] = cdc.[fhwtum]
	,[fhscvl] = cdc.[fhscvl]
	,[fhscvl_conv] = cdc.[fhscvl_conv]
	,[fhvlum] = cdc.[fhvlum]
	,[fhfrsc] = cdc.[fhfrsc]
	,[fhrtnm] = cdc.[fhrtnm]
	,[fhsdsq] = cdc.[fhsdsq]
	,[fhsdsq_conv] = cdc.[fhsdsq_conv]
	,[fhscsn] = cdc.[fhscsn]
	,[fhscsn_conv] = cdc.[fhscsn_conv]
	,[fhrtgb] = cdc.[fhrtgb]
	,[fhrtdq] = cdc.[fhrtdq]
	,[fhrtdq_conv] = cdc.[fhrtdq_conv]
	,[fhuom] = cdc.[fhuom]
	,[fhcgc1] = cdc.[fhcgc1]
	,[fhag] = cdc.[fhag]
	,[fhag_conv] = cdc.[fhag_conv]
	,[fhfaa] = cdc.[fhfaa]
	,[fhfaa_conv] = cdc.[fhfaa_conv]
	,[fhnamt] = cdc.[fhnamt]
	,[fhnamt_conv] = cdc.[fhnamt_conv]
	,[fhcrdc] = cdc.[fhcrdc]
	,[fhcrdc_conv] = cdc.[fhcrdc_conv]
	,[fhnamf] = cdc.[fhnamf]
	,[fhnamf_conv] = cdc.[fhnamf_conv]
	,[fhcrcd] = cdc.[fhcrcd]
	,[fhcrcd_conv] = cdc.[fhcrcd_conv]
	,[fhdoco] = cdc.[fhdoco]
	,[fhdcto] = cdc.[fhdcto]
	,[fhkcoo] = cdc.[fhkcoo]
	,[fhkcoo_conv] = cdc.[fhkcoo_conv]
	,[fhlnid] = cdc.[fhlnid]
	,[fhlnid_conv] = cdc.[fhlnid_conv]
	,[fhodoc] = cdc.[fhodoc]
	,[fhodct] = cdc.[fhodct]
	,[fhokco] = cdc.[fhokco]
	,[fhokco_conv] = cdc.[fhokco_conv]
	,[fhjeln] = cdc.[fhjeln]
	,[fhdoc] = cdc.[fhdoc]
	,[fhdct] = cdc.[fhdct]
	,[fhkco] = cdc.[fhkco]
	,[fhkco_conv] = cdc.[fhkco_conv]
	,[fhdgj] = cdc.[fhdgj]
	,[fhdgj_conv] = cdc.[fhdgj_conv]
	,[fhvinv] = cdc.[fhvinv]
	,[fhvinv_conv] = cdc.[fhvinv_conv]
	,[fhrefq] = cdc.[fhrefq]
	,[fhrefn] = cdc.[fhrefn]
	,[fhrefn_conv] = cdc.[fhrefn_conv]
	,[fhshan] = cdc.[fhshan]
	,[fhcty1] = cdc.[fhcty1]
	,[fhcty1_conv] = cdc.[fhcty1_conv]
	,[fhadds] = cdc.[fhadds]
	,[fhaddz] = cdc.[fhaddz]
	,[fhaddz_conv] = cdc.[fhaddz_conv]
	,[fhzon] = cdc.[fhzon]
	,[fhczon] = cdc.[fhczon]
	,[fhfrth] = cdc.[fhfrth]
	,[fhrtn] = cdc.[fhrtn]
	,[fhaddj] = cdc.[fhaddj]
	,[fhaddj_conv] = cdc.[fhaddj_conv]
	,[fhukid] = cdc.[fhukid]
	,[fhurcd] = cdc.[fhurcd]
	,[fhurcd_conv] = cdc.[fhurcd_conv]
	,[fhurdt] = cdc.[fhurdt]
	,[fhurdt_conv] = cdc.[fhurdt_conv]
	,[fhurat] = cdc.[fhurat]
	,[fhurat_conv] = cdc.[fhurat_conv]
	,[fhurab] = cdc.[fhurab]
	,[fhurab_conv] = cdc.[fhurab_conv]
	,[fhurrf] = cdc.[fhurrf]
	,[fhurrf_conv] = cdc.[fhurrf_conv]
	,[fhuser] = cdc.[fhuser]
	,[fhuser_conv] = cdc.[fhuser_conv]
	,[fhpid] = cdc.[fhpid]
	,[fhpid_conv] = cdc.[fhpid_conv]
	,[fhjobn] = cdc.[fhjobn]
	,[fhjobn_conv] = cdc.[fhjobn_conv]
	,[fhupmj] = cdc.[fhupmj]
	,[fhupmj_conv] = cdc.[fhupmj_conv]
	,[fhtday] = cdc.[fhtday]
	,[fhfrsn] = cdc.[fhfrsn]
	,[fhani] = cdc.[fhani]
	,[fhani_conv] = cdc.[fhani_conv]
	,[fhtxa1] = cdc.[fhtxa1]
	,[fhtxa1_conv] = cdc.[fhtxa1_conv]
	,[fhexr1] = cdc.[fhexr1]
	,[fhctyo] = cdc.[fhctyo]
	,[fhctyo_conv] = cdc.[fhctyo_conv]
	,[fhadso] = cdc.[fhadso]
	,[fhadzo] = cdc.[fhadzo]
	,[fhadzo_conv] = cdc.[fhadzo_conv]
	,[fhctro] = cdc.[fhctro]
	,[fhsct1] = cdc.[fhsct1]
	,[fhsct1_conv] = cdc.[fhsct1_conv]
	,[fhsct2] = cdc.[fhsct2]
	,[fhsct2_conv] = cdc.[fhsct2_conv]
	,[fhsct3] = cdc.[fhsct3]
	,[fhsct3_conv] = cdc.[fhsct3_conv]
	,[fhsc1o] = cdc.[fhsc1o]
	,[fhsc1o_conv] = cdc.[fhsc1o_conv]
	,[fhsc2o] = cdc.[fhsc2o]
	,[fhsc2o_conv] = cdc.[fhsc2o_conv]
	,[fhsc3o] = cdc.[fhsc3o]
	,[fhsc3o_conv] = cdc.[fhsc3o_conv]
	,[fhlnmb] = cdc.[fhlnmb]
	,[fhcnmr] = cdc.[fhcnmr]
	,[fhcnmr_conv] = cdc.[fhcnmr_conv]
	,[fhstam] = cdc.[fhstam]
	,[fhstam_conv] = cdc.[fhstam_conv]
	,[fhctam] = cdc.[fhctam]
	,[fhctam_conv] = cdc.[fhctam_conv]
	,[fhtx] = cdc.[fhtx]
	,[fhovrtax] = cdc.[fhovrtax]
	,[fhovrtax_conv] = cdc.[fhovrtax_conv]
	,[fhatxa] = cdc.[fhatxa]
	,[fhatxa_conv] = cdc.[fhatxa_conv]
	,[fhctxa] = cdc.[fhctxa]
	,[fhctxa_conv] = cdc.[fhctxa_conv] -- exclude distribution column
FROM stg_jde.tmp_upsert_f4981_cdc cdc
WHERE
    rep_jde.f4981_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f4981_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f4981_new AF:{{ task_instance_key_str }}' ) 
