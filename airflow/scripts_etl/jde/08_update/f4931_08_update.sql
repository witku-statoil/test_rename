-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f4931_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[vgvtyp] = cdc.[vgvtyp]
	,[vgvtyp_conv] = cdc.[vgvtyp_conv]
	,[vgdl01] = cdc.[vgdl01]
	,[vgdl01_conv] = cdc.[vgdl01_conv]
	,[vgmcu] = cdc.[vgmcu]
	,[vgmcu_conv] = cdc.[vgmcu_conv]
	,[vgmot] = cdc.[vgmot]
	,[vgdsgp] = cdc.[vgdsgp]
	,[vgdsgs] = cdc.[vgdsgs]
	,[vgnce] = cdc.[vgnce]
	,[vgnce_conv] = cdc.[vgnce_conv]
	,[vgwtem] = cdc.[vgwtem]
	,[vgwtem_conv] = cdc.[vgwtem_conv]
	,[vgwtca] = cdc.[vgwtca]
	,[vgwtca_conv] = cdc.[vgwtca_conv]
	,[vgwtum] = cdc.[vgwtum]
	,[vgvlcp] = cdc.[vgvlcp]
	,[vgvlcp_conv] = cdc.[vgvlcp_conv]
	,[vgvlcs] = cdc.[vgvlcs]
	,[vgvlcs_conv] = cdc.[vgvlcs_conv]
	,[vgvlum] = cdc.[vgvlum]
	,[vgcvol] = cdc.[vgcvol]
	,[vgcvol_conv] = cdc.[vgcvol_conv]
	,[vgcvum] = cdc.[vgcvum]
	,[vglcnt] = cdc.[vglcnt]
	,[vgaxle] = cdc.[vgaxle]
	,[vgaxle_conv] = cdc.[vgaxle_conv]
	,[vgwtax] = cdc.[vgwtax]
	,[vgseal] = cdc.[vgseal]
	,[vgseal_conv] = cdc.[vgseal_conv]
	,[vglnle] = cdc.[vglnle]
	,[vglnle_conv] = cdc.[vglnle_conv]
	,[vglnwe] = cdc.[vglnwe]
	,[vglnwe_conv] = cdc.[vglnwe_conv]
	,[vglnhe] = cdc.[vglnhe]
	,[vglnhe_conv] = cdc.[vglnhe_conv]
	,[vglnli] = cdc.[vglnli]
	,[vglnli_conv] = cdc.[vglnli_conv]
	,[vglnwi] = cdc.[vglnwi]
	,[vglnwi_conv] = cdc.[vglnwi_conv]
	,[vglnhr] = cdc.[vglnhr]
	,[vglnhr_conv] = cdc.[vglnhr_conv]
	,[vglnhc] = cdc.[vglnhc]
	,[vglnhc_conv] = cdc.[vglnhc_conv]
	,[vglnhf] = cdc.[vglnhf]
	,[vglnhf_conv] = cdc.[vglnhf_conv]
	,[vglhrd] = cdc.[vglhrd]
	,[vglhrd_conv] = cdc.[vglhrd_conv]
	,[vglwrd] = cdc.[vglwrd]
	,[vglwrd_conv] = cdc.[vglwrd_conv]
	,[vglhsd] = cdc.[vglhsd]
	,[vglhsd_conv] = cdc.[vglhsd_conv]
	,[vglwsd] = cdc.[vglwsd]
	,[vglwsd_conv] = cdc.[vglwsd_conv]
	,[vglnvf] = cdc.[vglnvf]
	,[vglnvf_conv] = cdc.[vglnvf_conv]
	,[vgluom] = cdc.[vgluom]
	,[vgcpfg] = cdc.[vgcpfg]
	,[vgcpfg_conv] = cdc.[vgcpfg_conv]
	,[vgbpfg] = cdc.[vgbpfg]
	,[vgmlln] = cdc.[vgmlln]
	,[vgmlln_conv] = cdc.[vgmlln_conv]
	,[vgurcd] = cdc.[vgurcd]
	,[vgurcd_conv] = cdc.[vgurcd_conv]
	,[vgurdt] = cdc.[vgurdt]
	,[vgurdt_conv] = cdc.[vgurdt_conv]
	,[vgurab] = cdc.[vgurab]
	,[vgurab_conv] = cdc.[vgurab_conv]
	,[vgurrf] = cdc.[vgurrf]
	,[vgurrf_conv] = cdc.[vgurrf_conv]
	,[vguser] = cdc.[vguser]
	,[vguser_conv] = cdc.[vguser_conv]
	,[vgpid] = cdc.[vgpid]
	,[vgpid_conv] = cdc.[vgpid_conv]
	,[vgjobn] = cdc.[vgjobn]
	,[vgjobn_conv] = cdc.[vgjobn_conv]
	,[vgupmj] = cdc.[vgupmj]
	,[vgupmj_conv] = cdc.[vgupmj_conv]
	,[vgtday] = cdc.[vgtday] -- exclude distribution column
FROM stg_jde.tmp_upsert_f4931_cdc cdc
WHERE
    rep_jde.f4931_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f4931_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f4931_new AF:{{ task_instance_key_str }}' ) 
