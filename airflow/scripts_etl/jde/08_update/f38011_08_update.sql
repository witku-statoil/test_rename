-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f38011_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[dfdmct] = cdc.[dfdmct]
	,[dfdmct_conv] = cdc.[dfdmct_conv]
	,[dfdmcs] = cdc.[dfdmcs]
	,[dfcnqy] = cdc.[dfcnqy]
	,[dfdto] = cdc.[dfdto]
	,[dfdes] = cdc.[dfdes]
	,[dfdes_conv] = cdc.[dfdes_conv]
	,[dfdesy] = cdc.[dfdesy]
	,[dfitm] = cdc.[dfitm]
	,[dfseq] = cdc.[dfseq]
	,[dfcnqt] = cdc.[dfcnqt]
	,[dfcnqt_conv] = cdc.[dfcnqt_conv]
	,[dfaa] = cdc.[dfaa]
	,[dfaa_conv] = cdc.[dfaa_conv]
	,[dfuom] = cdc.[dfuom]
	,[dfminq] = cdc.[dfminq]
	,[dfminq_conv] = cdc.[dfminq_conv]
	,[dfmaxq] = cdc.[dfmaxq]
	,[dfmaxq_conv] = cdc.[dfmaxq_conv]
	,[dfeftj] = cdc.[dfeftj]
	,[dfeftj_conv] = cdc.[dfeftj_conv]
	,[dfexdj] = cdc.[dfexdj]
	,[dfexdj_conv] = cdc.[dfexdj_conv]
	,[dfuprc] = cdc.[dfuprc]
	,[dfuprc_conv] = cdc.[dfuprc_conv]
	,[dfasn] = cdc.[dfasn]
	,[dfpasn] = cdc.[dfpasn]
	,[dfmcu] = cdc.[dfmcu]
	,[dfmcu_conv] = cdc.[dfmcu_conv]
	,[dfcrcd] = cdc.[dfcrcd]
	,[dfcrcd_conv] = cdc.[dfcrcd_conv]
	,[dftv01] = cdc.[dftv01]
	,[dftv01_conv] = cdc.[dftv01_conv]
	,[dftv02] = cdc.[dftv02]
	,[dftv02_conv] = cdc.[dftv02_conv]
	,[dftv03] = cdc.[dftv03]
	,[dftv03_conv] = cdc.[dftv03_conv]
	,[dfqty1] = cdc.[dfqty1]
	,[dfqty1_conv] = cdc.[dfqty1_conv]
	,[dftvum] = cdc.[dftvum]
	,[dfurcd] = cdc.[dfurcd]
	,[dfurcd_conv] = cdc.[dfurcd_conv]
	,[dfurdt] = cdc.[dfurdt]
	,[dfurdt_conv] = cdc.[dfurdt_conv]
	,[dfurat] = cdc.[dfurat]
	,[dfurat_conv] = cdc.[dfurat_conv]
	,[dfurab] = cdc.[dfurab]
	,[dfurab_conv] = cdc.[dfurab_conv]
	,[dfurrf] = cdc.[dfurrf]
	,[dfurrf_conv] = cdc.[dfurrf_conv]
	,[dfuser] = cdc.[dfuser]
	,[dfuser_conv] = cdc.[dfuser_conv]
	,[dfpid] = cdc.[dfpid]
	,[dfpid_conv] = cdc.[dfpid_conv]
	,[dfjobn] = cdc.[dfjobn]
	,[dfjobn_conv] = cdc.[dfjobn_conv]
	,[dfupmj] = cdc.[dfupmj]
	,[dfupmj_conv] = cdc.[dfupmj_conv]
	,[dftday] = cdc.[dftday]
	,[dfrpqt] = cdc.[dfrpqt]
	,[dfrpqt_conv] = cdc.[dfrpqt_conv]
	,[dfqedt] = cdc.[dfqedt]
	,[dfqedt_conv] = cdc.[dfqedt_conv]
	,[dfqed3] = cdc.[dfqed3]
	,[dfqed3_conv] = cdc.[dfqed3_conv]
	,[dfqed2] = cdc.[dfqed2]
	,[dfqed2_conv] = cdc.[dfqed2_conv]
	,[dfpdp5] = cdc.[dfpdp5] -- exclude distribution column
FROM stg_jde.tmp_upsert_f38011_cdc cdc
WHERE
    rep_jde.f38011_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f38011_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f38011_new AF:{{ task_instance_key_str }}' ) 
