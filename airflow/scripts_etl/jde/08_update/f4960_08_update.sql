-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f4960_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[tmvmcu] = cdc.[tmvmcu]
	,[tmvmcu_conv] = cdc.[tmvmcu_conv]
	,[tmldnm] = cdc.[tmldnm]
	,[tmnmcu] = cdc.[tmnmcu]
	,[tmnmcu_conv] = cdc.[tmnmcu_conv]
	,[tmorgn] = cdc.[tmorgn]
	,[tmmcux] = cdc.[tmmcux]
	,[tmmcux_conv] = cdc.[tmmcux_conv]
	,[tmancc] = cdc.[tmancc]
	,[tmanid] = cdc.[tmanid]
	,[tmovod] = cdc.[tmovod]
	,[tmcty1] = cdc.[tmcty1]
	,[tmcty1_conv] = cdc.[tmcty1_conv]
	,[tmadds] = cdc.[tmadds]
	,[tmaddz] = cdc.[tmaddz]
	,[tmaddz_conv] = cdc.[tmaddz_conv]
	,[tmctr] = cdc.[tmctr]
	,[tmzon] = cdc.[tmzon]
	,[tmldty] = cdc.[tmldty]
	,[tmldls] = cdc.[tmldls]
	,[tmload] = cdc.[tmload]
	,[tmload_conv] = cdc.[tmload_conv]
	,[tmshft] = cdc.[tmshft]
	,[tmseq] = cdc.[tmseq]
	,[tmtmls] = cdc.[tmtmls]
	,[tmppdj] = cdc.[tmppdj]
	,[tmppdj_conv] = cdc.[tmppdj_conv]
	,[tmpmdt] = cdc.[tmpmdt]
	,[tmaddj] = cdc.[tmaddj]
	,[tmaddj_conv] = cdc.[tmaddj_conv]
	,[tmadtm] = cdc.[tmadtm]
	,[tmmot] = cdc.[tmmot]
	,[tmovrm] = cdc.[tmovrm]
	,[tmovrm_conv] = cdc.[tmovrm_conv]
	,[tmvtyp] = cdc.[tmvtyp]
	,[tmvtyp_conv] = cdc.[tmvtyp_conv]
	,[tmpveh] = cdc.[tmpveh]
	,[tmpveh_conv] = cdc.[tmpveh_conv]
	,[tmrlno] = cdc.[tmrlno]
	,[tmrlno_conv] = cdc.[tmrlno_conv]
	,[tmdumv] = cdc.[tmdumv]
	,[tmdumv_conv] = cdc.[tmdumv_conv]
	,[tmcnnv] = cdc.[tmcnnv]
	,[tmcnnv_conv] = cdc.[tmcnnv_conv]
	,[tmcars] = cdc.[tmcars]
	,[tmcars_conv] = cdc.[tmcars_conv]
	,[tmovrc] = cdc.[tmovrc]
	,[tmovrc_conv] = cdc.[tmovrc_conv]
	,[tmrout] = cdc.[tmrout]
	,[tmrtn] = cdc.[tmrtn]
	,[tmfrsc] = cdc.[tmfrsc]
	,[tmczon] = cdc.[tmczon]
	,[tmdsgp] = cdc.[tmdsgp]
	,[tmdaty] = cdc.[tmdaty]
	,[tmdscd] = cdc.[tmdscd]
	,[tmldle] = cdc.[tmldle]
	,[tmldle_conv] = cdc.[tmldle_conv]
	,[tmseal] = cdc.[tmseal]
	,[tmseal_conv] = cdc.[tmseal_conv]
	,[tmlmcu] = cdc.[tmlmcu]
	,[tmlmcu_conv] = cdc.[tmlmcu_conv]
	,[tmltrp] = cdc.[tmltrp]
	,[tmdstn] = cdc.[tmdstn]
	,[tmumd1] = cdc.[tmumd1]
	,[tmdsrc] = cdc.[tmdsrc]
	,[tmodst] = cdc.[tmodst]
	,[tmeltm] = cdc.[tmeltm]
	,[tmum] = cdc.[tmum]
	,[tmcvum] = cdc.[tmcvum]
	,[tmwtum] = cdc.[tmwtum]
	,[tmvlum] = cdc.[tmvlum]
	,[tmvr01] = cdc.[tmvr01]
	,[tmvr01_conv] = cdc.[tmvr01_conv]
	,[tmnstp] = cdc.[tmnstp]
	,[tmnstp_conv] = cdc.[tmnstp_conv]
	,[tmrrtr] = cdc.[tmrrtr]
	,[tmratr] = cdc.[tmratr]
	,[tmfrvc] = cdc.[tmfrvc]
	,[tmfrvc_conv] = cdc.[tmfrvc_conv]
	,[tmfrvf] = cdc.[tmfrvf]
	,[tmfrvf_conv] = cdc.[tmfrvf_conv]
	,[tmcrcp] = cdc.[tmcrcp]
	,[tmcrcp_conv] = cdc.[tmcrcp_conv]
	,[tmibrs] = cdc.[tmibrs]
	,[tmibrs_conv] = cdc.[tmibrs_conv]
	,[tmdkid] = cdc.[tmdkid]
	,[tmdkid_conv] = cdc.[tmdkid_conv]
	,[tmdepu] = cdc.[tmdepu]
	,[tmdepu_conv] = cdc.[tmdepu_conv]
	,[tmdlpu] = cdc.[tmdlpu]
	,[tmdlpu_conv] = cdc.[tmdlpu_conv]
	,[tmtpuf] = cdc.[tmtpuf]
	,[tmtput] = cdc.[tmtput]
	,[tmlslt] = cdc.[tmlslt]
	,[tmlsut] = cdc.[tmlsut]
	,[tmlalt] = cdc.[tmlalt]
	,[tmlaut] = cdc.[tmlaut]
	,[tmurcd] = cdc.[tmurcd]
	,[tmurcd_conv] = cdc.[tmurcd_conv]
	,[tmurdt] = cdc.[tmurdt]
	,[tmurdt_conv] = cdc.[tmurdt_conv]
	,[tmurat] = cdc.[tmurat]
	,[tmurat_conv] = cdc.[tmurat_conv]
	,[tmurab] = cdc.[tmurab]
	,[tmurab_conv] = cdc.[tmurab_conv]
	,[tmurrf] = cdc.[tmurrf]
	,[tmurrf_conv] = cdc.[tmurrf_conv]
	,[tmuser] = cdc.[tmuser]
	,[tmuser_conv] = cdc.[tmuser_conv]
	,[tmpid] = cdc.[tmpid]
	,[tmpid_conv] = cdc.[tmpid_conv]
	,[tmjobn] = cdc.[tmjobn]
	,[tmjobn_conv] = cdc.[tmjobn_conv]
	,[tmupmj] = cdc.[tmupmj]
	,[tmupmj_conv] = cdc.[tmupmj_conv]
	,[tmtday] = cdc.[tmtday] -- exclude distribution column
FROM stg_jde.tmp_upsert_f4960_cdc cdc
WHERE
    rep_jde.f4960_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f4960_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f4960_new AF:{{ task_instance_key_str }}' ) 
