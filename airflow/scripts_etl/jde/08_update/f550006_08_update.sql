-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f550006_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[pmy55prmcd] = cdc.[pmy55prmcd]
	,[pmprnumb] = cdc.[pmprnumb]
	,[pmy55prmty] = cdc.[pmy55prmty]
	,[pmy55cmpcd] = cdc.[pmy55cmpcd]
	,[pmcmpid] = cdc.[pmcmpid]
	,[pmcmpid_conv] = cdc.[pmcmpid_conv]
	,[pmdl01] = cdc.[pmdl01]
	,[pmdl01_conv] = cdc.[pmdl01_conv]
	,[pmlngp1] = cdc.[pmlngp1]
	,[pmstrt] = cdc.[pmstrt]
	,[pmstrt_conv] = cdc.[pmstrt_conv]
	,[pmwwast] = cdc.[pmwwast]
	,[pmwwast_conv] = cdc.[pmwwast_conv]
	,[pmwwaet] = cdc.[pmwwaet]
	,[pmwwaet_conv] = cdc.[pmwwaet_conv]
	,[pmenddj] = cdc.[pmenddj]
	,[pmenddj_conv] = cdc.[pmenddj_conv]
	,[pmctr] = cdc.[pmctr]
	,[pmcrcd] = cdc.[pmcrcd]
	,[pmcrcd_conv] = cdc.[pmcrcd_conv]
	,[pmtxky] = cdc.[pmtxky]
	,[pmtxky_conv] = cdc.[pmtxky_conv]
	,[pmy55dur] = cdc.[pmy55dur]
	,[pmy55hrs] = cdc.[pmy55hrs]
	,[pmy55prity] = cdc.[pmy55prity]
	,[pmy55plcmt] = cdc.[pmy55plcmt]
	,[pmy55sldts] = cdc.[pmy55sldts]
	,[pmy55sldts_conv] = cdc.[pmy55sldts_conv]
	,[pmy55sldte] = cdc.[pmy55sldte]
	,[pmy55sldte_conv] = cdc.[pmy55sldte_conv]
	,[pmy55prdts] = cdc.[pmy55prdts]
	,[pmy55prdts_conv] = cdc.[pmy55prdts_conv]
	,[pmy55prdte] = cdc.[pmy55prdte]
	,[pmy55prdte_conv] = cdc.[pmy55prdte_conv]
	,[pmy55cpflg] = cdc.[pmy55cpflg]
	,[pmy55cpflg_conv] = cdc.[pmy55cpflg_conv]
	,[pmy55cptyp] = cdc.[pmy55cptyp]
	,[pmy55srst] = cdc.[pmy55srst]
	,[pmy55ntst] = cdc.[pmy55ntst]
	,[pmy55psusd] = cdc.[pmy55psusd]
	,[pmy55psusd_conv] = cdc.[pmy55psusd_conv]
	,[pmy55pcand] = cdc.[pmy55pcand]
	,[pmy55pcand_conv] = cdc.[pmy55pcand_conv]
	,[pmurab] = cdc.[pmurab]
	,[pmurab_conv] = cdc.[pmurab_conv]
	,[pmurrf] = cdc.[pmurrf]
	,[pmurrf_conv] = cdc.[pmurrf_conv]
	,[pmurdt] = cdc.[pmurdt]
	,[pmurdt_conv] = cdc.[pmurdt_conv]
	,[pmurat] = cdc.[pmurat]
	,[pmurat_conv] = cdc.[pmurat_conv]
	,[pmurcd] = cdc.[pmurcd]
	,[pmurcd_conv] = cdc.[pmurcd_conv]
	,[pmcrtu] = cdc.[pmcrtu]
	,[pmcrtu_conv] = cdc.[pmcrtu_conv]
	,[pmcrdj] = cdc.[pmcrdj]
	,[pmcrdj_conv] = cdc.[pmcrdj_conv]
	,[pmc9crp] = cdc.[pmc9crp]
	,[pmc9crp_conv] = cdc.[pmc9crp_conv]
	,[pmupmj] = cdc.[pmupmj]
	,[pmupmj_conv] = cdc.[pmupmj_conv]
	,[pmupmt] = cdc.[pmupmt]
	,[pmjobn] = cdc.[pmjobn]
	,[pmjobn_conv] = cdc.[pmjobn_conv]
	,[pmpid] = cdc.[pmpid]
	,[pmpid_conv] = cdc.[pmpid_conv]
	,[pmuser] = cdc.[pmuser]
	,[pmuser_conv] = cdc.[pmuser_conv]
	,[pmy55alapr] = cdc.[pmy55alapr]
	,[pmy55alapr_conv] = cdc.[pmy55alapr_conv]
	,[pmy55strg1] = cdc.[pmy55strg1]
	,[pmy55strg1_conv] = cdc.[pmy55strg1_conv]
	,[pmy55char1] = cdc.[pmy55char1]
	,[pmy55char1_conv] = cdc.[pmy55char1_conv]
	,[pmy55char2] = cdc.[pmy55char2]
	,[pmy55char2_conv] = cdc.[pmy55char2_conv]
	,[pmy55strg2] = cdc.[pmy55strg2]
	,[pmy55strg2_conv] = cdc.[pmy55strg2_conv]
	,[pmy55amnt1] = cdc.[pmy55amnt1]
	,[pmy55amnt1_conv] = cdc.[pmy55amnt1_conv]
	,[pmy55amnt2] = cdc.[pmy55amnt2]
	,[pmy55amnt2_conv] = cdc.[pmy55amnt2_conv]
	,[pmy55time1] = cdc.[pmy55time1]
	,[pmy55time2] = cdc.[pmy55time2]
	,[pmy55date1] = cdc.[pmy55date1]
	,[pmy55date1_conv] = cdc.[pmy55date1_conv]
	,[pmy55date2] = cdc.[pmy55date2]
	,[pmy55date2_conv] = cdc.[pmy55date2_conv] -- exclude distribution column
FROM stg_jde.tmp_upsert_f550006_cdc cdc
WHERE
    rep_jde.f550006_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f550006_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f550006_new AF:{{ task_instance_key_str }}' ) 
