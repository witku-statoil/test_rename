-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f1202_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[flaid] = cdc.[flaid]
	,[flaid_conv] = cdc.[flaid_conv]
	,[flctry] = cdc.[flctry]
	,[flfy] = cdc.[flfy]
	,[flfy_conv] = cdc.[flfy_conv]
	,[flfq] = cdc.[flfq]
	,[fllt] = cdc.[fllt]
	,[flsbl] = cdc.[flsbl]
	,[flsbl_conv] = cdc.[flsbl_conv]
	,[flco] = cdc.[flco]
	,[flco_conv] = cdc.[flco_conv]
	,[flapyc] = cdc.[flapyc]
	,[flapyc_conv] = cdc.[flapyc_conv]
	,[flan01] = cdc.[flan01]
	,[flan01_conv] = cdc.[flan01_conv]
	,[flan02] = cdc.[flan02]
	,[flan02_conv] = cdc.[flan02_conv]
	,[flan03] = cdc.[flan03]
	,[flan03_conv] = cdc.[flan03_conv]
	,[flan04] = cdc.[flan04]
	,[flan04_conv] = cdc.[flan04_conv]
	,[flan05] = cdc.[flan05]
	,[flan05_conv] = cdc.[flan05_conv]
	,[flan06] = cdc.[flan06]
	,[flan06_conv] = cdc.[flan06_conv]
	,[flan07] = cdc.[flan07]
	,[flan07_conv] = cdc.[flan07_conv]
	,[flan08] = cdc.[flan08]
	,[flan08_conv] = cdc.[flan08_conv]
	,[flan09] = cdc.[flan09]
	,[flan09_conv] = cdc.[flan09_conv]
	,[flan10] = cdc.[flan10]
	,[flan10_conv] = cdc.[flan10_conv]
	,[flan11] = cdc.[flan11]
	,[flan11_conv] = cdc.[flan11_conv]
	,[flan12] = cdc.[flan12]
	,[flan12_conv] = cdc.[flan12_conv]
	,[flan13] = cdc.[flan13]
	,[flan13_conv] = cdc.[flan13_conv]
	,[flan14] = cdc.[flan14]
	,[flan14_conv] = cdc.[flan14_conv]
	,[flapyn] = cdc.[flapyn]
	,[flapyn_conv] = cdc.[flapyn_conv]
	,[flawtd] = cdc.[flawtd]
	,[flawtd_conv] = cdc.[flawtd_conv]
	,[flborg] = cdc.[flborg]
	,[flborg_conv] = cdc.[flborg_conv]
	,[flpou] = cdc.[flpou]
	,[flpou_conv] = cdc.[flpou_conv]
	,[flpc] = cdc.[flpc]
	,[fltker] = cdc.[fltker]
	,[fltker_conv] = cdc.[fltker_conv]
	,[flbreq] = cdc.[flbreq]
	,[flbreq_conv] = cdc.[flbreq_conv]
	,[flbapr] = cdc.[flbapr]
	,[flbapr_conv] = cdc.[flbapr_conv]
	,[flmcu] = cdc.[flmcu]
	,[flmcu_conv] = cdc.[flmcu_conv]
	,[flobj] = cdc.[flobj]
	,[flobj_conv] = cdc.[flobj_conv]
	,[flsub] = cdc.[flsub]
	,[flsub_conv] = cdc.[flsub_conv]
	,[flnumb] = cdc.[flnumb]
	,[fladlm] = cdc.[fladlm]
	,[fladm] = cdc.[fladm]
	,[flitac] = cdc.[flitac]
	,[fladmp] = cdc.[fladmp]
	,[fladsn] = cdc.[fladsn]
	,[fladsn_conv] = cdc.[fladsn_conv]
	,[fldir1] = cdc.[fldir1]
	,[fldsd] = cdc.[fldsd]
	,[fldsd_conv] = cdc.[fldsd_conv]
	,[fluser] = cdc.[fluser]
	,[fluser_conv] = cdc.[fluser_conv]
	,[fllct] = cdc.[fllct]
	,[fllct_conv] = cdc.[fllct_conv]
	,[flpid] = cdc.[flpid]
	,[flpid_conv] = cdc.[flpid_conv]
	,[flsblt] = cdc.[flsblt]
	,[flcrcd] = cdc.[flcrcd]
	,[flcrcd_conv] = cdc.[flcrcd_conv]
	,[flupmj] = cdc.[flupmj]
	,[flupmj_conv] = cdc.[flupmj_conv]
	,[fljobn] = cdc.[fljobn]
	,[fljobn_conv] = cdc.[fljobn_conv]
	,[flupmt] = cdc.[flupmt]
	,[flchcd] = cdc.[flchcd]
	,[fldpcf] = cdc.[fldpcf]
	,[fldpcf_conv] = cdc.[fldpcf_conv]
	,[flcbxr] = cdc.[flcbxr] -- exclude distribution column
FROM stg_jde.tmp_upsert_f1202_cdc cdc
WHERE
    rep_jde.f1202_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f1202_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f1202_new AF:{{ task_instance_key_str }}' ) 
