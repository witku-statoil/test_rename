-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f4229_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[ssdcto] = cdc.[ssdcto]
	,[sslnty] = cdc.[sslnty]
	,[sslnty_conv] = cdc.[sslnty_conv]
	,[ssan8] = cdc.[ssan8]
	,[ssitm] = cdc.[ssitm]
	,[sslitm] = cdc.[sslitm]
	,[sslitm_conv] = cdc.[sslitm_conv]
	,[ssaitm] = cdc.[ssaitm]
	,[ssaitm_conv] = cdc.[ssaitm_conv]
	,[ssmcu] = cdc.[ssmcu]
	,[ssmcu_conv] = cdc.[ssmcu_conv]
	,[sssrp1] = cdc.[sssrp1]
	,[sssrp2] = cdc.[sssrp2]
	,[sssrp3] = cdc.[sssrp3]
	,[sssrp4] = cdc.[sssrp4]
	,[sssrp5] = cdc.[sssrp5]
	,[ssctry] = cdc.[ssctry]
	,[ssfy] = cdc.[ssfy]
	,[ssfy_conv] = cdc.[ssfy_conv]
	,[ssfq] = cdc.[ssfq]
	,[sscms] = cdc.[sscms]
	,[sscms_conv] = cdc.[sscms_conv]
	,[sscmc] = cdc.[sscmc]
	,[sscmc_conv] = cdc.[sscmc_conv]
	,[sscys] = cdc.[sscys]
	,[sscys_conv] = cdc.[sscys_conv]
	,[sscyc] = cdc.[sscyc]
	,[sscyc_conv] = cdc.[sscyc_conv]
	,[sspyes] = cdc.[sspyes]
	,[sspyes_conv] = cdc.[sspyes_conv]
	,[sspyec] = cdc.[sspyec]
	,[sspyec_conv] = cdc.[sspyec_conv]
	,[ssqs01] = cdc.[ssqs01]
	,[ssqs01_conv] = cdc.[ssqs01_conv]
	,[ssqs02] = cdc.[ssqs02]
	,[ssqs02_conv] = cdc.[ssqs02_conv]
	,[ssqs03] = cdc.[ssqs03]
	,[ssqs03_conv] = cdc.[ssqs03_conv]
	,[ssqs04] = cdc.[ssqs04]
	,[ssqs04_conv] = cdc.[ssqs04_conv]
	,[ssqs05] = cdc.[ssqs05]
	,[ssqs05_conv] = cdc.[ssqs05_conv]
	,[ssqs06] = cdc.[ssqs06]
	,[ssqs06_conv] = cdc.[ssqs06_conv]
	,[ssqs07] = cdc.[ssqs07]
	,[ssqs07_conv] = cdc.[ssqs07_conv]
	,[ssqs08] = cdc.[ssqs08]
	,[ssqs08_conv] = cdc.[ssqs08_conv]
	,[ssqs09] = cdc.[ssqs09]
	,[ssqs09_conv] = cdc.[ssqs09_conv]
	,[ssqs10] = cdc.[ssqs10]
	,[ssqs10_conv] = cdc.[ssqs10_conv]
	,[ssqs11] = cdc.[ssqs11]
	,[ssqs11_conv] = cdc.[ssqs11_conv]
	,[ssqs12] = cdc.[ssqs12]
	,[ssqs12_conv] = cdc.[ssqs12_conv]
	,[ssqs13] = cdc.[ssqs13]
	,[ssqs13_conv] = cdc.[ssqs13_conv]
	,[ssqs14] = cdc.[ssqs14]
	,[ssqs14_conv] = cdc.[ssqs14_conv]
	,[ssci01] = cdc.[ssci01]
	,[ssci01_conv] = cdc.[ssci01_conv]
	,[ssci02] = cdc.[ssci02]
	,[ssci02_conv] = cdc.[ssci02_conv]
	,[ssci03] = cdc.[ssci03]
	,[ssci03_conv] = cdc.[ssci03_conv]
	,[ssci04] = cdc.[ssci04]
	,[ssci04_conv] = cdc.[ssci04_conv]
	,[ssci05] = cdc.[ssci05]
	,[ssci05_conv] = cdc.[ssci05_conv]
	,[ssci06] = cdc.[ssci06]
	,[ssci06_conv] = cdc.[ssci06_conv]
	,[ssci07] = cdc.[ssci07]
	,[ssci07_conv] = cdc.[ssci07_conv]
	,[ssci08] = cdc.[ssci08]
	,[ssci08_conv] = cdc.[ssci08_conv]
	,[ssci09] = cdc.[ssci09]
	,[ssci09_conv] = cdc.[ssci09_conv]
	,[ssci10] = cdc.[ssci10]
	,[ssci10_conv] = cdc.[ssci10_conv]
	,[ssci11] = cdc.[ssci11]
	,[ssci11_conv] = cdc.[ssci11_conv]
	,[ssci12] = cdc.[ssci12]
	,[ssci12_conv] = cdc.[ssci12_conv]
	,[ssci13] = cdc.[ssci13]
	,[ssci13_conv] = cdc.[ssci13_conv]
	,[ssci14] = cdc.[ssci14]
	,[ssci14_conv] = cdc.[ssci14_conv]
	,[ssas01] = cdc.[ssas01]
	,[ssas01_conv] = cdc.[ssas01_conv]
	,[ssas02] = cdc.[ssas02]
	,[ssas02_conv] = cdc.[ssas02_conv]
	,[ssas03] = cdc.[ssas03]
	,[ssas03_conv] = cdc.[ssas03_conv]
	,[ssas04] = cdc.[ssas04]
	,[ssas04_conv] = cdc.[ssas04_conv]
	,[ssas05] = cdc.[ssas05]
	,[ssas05_conv] = cdc.[ssas05_conv]
	,[ssas06] = cdc.[ssas06]
	,[ssas06_conv] = cdc.[ssas06_conv]
	,[ssas07] = cdc.[ssas07]
	,[ssas07_conv] = cdc.[ssas07_conv]
	,[ssas08] = cdc.[ssas08]
	,[ssas08_conv] = cdc.[ssas08_conv]
	,[ssas09] = cdc.[ssas09]
	,[ssas09_conv] = cdc.[ssas09_conv]
	,[ssas10] = cdc.[ssas10]
	,[ssas10_conv] = cdc.[ssas10_conv]
	,[ssas11] = cdc.[ssas11]
	,[ssas11_conv] = cdc.[ssas11_conv]
	,[ssas12] = cdc.[ssas12]
	,[ssas12_conv] = cdc.[ssas12_conv]
	,[ssas13] = cdc.[ssas13]
	,[ssas13_conv] = cdc.[ssas13_conv]
	,[ssas14] = cdc.[ssas14]
	,[ssas14_conv] = cdc.[ssas14_conv]
	,[ssdlij] = cdc.[ssdlij]
	,[ssdlij_conv] = cdc.[ssdlij_conv] -- exclude distribution column
FROM stg_jde.tmp_upsert_f4229_cdc cdc
WHERE
    rep_jde.f4229_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f4229_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f4229_new AF:{{ task_instance_key_str }}' ) 
