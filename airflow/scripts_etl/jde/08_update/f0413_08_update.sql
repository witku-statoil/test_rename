-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f0413_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[rmpyid] = cdc.[rmpyid]
	,[rmdctm] = cdc.[rmdctm]
	,[rmdocm] = cdc.[rmdocm]
	,[rmpye] = cdc.[rmpye]
	,[rmglba] = cdc.[rmglba]
	,[rmglba_conv] = cdc.[rmglba_conv]
	,[rmdmtj] = cdc.[rmdmtj]
	,[rmdmtj_conv] = cdc.[rmdmtj_conv]
	,[rmvdgj] = cdc.[rmvdgj]
	,[rmvdgj_conv] = cdc.[rmvdgj_conv]
	,[rmicu] = cdc.[rmicu]
	,[rmicut] = cdc.[rmicut]
	,[rmdicj] = cdc.[rmdicj]
	,[rmdicj_conv] = cdc.[rmdicj_conv]
	,[rmpaap] = cdc.[rmpaap]
	,[rmpaap_conv] = cdc.[rmpaap_conv]
	,[rmcrcd] = cdc.[rmcrcd]
	,[rmcrcd_conv] = cdc.[rmcrcd_conv]
	,[rmcrrm] = cdc.[rmcrrm]
	,[rmam] = cdc.[rmam]
	,[rmvldt] = cdc.[rmvldt]
	,[rmvldt_conv] = cdc.[rmvldt_conv]
	,[rmpyin] = cdc.[rmpyin]
	,[rmistp] = cdc.[rmistp]
	,[rmistp_conv] = cdc.[rmistp_conv]
	,[rmcbnk] = cdc.[rmcbnk]
	,[rmcbnk_conv] = cdc.[rmcbnk_conv]
	,[rmbktr] = cdc.[rmbktr]
	,[rmbktr_conv] = cdc.[rmbktr_conv]
	,[rmtorg] = cdc.[rmtorg]
	,[rmtorg_conv] = cdc.[rmtorg_conv]
	,[rmuser] = cdc.[rmuser]
	,[rmuser_conv] = cdc.[rmuser_conv]
	,[rmpid] = cdc.[rmpid]
	,[rmpid_conv] = cdc.[rmpid_conv]
	,[rmupmj] = cdc.[rmupmj]
	,[rmupmj_conv] = cdc.[rmupmj_conv]
	,[rmupmt] = cdc.[rmupmt]
	,[rmjobn] = cdc.[rmjobn]
	,[rmjobn_conv] = cdc.[rmjobn_conv]
	,[rmmip] = cdc.[rmmip]
	,[rmmip_conv] = cdc.[rmmip_conv]
	,[rmlrfl] = cdc.[rmlrfl]
	,[rmlrfl_conv] = cdc.[rmlrfl_conv]
	,[rmprgf] = cdc.[rmprgf]
	,[rmprgf_conv] = cdc.[rmprgf_conv]
	,[rmgfl7] = cdc.[rmgfl7]
	,[rmgfl7_conv] = cdc.[rmgfl7_conv]
	,[rmgfl8] = cdc.[rmgfl8]
	,[rmgfl8_conv] = cdc.[rmgfl8_conv]
	,[rmgam3] = cdc.[rmgam3]
	,[rmgam3_conv] = cdc.[rmgam3_conv]
	,[rmgam4] = cdc.[rmgam4]
	,[rmgam4_conv] = cdc.[rmgam4_conv]
	,[rmgen6] = cdc.[rmgen6]
	,[rmgen6_conv] = cdc.[rmgen6_conv]
	,[rmgen7] = cdc.[rmgen7]
	,[rmgen7_conv] = cdc.[rmgen7_conv]
	,[rmnettcid] = cdc.[rmnettcid]
	,[rmnettcid_conv] = cdc.[rmnettcid_conv]
	,[rmnetdoc] = cdc.[rmnetdoc]
	,[rmnetdoc_conv] = cdc.[rmnetdoc_conv]
	,[rmrcnd] = cdc.[rmrcnd]
	,[rmr3] = cdc.[rmr3]
	,[rmr3_conv] = cdc.[rmr3_conv]
	,[rmcntrtid] = cdc.[rmcntrtid]
	,[rmcntrtid_conv] = cdc.[rmcntrtid_conv]
	,[rmcntrtcd] = cdc.[rmcntrtcd]
	,[rmcntrtcd_conv] = cdc.[rmcntrtcd_conv]
	,[rmwvid] = cdc.[rmwvid]
	,[rmwvid_conv] = cdc.[rmwvid_conv]
	,[rmblscd2] = cdc.[rmblscd2]
	,[rmblscd2_conv] = cdc.[rmblscd2_conv]
	,[rmharper] = cdc.[rmharper]
	,[rmharper_conv] = cdc.[rmharper_conv]
	,[rmharsfx] = cdc.[rmharsfx]
	,[rmharsfx_conv] = cdc.[rmharsfx_conv] -- exclude distribution column
FROM stg_jde.tmp_upsert_f0413_cdc cdc
WHERE
    rep_jde.f0413_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f0413_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f0413_new AF:{{ task_instance_key_str }}' ) 
