-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f3112_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[wldoco] = cdc.[wldoco]
	,[wldcto] = cdc.[wldcto]
	,[wlsfxo] = cdc.[wlsfxo]
	,[wlsfxo_conv] = cdc.[wlsfxo_conv]
	,[wltrt] = cdc.[wltrt]
	,[wlkit] = cdc.[wlkit]
	,[wlkitl] = cdc.[wlkitl]
	,[wlkitl_conv] = cdc.[wlkitl_conv]
	,[wlkita] = cdc.[wlkita]
	,[wlkita_conv] = cdc.[wlkita_conv]
	,[wlmmcu] = cdc.[wlmmcu]
	,[wlmmcu_conv] = cdc.[wlmmcu_conv]
	,[wlline] = cdc.[wlline]
	,[wlline_conv] = cdc.[wlline_conv]
	,[wlmcu] = cdc.[wlmcu]
	,[wlmcu_conv] = cdc.[wlmcu_conv]
	,[wlald] = cdc.[wlald]
	,[wldsc1] = cdc.[wldsc1]
	,[wldsc1_conv] = cdc.[wldsc1_conv]
	,[wlopsq] = cdc.[wlopsq]
	,[wlopsq_conv] = cdc.[wlopsq_conv]
	,[wlopsc] = cdc.[wlopsc]
	,[wlopst] = cdc.[wlopst]
	,[wlinpe] = cdc.[wlinpe]
	,[wlinpe_conv] = cdc.[wlinpe_conv]
	,[wltimb] = cdc.[wltimb]
	,[wllamc] = cdc.[wllamc]
	,[wlbfpf] = cdc.[wlbfpf]
	,[wlpprf] = cdc.[wlpprf]
	,[wljbcd] = cdc.[wljbcd]
	,[wlan8] = cdc.[wlan8]
	,[wlcrtr] = cdc.[wlcrtr]
	,[wlcrtr_conv] = cdc.[wlcrtr_conv]
	,[wlsltr] = cdc.[wlsltr]
	,[wlsltr_conv] = cdc.[wlsltr_conv]
	,[wltrdj] = cdc.[wltrdj]
	,[wltrdj_conv] = cdc.[wltrdj_conv]
	,[wldrqj] = cdc.[wldrqj]
	,[wldrqj_conv] = cdc.[wldrqj_conv]
	,[wlstrt] = cdc.[wlstrt]
	,[wlstrt_conv] = cdc.[wlstrt_conv]
	,[wlstrx] = cdc.[wlstrx]
	,[wlstrx_conv] = cdc.[wlstrx_conv]
	,[wlrsft] = cdc.[wlrsft]
	,[wlrsft_conv] = cdc.[wlrsft_conv]
	,[wlssft] = cdc.[wlssft]
	,[wlssft_conv] = cdc.[wlssft_conv]
	,[wlcsft] = cdc.[wlcsft]
	,[wlcsft_conv] = cdc.[wlcsft_conv]
	,[wlltpc] = cdc.[wlltpc]
	,[wlltpc_conv] = cdc.[wlltpc_conv]
	,[wlpovr] = cdc.[wlpovr]
	,[wlpovr_conv] = cdc.[wlpovr_conv]
	,[wlopyp] = cdc.[wlopyp]
	,[wlopyp_conv] = cdc.[wlopyp_conv]
	,[wlcpyp] = cdc.[wlcpyp]
	,[wlcpyp_conv] = cdc.[wlcpyp_conv]
	,[wlnxop] = cdc.[wlnxop]
	,[wlnxop_conv] = cdc.[wlnxop_conv]
	,[wlsetc] = cdc.[wlsetc]
	,[wlmovd] = cdc.[wlmovd]
	,[wlmovd_conv] = cdc.[wlmovd_conv]
	,[wlqued] = cdc.[wlqued]
	,[wlqued_conv] = cdc.[wlqued_conv]
	,[wlrunm] = cdc.[wlrunm]
	,[wlrunm_conv] = cdc.[wlrunm_conv]
	,[wlrunl] = cdc.[wlrunl]
	,[wlrunl_conv] = cdc.[wlrunl_conv]
	,[wlsetl] = cdc.[wlsetl]
	,[wlsetl_conv] = cdc.[wlsetl_conv]
	,[wlmaca] = cdc.[wlmaca]
	,[wlmaca_conv] = cdc.[wlmaca_conv]
	,[wllaba] = cdc.[wllaba]
	,[wllaba_conv] = cdc.[wllaba_conv]
	,[wlseta] = cdc.[wlseta]
	,[wlseta_conv] = cdc.[wlseta_conv]
	,[wlopsr] = cdc.[wlopsr]
	,[wlopsr_conv] = cdc.[wlopsr_conv]
	,[wluorg] = cdc.[wluorg]
	,[wluorg_conv] = cdc.[wluorg_conv]
	,[wlsocn] = cdc.[wlsocn]
	,[wlsocn_conv] = cdc.[wlsocn_conv]
	,[wlsoqs] = cdc.[wlsoqs]
	,[wlsoqs_conv] = cdc.[wlsoqs_conv]
	,[wlqmto] = cdc.[wlqmto]
	,[wlqmto_conv] = cdc.[wlqmto_conv]
	,[wlpwrt] = cdc.[wlpwrt]
	,[wlpwrt_conv] = cdc.[wlpwrt_conv]
	,[wluom] = cdc.[wluom]
	,[wlcts2] = cdc.[wlcts2]
	,[wlcts2_conv] = cdc.[wlcts2_conv]
	,[wlcts3] = cdc.[wlcts3]
	,[wlcts3_conv] = cdc.[wlcts3_conv]
	,[wlcts4] = cdc.[wlcts4]
	,[wlcts4_conv] = cdc.[wlcts4_conv]
	,[wlcts5] = cdc.[wlcts5]
	,[wlcts5_conv] = cdc.[wlcts5_conv]
	,[wlcts6] = cdc.[wlcts6]
	,[wlcts6_conv] = cdc.[wlcts6_conv]
	,[wlapid] = cdc.[wlapid]
	,[wlapid_conv] = cdc.[wlapid_conv]
	,[wlshno] = cdc.[wlshno]
	,[wlshno_conv] = cdc.[wlshno_conv]
	,[wlomcu] = cdc.[wlomcu]
	,[wlomcu_conv] = cdc.[wlomcu_conv]
	,[wlobj] = cdc.[wlobj]
	,[wlobj_conv] = cdc.[wlobj_conv]
	,[wlsub] = cdc.[wlsub]
	,[wlsub_conv] = cdc.[wlsub_conv]
	,[wlvend] = cdc.[wlvend]
	,[wlvend_conv] = cdc.[wlvend_conv]
	,[wlrkco] = cdc.[wlrkco]
	,[wlrkco_conv] = cdc.[wlrkco_conv]
	,[wlrorn] = cdc.[wlrorn]
	,[wlrorn_conv] = cdc.[wlrorn_conv]
	,[wlrcto] = cdc.[wlrcto]
	,[wlrlln] = cdc.[wlrlln]
	,[wlrlln_conv] = cdc.[wlrlln_conv]
	,[wldct] = cdc.[wldct]
	,[wlurcd] = cdc.[wlurcd]
	,[wlurcd_conv] = cdc.[wlurcd_conv]
	,[wlurdt] = cdc.[wlurdt]
	,[wlurdt_conv] = cdc.[wlurdt_conv]
	,[wlurat] = cdc.[wlurat]
	,[wlurat_conv] = cdc.[wlurat_conv]
	,[wlurrf] = cdc.[wlurrf]
	,[wlurrf_conv] = cdc.[wlurrf_conv]
	,[wlurab] = cdc.[wlurab]
	,[wlurab_conv] = cdc.[wlurab_conv]
	,[wluser] = cdc.[wluser]
	,[wluser_conv] = cdc.[wluser_conv]
	,[wlpid] = cdc.[wlpid]
	,[wlpid_conv] = cdc.[wlpid_conv]
	,[wljobn] = cdc.[wljobn]
	,[wljobn_conv] = cdc.[wljobn_conv]
	,[wlupmj] = cdc.[wlupmj]
	,[wlupmj_conv] = cdc.[wlupmj_conv]
	,[wltday] = cdc.[wltday]
	,[wllocn] = cdc.[wllocn]
	,[wllocn_conv] = cdc.[wllocn_conv]
	,[wlruc] = cdc.[wlruc]
	,[wlruc_conv] = cdc.[wlruc_conv]
	,[wlcapu] = cdc.[wlcapu]
	,[wlwmcu] = cdc.[wlwmcu]
	,[wlwmcu_conv] = cdc.[wlwmcu_conv]
	,[wlcmhr] = cdc.[wlcmhr]
	,[wlcmhr_conv] = cdc.[wlcmhr_conv]
	,[wlclhr] = cdc.[wlclhr]
	,[wlclhr_conv] = cdc.[wlclhr_conv]
	,[wlcshr] = cdc.[wlcshr]
	,[wlcshr_conv] = cdc.[wlcshr_conv]
	,[wlcost] = cdc.[wlcost]
	,[wlactb] = cdc.[wlactb]
	,[wlactb_conv] = cdc.[wlactb_conv]
	,[wlnumb] = cdc.[wlnumb]
	,[wlcts7] = cdc.[wlcts7]
	,[wlcts7_conv] = cdc.[wlcts7_conv]
	,[wlcts8] = cdc.[wlcts8]
	,[wlcts8_conv] = cdc.[wlcts8_conv]
	,[wlcts9] = cdc.[wlcts9]
	,[wlcts9_conv] = cdc.[wlcts9_conv]
	,[wllabp] = cdc.[wllabp]
	,[wllabp_conv] = cdc.[wllabp_conv]
	,[wlmacr] = cdc.[wlmacr]
	,[wlmacr_conv] = cdc.[wlmacr_conv]
	,[wlsetr] = cdc.[wlsetr]
	,[wlsetr_conv] = cdc.[wlsetr_conv]
	,[wlapsc] = cdc.[wlapsc]
	,[wlsest] = cdc.[wlsest]
	,[wlseet] = cdc.[wlseet]
	,[wltmco] = cdc.[wltmco]
	,[wld2j] = cdc.[wld2j]
	,[wld2j_conv] = cdc.[wld2j_conv]
	,[wlstti] = cdc.[wlstti]
	,[wlcmpe] = cdc.[wlcmpe]
	,[wlcmpc] = cdc.[wlcmpc]
	,[wlcmpc_conv] = cdc.[wlcmpc_conv]
	,[wlcplvlfr] = cdc.[wlcplvlfr]
	,[wlcplvlfr_conv] = cdc.[wlcplvlfr_conv]
	,[wlcplvlto] = cdc.[wlcplvlto]
	,[wlcplvlto_conv] = cdc.[wlcplvlto_conv]
	,[wlcmrq] = cdc.[wlcmrq]
	,[wlcmrq_conv] = cdc.[wlcmrq_conv]
	,[wlansa] = cdc.[wlansa]
	,[wlanpa] = cdc.[wlanpa]
	,[wlanp] = cdc.[wlanp]
	,[wlwschf] = cdc.[wlwschf]
	,[wltraf] = cdc.[wltraf] -- exclude distribution column
FROM stg_jde.tmp_upsert_f3112_cdc cdc
WHERE
    rep_jde.f3112_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f3112_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f3112_new AF:{{ task_instance_key_str }}' ) 
