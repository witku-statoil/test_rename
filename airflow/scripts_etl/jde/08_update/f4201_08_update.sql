-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f4201_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[shkcoo] = cdc.[shkcoo]
	,[shkcoo_conv] = cdc.[shkcoo_conv]
	,[shdoco] = cdc.[shdoco]
	,[shdcto] = cdc.[shdcto]
	,[shsfxo] = cdc.[shsfxo]
	,[shsfxo_conv] = cdc.[shsfxo_conv]
	,[shmcu] = cdc.[shmcu]
	,[shmcu_conv] = cdc.[shmcu_conv]
	,[shco] = cdc.[shco]
	,[shco_conv] = cdc.[shco_conv]
	,[shokco] = cdc.[shokco]
	,[shokco_conv] = cdc.[shokco_conv]
	,[shoorn] = cdc.[shoorn]
	,[shoorn_conv] = cdc.[shoorn_conv]
	,[shocto] = cdc.[shocto]
	,[shrkco] = cdc.[shrkco]
	,[shrkco_conv] = cdc.[shrkco_conv]
	,[shrorn] = cdc.[shrorn]
	,[shrorn_conv] = cdc.[shrorn_conv]
	,[shrcto] = cdc.[shrcto]
	,[shan8] = cdc.[shan8]
	,[shshan] = cdc.[shshan]
	,[shpa8] = cdc.[shpa8]
	,[shdrqj] = cdc.[shdrqj]
	,[shdrqj_conv] = cdc.[shdrqj_conv]
	,[shtrdj] = cdc.[shtrdj]
	,[shtrdj_conv] = cdc.[shtrdj_conv]
	,[shpddj] = cdc.[shpddj]
	,[shpddj_conv] = cdc.[shpddj_conv]
	,[shopdj] = cdc.[shopdj]
	,[shopdj_conv] = cdc.[shopdj_conv]
	,[shaddj] = cdc.[shaddj]
	,[shaddj_conv] = cdc.[shaddj_conv]
	,[shcndj] = cdc.[shcndj]
	,[shcndj_conv] = cdc.[shcndj_conv]
	,[shpefj] = cdc.[shpefj]
	,[shpefj_conv] = cdc.[shpefj_conv]
	,[shppdj] = cdc.[shppdj]
	,[shppdj_conv] = cdc.[shppdj_conv]
	,[shvr01] = cdc.[shvr01]
	,[shvr01_conv] = cdc.[shvr01_conv]
	,[shvr02] = cdc.[shvr02]
	,[shvr02_conv] = cdc.[shvr02_conv]
	,[shdel1] = cdc.[shdel1]
	,[shdel1_conv] = cdc.[shdel1_conv]
	,[shdel2] = cdc.[shdel2]
	,[shdel2_conv] = cdc.[shdel2_conv]
	,[shinmg] = cdc.[shinmg]
	,[shptc] = cdc.[shptc]
	,[shptc_conv] = cdc.[shptc_conv]
	,[shryin] = cdc.[shryin]
	,[shasn] = cdc.[shasn]
	,[shprgp] = cdc.[shprgp]
	,[shtrdc] = cdc.[shtrdc]
	,[shtrdc_conv] = cdc.[shtrdc_conv]
	,[shpcrt] = cdc.[shpcrt]
	,[shpcrt_conv] = cdc.[shpcrt_conv]
	,[shtxa1] = cdc.[shtxa1]
	,[shtxa1_conv] = cdc.[shtxa1_conv]
	,[shexr1] = cdc.[shexr1]
	,[shtxct] = cdc.[shtxct]
	,[shtxct_conv] = cdc.[shtxct_conv]
	,[shatxt] = cdc.[shatxt]
	,[shatxt_conv] = cdc.[shatxt_conv]
	,[shprio] = cdc.[shprio]
	,[shback] = cdc.[shback]
	,[shback_conv] = cdc.[shback_conv]
	,[shsbal] = cdc.[shsbal]
	,[shsbal_conv] = cdc.[shsbal_conv]
	,[shhold] = cdc.[shhold]
	,[shplst] = cdc.[shplst]
	,[shplst_conv] = cdc.[shplst_conv]
	,[shinvc] = cdc.[shinvc]
	,[shinvc_conv] = cdc.[shinvc_conv]
	,[shntr] = cdc.[shntr]
	,[shanby] = cdc.[shanby]
	,[shcars] = cdc.[shcars]
	,[shcars_conv] = cdc.[shcars_conv]
	,[shmot] = cdc.[shmot]
	,[shcot] = cdc.[shcot]
	,[shrout] = cdc.[shrout]
	,[shstop] = cdc.[shstop]
	,[shzon] = cdc.[shzon]
	,[shcnid] = cdc.[shcnid]
	,[shcnid_conv] = cdc.[shcnid_conv]
	,[shfrth] = cdc.[shfrth]
	,[shaft] = cdc.[shaft]
	,[shaft_conv] = cdc.[shaft_conv]
	,[shfuf1] = cdc.[shfuf1]
	,[shfrtc] = cdc.[shfrtc]
	,[shfrtc_conv] = cdc.[shfrtc_conv]
	,[shmord] = cdc.[shmord]
	,[shmord_conv] = cdc.[shmord_conv]
	,[shrcd] = cdc.[shrcd]
	,[shfuf2] = cdc.[shfuf2]
	,[shfuf2_conv] = cdc.[shfuf2_conv]
	,[shotot] = cdc.[shotot]
	,[shotot_conv] = cdc.[shotot_conv]
	,[shtotc] = cdc.[shtotc]
	,[shtotc_conv] = cdc.[shtotc_conv]
	,[shwumd] = cdc.[shwumd]
	,[shvumd] = cdc.[shvumd]
	,[shautn] = cdc.[shautn]
	,[shautn_conv] = cdc.[shautn_conv]
	,[shcact] = cdc.[shcact]
	,[shcact_conv] = cdc.[shcact_conv]
	,[shcexp] = cdc.[shcexp]
	,[shcexp_conv] = cdc.[shcexp_conv]
	,[shsbli] = cdc.[shsbli]
	,[shcrmd] = cdc.[shcrmd]
	,[shcrrm] = cdc.[shcrrm]
	,[shcrcd] = cdc.[shcrcd]
	,[shcrcd_conv] = cdc.[shcrcd_conv]
	,[shcrr] = cdc.[shcrr]
	,[shlngp] = cdc.[shlngp]
	,[shfap] = cdc.[shfap]
	,[shfap_conv] = cdc.[shfap_conv]
	,[shfcst] = cdc.[shfcst]
	,[shfcst_conv] = cdc.[shfcst_conv]
	,[shorby] = cdc.[shorby]
	,[shorby_conv] = cdc.[shorby_conv]
	,[shtkby] = cdc.[shtkby]
	,[shtkby_conv] = cdc.[shtkby_conv]
	,[shurcd] = cdc.[shurcd]
	,[shurcd_conv] = cdc.[shurcd_conv]
	,[shurdt] = cdc.[shurdt]
	,[shurdt_conv] = cdc.[shurdt_conv]
	,[shurat] = cdc.[shurat]
	,[shurat_conv] = cdc.[shurat_conv]
	,[shurab] = cdc.[shurab]
	,[shurab_conv] = cdc.[shurab_conv]
	,[shurrf] = cdc.[shurrf]
	,[shurrf_conv] = cdc.[shurrf_conv]
	,[shuser] = cdc.[shuser]
	,[shuser_conv] = cdc.[shuser_conv]
	,[shpid] = cdc.[shpid]
	,[shpid_conv] = cdc.[shpid_conv]
	,[shjobn] = cdc.[shjobn]
	,[shjobn_conv] = cdc.[shjobn_conv]
	,[shupmj] = cdc.[shupmj]
	,[shupmj_conv] = cdc.[shupmj_conv]
	,[shtday] = cdc.[shtday]
	,[shir01] = cdc.[shir01]
	,[shir01_conv] = cdc.[shir01_conv]
	,[shir02] = cdc.[shir02]
	,[shir02_conv] = cdc.[shir02_conv]
	,[shir03] = cdc.[shir03]
	,[shir03_conv] = cdc.[shir03_conv]
	,[shir04] = cdc.[shir04]
	,[shir04_conv] = cdc.[shir04_conv]
	,[shir05] = cdc.[shir05]
	,[shir05_conv] = cdc.[shir05_conv]
	,[shvr03] = cdc.[shvr03]
	,[shvr03_conv] = cdc.[shvr03_conv]
	,[shsoor] = cdc.[shsoor]
	,[shsoor_conv] = cdc.[shsoor_conv]
	,[shpmdt] = cdc.[shpmdt]
	,[shrsdt] = cdc.[shrsdt]
	,[shrqsj] = cdc.[shrqsj]
	,[shrqsj_conv] = cdc.[shrqsj_conv]
	,[shpstm] = cdc.[shpstm]
	,[shpdtt] = cdc.[shpdtt]
	,[shoptt] = cdc.[shoptt]
	,[shdrqt] = cdc.[shdrqt]
	,[shadtm] = cdc.[shadtm]
	,[shadlj] = cdc.[shadlj]
	,[shadlj_conv] = cdc.[shadlj_conv]
	,[shpban] = cdc.[shpban]
	,[shpban_conv] = cdc.[shpban_conv]
	,[shitan] = cdc.[shitan]
	,[shitan_conv] = cdc.[shitan_conv]
	,[shftan] = cdc.[shftan]
	,[shftan_conv] = cdc.[shftan_conv]
	,[shdvan] = cdc.[shdvan]
	,[shdvan_conv] = cdc.[shdvan_conv]
	,[shdoc1] = cdc.[shdoc1]
	,[shdct4] = cdc.[shdct4]
	,[shcord] = cdc.[shcord]
	,[shbsc] = cdc.[shbsc]
	,[shbcrc] = cdc.[shbcrc]
	,[shbcrc_conv] = cdc.[shbcrc_conv]
	,[shauft] = cdc.[shauft]
	,[shaufi] = cdc.[shaufi]
	,[shopbo] = cdc.[shopbo]
	,[shoptc] = cdc.[shoptc]
	,[shoptc_conv] = cdc.[shoptc_conv]
	,[shopld] = cdc.[shopld]
	,[shopld_conv] = cdc.[shopld_conv]
	,[shopbk] = cdc.[shopbk]
	,[shopbk_conv] = cdc.[shopbk_conv]
	,[shopsb] = cdc.[shopsb]
	,[shopsb_conv] = cdc.[shopsb_conv]
	,[shopps] = cdc.[shopps]
	,[shopps_conv] = cdc.[shopps_conv]
	,[shoppl] = cdc.[shoppl]
	,[shoppl_conv] = cdc.[shoppl_conv]
	,[shopms] = cdc.[shopms]
	,[shopms_conv] = cdc.[shopms_conv]
	,[shopss] = cdc.[shopss]
	,[shopss_conv] = cdc.[shopss_conv]
	,[shopba] = cdc.[shopba]
	,[shopba_conv] = cdc.[shopba_conv]
	,[shopll] = cdc.[shopll]
	,[shopll_conv] = cdc.[shopll_conv]
	,[shpran8] = cdc.[shpran8]
	,[shpran8_conv] = cdc.[shpran8_conv]
	,[shoppid] = cdc.[shoppid]
	,[shoppid_conv] = cdc.[shoppid_conv]
	,[shsdattn] = cdc.[shsdattn]
	,[shsdattn_conv] = cdc.[shsdattn_conv]
	,[shspattn] = cdc.[shspattn]
	,[shspattn_conv] = cdc.[shspattn_conv]
	,[shotind] = cdc.[shotind]
	,[shotind_conv] = cdc.[shotind_conv]
	,[shprcidln] = cdc.[shprcidln]
	,[shprcidln_conv] = cdc.[shprcidln_conv]
	,[shccidln] = cdc.[shccidln]
	,[shccidln_conv] = cdc.[shccidln_conv]
	,[shshccidln] = cdc.[shshccidln]
	,[shshccidln_conv] = cdc.[shshccidln_conv] -- exclude distribution column
FROM stg_jde.tmp_upsert_f4201_cdc cdc
WHERE
    rep_jde.f4201_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f4201_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f4201_new AF:{{ task_instance_key_str }}' ) 
