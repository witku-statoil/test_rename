-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f4215_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[xhshpn] = cdc.[xhshpn]
	,[xhssts] = cdc.[xhssts]
	,[xhpnid] = cdc.[xhpnid]
	,[xhpnid_conv] = cdc.[xhpnid_conv]
	,[xhhlcf] = cdc.[xhhlcf]
	,[xhhlcf_conv] = cdc.[xhhlcf_conv]
	,[xhpkcd] = cdc.[xhpkcd]
	,[xhwgq] = cdc.[xhwgq]
	,[xhwgts] = cdc.[xhwgts]
	,[xhwgts_conv] = cdc.[xhwgts_conv]
	,[xhwgtu] = cdc.[xhwgtu]
	,[xhidq1] = cdc.[xhidq1]
	,[xhid1] = cdc.[xhid1]
	,[xhid1_conv] = cdc.[xhid1_conv]
	,[xhidq2] = cdc.[xhidq2]
	,[xhid2] = cdc.[xhid2]
	,[xhid2_conv] = cdc.[xhid2_conv]
	,[xhmot] = cdc.[xhmot]
	,[xhrote] = cdc.[xhrote]
	,[xhrote_conv] = cdc.[xhrote_conv]
	,[xheqcd] = cdc.[xheqcd]
	,[xheqin] = cdc.[xheqin]
	,[xheqin_conv] = cdc.[xheqin_conv]
	,[xheqnb] = cdc.[xheqnb]
	,[xheqnb_conv] = cdc.[xheqnb_conv]
	,[xhasna] = cdc.[xhasna]
	,[xhasnd] = cdc.[xhasnd]
	,[xhasnd_conv] = cdc.[xhasnd_conv]
	,[xhasnt] = cdc.[xhasnt]
	,[xhmcu] = cdc.[xhmcu]
	,[xhmcu_conv] = cdc.[xhmcu_conv]
	,[xhnmcu] = cdc.[xhnmcu]
	,[xhnmcu_conv] = cdc.[xhnmcu_conv]
	,[xhorgn] = cdc.[xhorgn]
	,[xhsrco] = cdc.[xhsrco]
	,[xhbpfg] = cdc.[xhbpfg]
	,[xhaexp] = cdc.[xhaexp]
	,[xhaexp_conv] = cdc.[xhaexp_conv]
	,[xhecst] = cdc.[xhecst]
	,[xhecst_conv] = cdc.[xhecst_conv]
	,[xhdrqj] = cdc.[xhdrqj]
	,[xhdrqj_conv] = cdc.[xhdrqj_conv]
	,[xhdrqt] = cdc.[xhdrqt]
	,[xhrsdj] = cdc.[xhrsdj]
	,[xhrsdj_conv] = cdc.[xhrsdj_conv]
	,[xhrsdt] = cdc.[xhrsdt]
	,[xhpdov] = cdc.[xhpdov]
	,[xhpdov_conv] = cdc.[xhpdov_conv]
	,[xhan8] = cdc.[xhan8]
	,[xhshan] = cdc.[xhshan]
	,[xhcty1] = cdc.[xhcty1]
	,[xhcty1_conv] = cdc.[xhcty1_conv]
	,[xhadds] = cdc.[xhadds]
	,[xhaddz] = cdc.[xhaddz]
	,[xhaddz_conv] = cdc.[xhaddz_conv]
	,[xhctr] = cdc.[xhctr]
	,[xhzon] = cdc.[xhzon]
	,[xhsct1] = cdc.[xhsct1]
	,[xhsct1_conv] = cdc.[xhsct1_conv]
	,[xhsct2] = cdc.[xhsct2]
	,[xhsct2_conv] = cdc.[xhsct2_conv]
	,[xhsct3] = cdc.[xhsct3]
	,[xhsct3_conv] = cdc.[xhsct3_conv]
	,[xhcar1] = cdc.[xhcar1]
	,[xhcar1_conv] = cdc.[xhcar1_conv]
	,[xhcar2] = cdc.[xhcar2]
	,[xhcar2_conv] = cdc.[xhcar2_conv]
	,[xhcar3] = cdc.[xhcar3]
	,[xhcar3_conv] = cdc.[xhcar3_conv]
	,[xhilel] = cdc.[xhilel]
	,[xhilel_conv] = cdc.[xhilel_conv]
	,[xhfrth] = cdc.[xhfrth]
	,[xhfrsc] = cdc.[xhfrsc]
	,[xhdllv] = cdc.[xhdllv]
	,[xhrslt] = cdc.[xhrslt]
	,[xhbfsd] = cdc.[xhbfsd]
	,[xhbfsd_conv] = cdc.[xhbfsd_conv]
	,[xhdstn] = cdc.[xhdstn]
	,[xhumd1] = cdc.[xhumd1]
	,[xhnrts] = cdc.[xhnrts]
	,[xhuser] = cdc.[xhuser]
	,[xhuser_conv] = cdc.[xhuser_conv]
	,[xhpid] = cdc.[xhpid]
	,[xhpid_conv] = cdc.[xhpid_conv]
	,[xhjobn] = cdc.[xhjobn]
	,[xhjobn_conv] = cdc.[xhjobn_conv]
	,[xhupmj] = cdc.[xhupmj]
	,[xhupmj_conv] = cdc.[xhupmj_conv]
	,[xhtday] = cdc.[xhtday]
	,[xhctyo] = cdc.[xhctyo]
	,[xhctyo_conv] = cdc.[xhctyo_conv]
	,[xhadso] = cdc.[xhadso]
	,[xhadzo] = cdc.[xhadzo]
	,[xhadzo_conv] = cdc.[xhadzo_conv]
	,[xhctro] = cdc.[xhctro]
	,[xhsc1o] = cdc.[xhsc1o]
	,[xhsc1o_conv] = cdc.[xhsc1o_conv]
	,[xhsc2o] = cdc.[xhsc2o]
	,[xhsc2o_conv] = cdc.[xhsc2o_conv]
	,[xhsc3o] = cdc.[xhsc3o]
	,[xhsc3o_conv] = cdc.[xhsc3o_conv]
	,[xhaetc] = cdc.[xhaetc]
	,[xhaetc_conv] = cdc.[xhaetc_conv]
	,[xhetrsc] = cdc.[xhetrsc]
	,[xhetrc] = cdc.[xhetrc]
	,[xhurcd] = cdc.[xhurcd]
	,[xhurcd_conv] = cdc.[xhurcd_conv]
	,[xhurdt] = cdc.[xhurdt]
	,[xhurdt_conv] = cdc.[xhurdt_conv]
	,[xhurat] = cdc.[xhurat]
	,[xhurat_conv] = cdc.[xhurat_conv]
	,[xhurab] = cdc.[xhurab]
	,[xhurab_conv] = cdc.[xhurab_conv]
	,[xhurrf] = cdc.[xhurrf]
	,[xhurrf_conv] = cdc.[xhurrf_conv] -- exclude distribution column
FROM stg_jde.tmp_upsert_f4215_cdc cdc
WHERE
    rep_jde.f4215_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f4215_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f4215_new AF:{{ task_instance_key_str }}' ) 
