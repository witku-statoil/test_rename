-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f550005_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[cmy55cmpcd] = cdc.[cmy55cmpcd]
	,[cmcmpid] = cdc.[cmcmpid]
	,[cmcmpid_conv] = cdc.[cmcmpid_conv]
	,[cmy55cmpty] = cdc.[cmy55cmpty]
	,[cmtxky] = cdc.[cmtxky]
	,[cmtxky_conv] = cdc.[cmtxky_conv]
	,[cmsdca] = cdc.[cmsdca]
	,[cmsdca_conv] = cdc.[cmsdca_conv]
	,[cmedca] = cdc.[cmedca]
	,[cmedca_conv] = cdc.[cmedca_conv]
	,[cmctr] = cdc.[cmctr]
	,[cmy55theme] = cdc.[cmy55theme]
	,[cmcrcd] = cdc.[cmcrcd]
	,[cmcrcd_conv] = cdc.[cmcrcd_conv]
	,[cmexdt0] = cdc.[cmexdt0]
	,[cmexdt0_conv] = cdc.[cmexdt0_conv]
	,[cmexdt1] = cdc.[cmexdt1]
	,[cmexdt1_conv] = cdc.[cmexdt1_conv]
	,[cmurab] = cdc.[cmurab]
	,[cmurab_conv] = cdc.[cmurab_conv]
	,[cmurrf] = cdc.[cmurrf]
	,[cmurrf_conv] = cdc.[cmurrf_conv]
	,[cmurdt] = cdc.[cmurdt]
	,[cmurdt_conv] = cdc.[cmurdt_conv]
	,[cmurat] = cdc.[cmurat]
	,[cmurat_conv] = cdc.[cmurat_conv]
	,[cmurcd] = cdc.[cmurcd]
	,[cmurcd_conv] = cdc.[cmurcd_conv]
	,[cmcrtu] = cdc.[cmcrtu]
	,[cmcrtu_conv] = cdc.[cmcrtu_conv]
	,[cmcrdj] = cdc.[cmcrdj]
	,[cmcrdj_conv] = cdc.[cmcrdj_conv]
	,[cmc9crp] = cdc.[cmc9crp]
	,[cmc9crp_conv] = cdc.[cmc9crp_conv]
	,[cmupmj] = cdc.[cmupmj]
	,[cmupmj_conv] = cdc.[cmupmj_conv]
	,[cmupmt] = cdc.[cmupmt]
	,[cmjobn] = cdc.[cmjobn]
	,[cmjobn_conv] = cdc.[cmjobn_conv]
	,[cmpid] = cdc.[cmpid]
	,[cmpid_conv] = cdc.[cmpid_conv]
	,[cmuser] = cdc.[cmuser]
	,[cmuser_conv] = cdc.[cmuser_conv]
	,[cmy55lckdt] = cdc.[cmy55lckdt]
	,[cmy55lckdt_conv] = cdc.[cmy55lckdt_conv]
	,[cmy55alapr] = cdc.[cmy55alapr]
	,[cmy55alapr_conv] = cdc.[cmy55alapr_conv]
	,[cmy55strg1] = cdc.[cmy55strg1]
	,[cmy55strg1_conv] = cdc.[cmy55strg1_conv]
	,[cmy55strg2] = cdc.[cmy55strg2]
	,[cmy55strg2_conv] = cdc.[cmy55strg2_conv]
	,[cmy55amnt1] = cdc.[cmy55amnt1]
	,[cmy55amnt1_conv] = cdc.[cmy55amnt1_conv]
	,[cmy55amnt2] = cdc.[cmy55amnt2]
	,[cmy55amnt2_conv] = cdc.[cmy55amnt2_conv]
	,[cmy55char1] = cdc.[cmy55char1]
	,[cmy55char1_conv] = cdc.[cmy55char1_conv]
	,[cmy55char2] = cdc.[cmy55char2]
	,[cmy55char2_conv] = cdc.[cmy55char2_conv]
	,[cmy55date1] = cdc.[cmy55date1]
	,[cmy55date1_conv] = cdc.[cmy55date1_conv]
	,[cmy55date2] = cdc.[cmy55date2]
	,[cmy55date2_conv] = cdc.[cmy55date2_conv]
	,[cmy55time1] = cdc.[cmy55time1]
	,[cmy55time2] = cdc.[cmy55time2] -- exclude distribution column
FROM stg_jde.tmp_upsert_f550005_cdc cdc
WHERE
    rep_jde.f550005_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f550005_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f550005_new AF:{{ task_instance_key_str }}' ) 
