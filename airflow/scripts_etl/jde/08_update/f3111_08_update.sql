-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f3111_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[wmdoco] = cdc.[wmdoco]
	,[wmdcto] = cdc.[wmdcto]
	,[wmsfxo] = cdc.[wmsfxo]
	,[wmsfxo_conv] = cdc.[wmsfxo_conv]
	,[wmtbm] = cdc.[wmtbm]
	,[wmforq] = cdc.[wmforq]
	,[wmitc] = cdc.[wmitc]
	,[wmcoby] = cdc.[wmcoby]
	,[wmcoty] = cdc.[wmcoty]
	,[wmcpnt] = cdc.[wmcpnt]
	,[wmfrmp] = cdc.[wmfrmp]
	,[wmfrmp_conv] = cdc.[wmfrmp_conv]
	,[wmthrp] = cdc.[wmthrp]
	,[wmthrp_conv] = cdc.[wmthrp_conv]
	,[wmfrgd] = cdc.[wmfrgd]
	,[wmthgd] = cdc.[wmthgd]
	,[wmrkco] = cdc.[wmrkco]
	,[wmrkco_conv] = cdc.[wmrkco_conv]
	,[wmrorn] = cdc.[wmrorn]
	,[wmrorn_conv] = cdc.[wmrorn_conv]
	,[wmrcto] = cdc.[wmrcto]
	,[wmrlln] = cdc.[wmrlln]
	,[wmrlln_conv] = cdc.[wmrlln_conv]
	,[wmopsq] = cdc.[wmopsq]
	,[wmopsq_conv] = cdc.[wmopsq_conv]
	,[wmbseq] = cdc.[wmbseq]
	,[wmbseq_conv] = cdc.[wmbseq_conv]
	,[wmrscp] = cdc.[wmrscp]
	,[wmrscp_conv] = cdc.[wmrscp_conv]
	,[wmscrp] = cdc.[wmscrp]
	,[wmscrp_conv] = cdc.[wmscrp_conv]
	,[wmrewp] = cdc.[wmrewp]
	,[wmrewp_conv] = cdc.[wmrewp_conv]
	,[wmasip] = cdc.[wmasip]
	,[wmasip_conv] = cdc.[wmasip_conv]
	,[wmcpyp] = cdc.[wmcpyp]
	,[wmcpyp_conv] = cdc.[wmcpyp_conv]
	,[wmstpp] = cdc.[wmstpp]
	,[wmstpp_conv] = cdc.[wmstpp_conv]
	,[wmlovd] = cdc.[wmlovd]
	,[wmlovd_conv] = cdc.[wmlovd_conv]
	,[wmcpit] = cdc.[wmcpit]
	,[wmcpil] = cdc.[wmcpil]
	,[wmcpil_conv] = cdc.[wmcpil_conv]
	,[wmcpia] = cdc.[wmcpia]
	,[wmcpia_conv] = cdc.[wmcpia_conv]
	,[wmcmcu] = cdc.[wmcmcu]
	,[wmcmcu_conv] = cdc.[wmcmcu_conv]
	,[wmdsc1] = cdc.[wmdsc1]
	,[wmdsc1_conv] = cdc.[wmdsc1_conv]
	,[wmdsc2] = cdc.[wmdsc2]
	,[wmdsc2_conv] = cdc.[wmdsc2_conv]
	,[wmlocn] = cdc.[wmlocn]
	,[wmlocn_conv] = cdc.[wmlocn_conv]
	,[wmlotn] = cdc.[wmlotn]
	,[wmlotn_conv] = cdc.[wmlotn_conv]
	,[wman8] = cdc.[wman8]
	,[wmlnty] = cdc.[wmlnty]
	,[wmlnty_conv] = cdc.[wmlnty_conv]
	,[wmsern] = cdc.[wmsern]
	,[wmsern_conv] = cdc.[wmsern_conv]
	,[wmtrdj] = cdc.[wmtrdj]
	,[wmtrdj_conv] = cdc.[wmtrdj_conv]
	,[wmdrqj] = cdc.[wmdrqj]
	,[wmdrqj_conv] = cdc.[wmdrqj_conv]
	,[wmuorg] = cdc.[wmuorg]
	,[wmuorg_conv] = cdc.[wmuorg_conv]
	,[wmtrqt] = cdc.[wmtrqt]
	,[wmtrqt_conv] = cdc.[wmtrqt_conv]
	,[wmsocn] = cdc.[wmsocn]
	,[wmsocn_conv] = cdc.[wmsocn_conv]
	,[wmsobk] = cdc.[wmsobk]
	,[wmsobk_conv] = cdc.[wmsobk_conv]
	,[wmcts1] = cdc.[wmcts1]
	,[wmcts1_conv] = cdc.[wmcts1_conv]
	,[wmqnta] = cdc.[wmqnta]
	,[wmqnta_conv] = cdc.[wmqnta_conv]
	,[wmum] = cdc.[wmum]
	,[wmea] = cdc.[wmea]
	,[wmea_conv] = cdc.[wmea_conv]
	,[wmrtg] = cdc.[wmrtg]
	,[wmrtg_conv] = cdc.[wmrtg_conv]
	,[wmmtst] = cdc.[wmmtst]
	,[wmdct] = cdc.[wmdct]
	,[wmshno] = cdc.[wmshno]
	,[wmshno_conv] = cdc.[wmshno_conv]
	,[wmmcu] = cdc.[wmmcu]
	,[wmmcu_conv] = cdc.[wmmcu_conv]
	,[wmomcu] = cdc.[wmomcu]
	,[wmomcu_conv] = cdc.[wmomcu_conv]
	,[wmobj] = cdc.[wmobj]
	,[wmobj_conv] = cdc.[wmobj_conv]
	,[wmsub] = cdc.[wmsub]
	,[wmsub_conv] = cdc.[wmsub_conv]
	,[wmcmrv] = cdc.[wmcmrv]
	,[wmcmrv_conv] = cdc.[wmcmrv_conv]
	,[wmstrx] = cdc.[wmstrx]
	,[wmstrx_conv] = cdc.[wmstrx_conv]
	,[wmpars] = cdc.[wmpars]
	,[wmpars_conv] = cdc.[wmpars_conv]
	,[wmcomm] = cdc.[wmcomm]
	,[wmurcd] = cdc.[wmurcd]
	,[wmurcd_conv] = cdc.[wmurcd_conv]
	,[wmurdt] = cdc.[wmurdt]
	,[wmurdt_conv] = cdc.[wmurdt_conv]
	,[wmurat] = cdc.[wmurat]
	,[wmurat_conv] = cdc.[wmurat_conv]
	,[wmurrf] = cdc.[wmurrf]
	,[wmurrf_conv] = cdc.[wmurrf_conv]
	,[wmurab] = cdc.[wmurab]
	,[wmurab_conv] = cdc.[wmurab_conv]
	,[wmuser] = cdc.[wmuser]
	,[wmuser_conv] = cdc.[wmuser_conv]
	,[wmpid] = cdc.[wmpid]
	,[wmpid_conv] = cdc.[wmpid_conv]
	,[wmjobn] = cdc.[wmjobn]
	,[wmjobn_conv] = cdc.[wmjobn_conv]
	,[wmupmj] = cdc.[wmupmj]
	,[wmupmj_conv] = cdc.[wmupmj_conv]
	,[wmtday] = cdc.[wmtday]
	,[wmukid] = cdc.[wmukid]
	,[wmvend] = cdc.[wmvend]
	,[wmvend_conv] = cdc.[wmvend_conv]
	,[wmpoc] = cdc.[wmpoc]
	,[wmcts4] = cdc.[wmcts4]
	,[wmcts4_conv] = cdc.[wmcts4_conv]
	,[wmcts7] = cdc.[wmcts7]
	,[wmcts7_conv] = cdc.[wmcts7_conv]
	,[wmcts8] = cdc.[wmcts8]
	,[wmcts8_conv] = cdc.[wmcts8_conv]
	,[wmgld] = cdc.[wmgld]
	,[wmgld_conv] = cdc.[wmgld_conv]
	,[wmsbfl] = cdc.[wmsbfl]
	,[wmsbfl_conv] = cdc.[wmsbfl_conv]
	,[wmaing] = cdc.[wmaing]
	,[wmaing_conv] = cdc.[wmaing_conv]
	,[wmsstq] = cdc.[wmsstq]
	,[wmsstq_conv] = cdc.[wmsstq_conv]
	,[wmuom2] = cdc.[wmuom2]
	,[wmapsc] = cdc.[wmapsc]
	,[wmpsn] = cdc.[wmpsn]
	,[wmdlej] = cdc.[wmdlej]
	,[wmdlej_conv] = cdc.[wmdlej_conv]
	,[wmcost] = cdc.[wmcost]
	,[wmchpp] = cdc.[wmchpp]
	,[wmchpp_conv] = cdc.[wmchpp_conv]
	,[wmcpnb] = cdc.[wmcpnb]
	,[wmcpnb_conv] = cdc.[wmcpnb_conv]
	,[wmbseqan] = cdc.[wmbseqan]
	,[wmbseqan_conv] = cdc.[wmbseqan_conv] -- exclude distribution column
FROM stg_jde.tmp_upsert_f3111_cdc cdc
WHERE
    rep_jde.f3111_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f3111_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f3111_new AF:{{ task_instance_key_str }}' ) 
