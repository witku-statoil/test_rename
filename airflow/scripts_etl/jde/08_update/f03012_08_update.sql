-- Apply updates from upsert table onto rep new table
UPDATE rep_jde.f03012_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[aian8] = cdc.[aian8]
	,[aico] = cdc.[aico]
	,[aico_conv] = cdc.[aico_conv]
	,[aiarc] = cdc.[aiarc]
	,[aiarc_conv] = cdc.[aiarc_conv]
	,[aimcur] = cdc.[aimcur]
	,[aimcur_conv] = cdc.[aimcur_conv]
	,[aiobar] = cdc.[aiobar]
	,[aiobar_conv] = cdc.[aiobar_conv]
	,[aiaidr] = cdc.[aiaidr]
	,[aiaidr_conv] = cdc.[aiaidr_conv]
	,[aikcor] = cdc.[aikcor]
	,[aikcor_conv] = cdc.[aikcor_conv]
	,[aidcar] = cdc.[aidcar]
	,[aidtar] = cdc.[aidtar]
	,[aicrcd] = cdc.[aicrcd]
	,[aicrcd_conv] = cdc.[aicrcd_conv]
	,[aitxa1] = cdc.[aitxa1]
	,[aitxa1_conv] = cdc.[aitxa1_conv]
	,[aiexr1] = cdc.[aiexr1]
	,[aiacl] = cdc.[aiacl]
	,[aihdar] = cdc.[aihdar]
	,[aitrar] = cdc.[aitrar]
	,[aitrar_conv] = cdc.[aitrar_conv]
	,[aistto] = cdc.[aistto]
	,[airyin] = cdc.[airyin]
	,[aistmt] = cdc.[aistmt]
	,[aiarpy] = cdc.[aiarpy]
	,[aiatcs] = cdc.[aiatcs]
	,[aiatcs_conv] = cdc.[aiatcs_conv]
	,[aisito] = cdc.[aisito]
	,[aisqnl] = cdc.[aisqnl]
	,[aialgm] = cdc.[aialgm]
	,[aicycn] = cdc.[aicycn]
	,[aicycn_conv] = cdc.[aicycn_conv]
	,[aibo] = cdc.[aibo]
	,[aitsta] = cdc.[aitsta]
	,[aickhc] = cdc.[aickhc]
	,[aickhc_conv] = cdc.[aickhc_conv]
	,[aidlc] = cdc.[aidlc]
	,[aidlc_conv] = cdc.[aidlc_conv]
	,[aidnlt] = cdc.[aidnlt]
	,[aidnlt_conv] = cdc.[aidnlt_conv]
	,[aiplcr] = cdc.[aiplcr]
	,[aiplcr_conv] = cdc.[aiplcr_conv]
	,[airvdj] = cdc.[airvdj]
	,[airvdj_conv] = cdc.[airvdj_conv]
	,[aidso] = cdc.[aidso]
	,[aicmgr] = cdc.[aicmgr]
	,[aiclmg] = cdc.[aiclmg]
	,[aidlqt] = cdc.[aidlqt]
	,[aidlqj] = cdc.[aidlqj]
	,[aidlqj_conv] = cdc.[aidlqj_conv]
	,[ainbrr] = cdc.[ainbrr]
	,[aicoll] = cdc.[aicoll]
	,[ainbr1] = cdc.[ainbr1]
	,[ainbr2] = cdc.[ainbr2]
	,[ainbr3] = cdc.[ainbr3]
	,[ainbcl] = cdc.[ainbcl]
	,[aiafc] = cdc.[aiafc]
	,[aifd] = cdc.[aifd]
	,[aifp] = cdc.[aifp]
	,[aifp_conv] = cdc.[aifp_conv]
	,[aicfce] = cdc.[aicfce]
	,[aicfce_conv] = cdc.[aicfce_conv]
	,[aiab2] = cdc.[aiab2]
	,[aiab2_conv] = cdc.[aiab2_conv]
	,[aidt1j] = cdc.[aidt1j]
	,[aidt1j_conv] = cdc.[aidt1j_conv]
	,[aidfij] = cdc.[aidfij]
	,[aidfij_conv] = cdc.[aidfij_conv]
	,[aidlij] = cdc.[aidlij]
	,[aidlij_conv] = cdc.[aidlij_conv]
	,[aiabc1] = cdc.[aiabc1]
	,[aiabc2] = cdc.[aiabc2]
	,[aiabc3] = cdc.[aiabc3]
	,[aifndj] = cdc.[aifndj]
	,[aifndj_conv] = cdc.[aifndj_conv]
	,[aidlp] = cdc.[aidlp]
	,[aidlp_conv] = cdc.[aidlp_conv]
	,[aidb] = cdc.[aidb]
	,[aidnbj] = cdc.[aidnbj]
	,[aidnbj_conv] = cdc.[aidnbj_conv]
	,[aitrw] = cdc.[aitrw]
	,[aitwdj] = cdc.[aitwdj]
	,[aitwdj_conv] = cdc.[aitwdj_conv]
	,[aiavd] = cdc.[aiavd]
	,[aicrca] = cdc.[aicrca]
	,[aicrca_conv] = cdc.[aicrca_conv]
	,[aiad] = cdc.[aiad]
	,[aiad_conv] = cdc.[aiad_conv]
	,[aiafcp] = cdc.[aiafcp]
	,[aiafcp_conv] = cdc.[aiafcp_conv]
	,[aiafcy] = cdc.[aiafcy]
	,[aiafcy_conv] = cdc.[aiafcy_conv]
	,[aiasty] = cdc.[aiasty]
	,[aiasty_conv] = cdc.[aiasty_conv]
	,[aispye] = cdc.[aispye]
	,[aispye_conv] = cdc.[aispye_conv]
	,[aiahb] = cdc.[aiahb]
	,[aiahb_conv] = cdc.[aiahb_conv]
	,[aialp] = cdc.[aialp]
	,[aialp_conv] = cdc.[aialp_conv]
	,[aiabam] = cdc.[aiabam]
	,[aiabam_conv] = cdc.[aiabam_conv]
	,[aiaba1] = cdc.[aiaba1]
	,[aiaba1_conv] = cdc.[aiaba1_conv]
	,[aiaprc] = cdc.[aiaprc]
	,[aiaprc_conv] = cdc.[aiaprc_conv]
	,[aimaxo] = cdc.[aimaxo]
	,[aimaxo_conv] = cdc.[aimaxo_conv]
	,[aimino] = cdc.[aimino]
	,[aimino_conv] = cdc.[aimino_conv]
	,[aioytd] = cdc.[aioytd]
	,[aiopy] = cdc.[aiopy]
	,[aipopn] = cdc.[aipopn]
	,[aipopn_conv] = cdc.[aipopn_conv]
	,[aidaoj] = cdc.[aidaoj]
	,[aidaoj_conv] = cdc.[aidaoj_conv]
	,[aian8r] = cdc.[aian8r]
	,[aibadt] = cdc.[aibadt]
	,[aicpgp] = cdc.[aicpgp]
	,[aiortp] = cdc.[aiortp]
	,[aitrdc] = cdc.[aitrdc]
	,[aitrdc_conv] = cdc.[aitrdc_conv]
	,[aiinmg] = cdc.[aiinmg]
	,[aiexhd] = cdc.[aiexhd]
	,[aiexhd_conv] = cdc.[aiexhd_conv]
	,[aihold] = cdc.[aihold]
	,[airout] = cdc.[airout]
	,[aistop] = cdc.[aistop]
	,[aizon] = cdc.[aizon]
	,[aicars] = cdc.[aicars]
	,[aicars_conv] = cdc.[aicars_conv]
	,[aidel1] = cdc.[aidel1]
	,[aidel1_conv] = cdc.[aidel1_conv]
	,[aidel2] = cdc.[aidel2]
	,[aidel2_conv] = cdc.[aidel2_conv]
	,[ailtdt] = cdc.[ailtdt]
	,[ailtdt_conv] = cdc.[ailtdt_conv]
	,[aifrth] = cdc.[aifrth]
	,[aiaft] = cdc.[aiaft]
	,[aiaft_conv] = cdc.[aiaft_conv]
	,[aiapts] = cdc.[aiapts]
	,[aiapts_conv] = cdc.[aiapts_conv]
	,[aisbal] = cdc.[aisbal]
	,[aisbal_conv] = cdc.[aisbal_conv]
	,[aiback] = cdc.[aiback]
	,[aiback_conv] = cdc.[aiback_conv]
	,[aiporq] = cdc.[aiporq]
	,[aiporq_conv] = cdc.[aiporq_conv]
	,[aiprio] = cdc.[aiprio]
	,[aiarto] = cdc.[aiarto]
	,[aiinvc] = cdc.[aiinvc]
	,[aiinvc_conv] = cdc.[aiinvc_conv]
	,[aiicon] = cdc.[aiicon]
	,[aiicon_conv] = cdc.[aiicon_conv]
	,[aiblfr] = cdc.[aiblfr]
	,[ainivd] = cdc.[ainivd]
	,[ainivd_conv] = cdc.[ainivd_conv]
	,[ailedj] = cdc.[ailedj]
	,[ailedj_conv] = cdc.[ailedj_conv]
	,[aiplst] = cdc.[aiplst]
	,[aiplst_conv] = cdc.[aiplst_conv]
	,[aimord] = cdc.[aimord]
	,[aimord_conv] = cdc.[aimord_conv]
	,[aicmc1] = cdc.[aicmc1]
	,[aicmc1_conv] = cdc.[aicmc1_conv]
	,[aicmr1] = cdc.[aicmr1]
	,[aicmr1_conv] = cdc.[aicmr1_conv]
	,[aicmc2] = cdc.[aicmc2]
	,[aicmc2_conv] = cdc.[aicmc2_conv]
	,[aicmr2] = cdc.[aicmr2]
	,[aicmr2_conv] = cdc.[aicmr2_conv]
	,[aipalc] = cdc.[aipalc]
	,[aipalc_conv] = cdc.[aipalc_conv]
	,[aivumd] = cdc.[aivumd]
	,[aiwumd] = cdc.[aiwumd]
	,[aiedpm] = cdc.[aiedpm]
	,[aiedii] = cdc.[aiedii]
	,[aiedci] = cdc.[aiedci]
	,[aiedqd] = cdc.[aiedqd]
	,[aiedad] = cdc.[aiedad]
	,[aiedf1] = cdc.[aiedf1]
	,[aiedf1_conv] = cdc.[aiedf1_conv]
	,[aiedf2] = cdc.[aiedf2]
	,[aisi01] = cdc.[aisi01]
	,[aisi01_conv] = cdc.[aisi01_conv]
	,[aisi02] = cdc.[aisi02]
	,[aisi02_conv] = cdc.[aisi02_conv]
	,[aisi03] = cdc.[aisi03]
	,[aisi03_conv] = cdc.[aisi03_conv]
	,[aisi04] = cdc.[aisi04]
	,[aisi04_conv] = cdc.[aisi04_conv]
	,[aisi05] = cdc.[aisi05]
	,[aisi05_conv] = cdc.[aisi05_conv]
	,[aiurcd] = cdc.[aiurcd]
	,[aiurcd_conv] = cdc.[aiurcd_conv]
	,[aiurat] = cdc.[aiurat]
	,[aiurat_conv] = cdc.[aiurat_conv]
	,[aiurab] = cdc.[aiurab]
	,[aiurab_conv] = cdc.[aiurab_conv]
	,[aiurdt] = cdc.[aiurdt]
	,[aiurdt_conv] = cdc.[aiurdt_conv]
	,[aiurrf] = cdc.[aiurrf]
	,[aiurrf_conv] = cdc.[aiurrf_conv]
	,[aicp01] = cdc.[aicp01]
	,[aiasn] = cdc.[aiasn]
	,[aidspa] = cdc.[aidspa]
	,[aidspa_conv] = cdc.[aidspa_conv]
	,[aicrmd] = cdc.[aicrmd]
	,[aiply] = cdc.[aiply]
	,[aiman8] = cdc.[aiman8]
	,[aiarl] = cdc.[aiarl]
	,[aiarl_conv] = cdc.[aiarl_conv]
	,[aiamcr] = cdc.[aiamcr]
	,[aiac01] = cdc.[aiac01]
	,[aiac02] = cdc.[aiac02]
	,[aiac03] = cdc.[aiac03]
	,[aiac04] = cdc.[aiac04]
	,[aiac05] = cdc.[aiac05]
	,[aiac06] = cdc.[aiac06]
	,[aiac07] = cdc.[aiac07]
	,[aiac08] = cdc.[aiac08]
	,[aiac09] = cdc.[aiac09]
	,[aiac10] = cdc.[aiac10]
	,[aiac11] = cdc.[aiac11]
	,[aiac12] = cdc.[aiac12]
	,[aiac13] = cdc.[aiac13]
	,[aiac14] = cdc.[aiac14]
	,[aiac15] = cdc.[aiac15]
	,[aiac16] = cdc.[aiac16]
	,[aiac17] = cdc.[aiac17]
	,[aiac18] = cdc.[aiac18]
	,[aiac19] = cdc.[aiac19]
	,[aiac20] = cdc.[aiac20]
	,[aiac21] = cdc.[aiac21]
	,[aiac22] = cdc.[aiac22]
	,[aiac23] = cdc.[aiac23]
	,[aiac24] = cdc.[aiac24]
	,[aiac25] = cdc.[aiac25]
	,[aiac26] = cdc.[aiac26]
	,[aiac27] = cdc.[aiac27]
	,[aiac28] = cdc.[aiac28]
	,[aiac29] = cdc.[aiac29]
	,[aiac30] = cdc.[aiac30]
	,[aislpg] = cdc.[aislpg]
	,[aislpg_conv] = cdc.[aislpg_conv]
	,[aisldw] = cdc.[aisldw]
	,[aisldw_conv] = cdc.[aisldw_conv]
	,[aicfpp] = cdc.[aicfpp]
	,[aicfpp_conv] = cdc.[aicfpp_conv]
	,[aicfsp] = cdc.[aicfsp]
	,[aicfsp_conv] = cdc.[aicfsp_conv]
	,[aicfdf] = cdc.[aicfdf]
	,[aicfdf_conv] = cdc.[aicfdf_conv]
	,[airq01] = cdc.[airq01]
	,[airq01_conv] = cdc.[airq01_conv]
	,[airq02] = cdc.[airq02]
	,[airq02_conv] = cdc.[airq02_conv]
	,[aidr03] = cdc.[aidr03]
	,[aidr04] = cdc.[aidr04]
	,[airq03] = cdc.[airq03]
	,[airq03_conv] = cdc.[airq03_conv]
	,[airq04] = cdc.[airq04]
	,[airq04_conv] = cdc.[airq04_conv]
	,[airq05] = cdc.[airq05]
	,[airq05_conv] = cdc.[airq05_conv]
	,[airq06] = cdc.[airq06]
	,[airq06_conv] = cdc.[airq06_conv]
	,[airq07] = cdc.[airq07]
	,[airq07_conv] = cdc.[airq07_conv]
	,[airq08] = cdc.[airq08]
	,[airq08_conv] = cdc.[airq08_conv]
	,[aidr08] = cdc.[aidr08]
	,[aidr09] = cdc.[aidr09]
	,[airq09] = cdc.[airq09]
	,[airq09_conv] = cdc.[airq09_conv]
	,[aiuser] = cdc.[aiuser]
	,[aiuser_conv] = cdc.[aiuser_conv]
	,[aipid] = cdc.[aipid]
	,[aipid_conv] = cdc.[aipid_conv]
	,[aiupmj] = cdc.[aiupmj]
	,[aiupmj_conv] = cdc.[aiupmj_conv]
	,[aiupmt] = cdc.[aiupmt]
	,[aijobn] = cdc.[aijobn]
	,[aijobn_conv] = cdc.[aijobn_conv]
	,[aiprgf] = cdc.[aiprgf]
	,[aiprgf_conv] = cdc.[aiprgf_conv]
	,[aibyal] = cdc.[aibyal]
	,[aibyal_conv] = cdc.[aibyal_conv]
	,[aibsc] = cdc.[aibsc]
	,[aiashl] = cdc.[aiashl]
	,[aiashl_conv] = cdc.[aiashl_conv]
	,[aiprsn] = cdc.[aiprsn]
	,[aiprsn_conv] = cdc.[aiprsn_conv]
	,[aiopbo] = cdc.[aiopbo]
	,[aiapsb] = cdc.[aiapsb]
	,[aiapsb_conv] = cdc.[aiapsb_conv]
	,[aitier1] = cdc.[aitier1]
	,[aipwpcp] = cdc.[aipwpcp]
	,[aipwpcp_conv] = cdc.[aipwpcp_conv]
	,[aicusts] = cdc.[aicusts]
	,[aistof] = cdc.[aistof]
	,[aistof_conv] = cdc.[aistof_conv]
	,[aiterrid] = cdc.[aiterrid]
	,[aiterrid_conv] = cdc.[aiterrid_conv]
	,[aicig] = cdc.[aicig]
	,[aicig_conv] = cdc.[aicig_conv]
	,[aitorg] = cdc.[aitorg]
	,[aitorg_conv] = cdc.[aitorg_conv]
	,[aidtee] = cdc.[aidtee]
	,[aidtee_conv] = cdc.[aidtee_conv]
	,[aisyncs] = cdc.[aisyncs]
	,[aicaad] = cdc.[aicaad]
	,[aigopasf] = cdc.[aigopasf] -- exclude distribution column
FROM stg_jde.tmp_upsert_f03012_cdc cdc
WHERE
    rep_jde.f03012_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde.f03012_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde.f03012_new AF:{{ task_instance_key_str }}' ) 
