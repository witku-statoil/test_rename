-- Insert new rows from upsert table into rep new table
INSERT INTO rep_jde_qat.f4941_new
(
    	sys_file_name
	,sys_file_ln
	,sys_integration_id
	,sys_extract_dt
	,sys_cdc_dt
	,sys_cdc_scn
	,sys_cdc_operation_type
	,sys_cdc_before_after
	,sys_line_modified_ind
	,rsshpn
	,rsrssn
	,rsmot
	,rsovrm
	,rsovrm_conv
	,rscars
	,rscars_conv
	,rsovrc
	,rsovrc_conv
	,rsrout
	,rsrtn
	,rsdlno
	,rsfrsc
	,rsczon
	,rsvmcu
	,rsvmcu_conv
	,rsldnm
	,rstrpl
	,rstrpl_conv
	,rsstsq
	,rsanid
	,rsorgn
	,rsancc
	,rswgts
	,rswgts_conv
	,rswtum
	,rsscvl
	,rsscvl_conv
	,rsvlum
	,rslgts
	,rslgts_conv
	,rswths
	,rswths_conv
	,rshgts
	,rshgts_conv
	,rsgths
	,rsgths_conv
	,rsluom
	,rsnpcs
	,rsnpcs_conv
	,rsnctr
	,rsnctr_conv
	,rsccub
	,rsccub_conv
	,rsdstn
	,rsumd1
	,rsdsrc
	,rseltm
	,rsum
	,rsaexp
	,rsaexp_conv
	,rsfea
	,rsfea_conv
	,rscrcd
	,rscrcd_conv
	,rsecst
	,rsecst_conv
	,rsppdj
	,rsppdj_conv
	,rspmdt
	,rsrsdj
	,rsrsdj_conv
	,rsrsdt
	,rslddt
	,rslddt_conv
	,rsldtm
	,rsaddj
	,rsaddj_conv
	,rsadtm
	,rsdldt
	,rsdldt_conv
	,rsdltm
	,rsrrtr
	,rsratr
	,rsdpcr
	,rsdpcr_conv
	,rsrefq
	,rsrefn
	,rsrefn_conv
	,rsfrtd
	,rsfrtd_conv
	,rsfrtv
	,rsfrtv_conv
	,rsfrvc
	,rsfrvc_conv
	,rsfrvf
	,rsfrvf_conv
	,rscrcp
	,rscrcp_conv
	,rsfrcc
	,rsfrcc_conv
	,rsfrcf
	,rsfrcf_conv
	,rscrdc
	,rscrdc_conv
	,rsintf
	,rsintf_conv
	,rsibrs
	,rsibrs_conv
	,rslslt
	,rslsut
	,rslalt
	,rslaut
	,rstpuf
	,rstput
	,rstdlf
	,rstdlt
	,rsdepu
	,rsdepu_conv
	,rsdlpu
	,rsdlpu_conv
	,rsdedl
	,rsdedl_conv
	,rsdldl
	,rsdldl_conv
	,rsdkid
	,rsdkid_conv
	,rsprnb
	,rsprte
	,rsprte_conv
	,rslnmb
	,rscnmr
	,rscnmr_conv
	,rsurcd
	,rsurcd_conv
	,rsurdt
	,rsurdt_conv
	,rsurat
	,rsurat_conv
	,rsurab
	,rsurab_conv
	,rsurrf
	,rsurrf_conv
	,rsuser
	,rsuser_conv
	,rspid
	,rspid_conv
	,rsjobn
	,rsjobn_conv
	,rsupmj
	,rsupmj_conv
	,rstday
)
SELECT
    	cdc.sys_file_name
	,cdc.sys_file_ln
	,cdc.sys_integration_id
	,cdc.sys_extract_dt
	,cdc.sys_cdc_dt
	,cdc.sys_cdc_scn
	,cdc.sys_cdc_operation_type
	,cdc.sys_cdc_before_after
	,cdc.sys_line_modified_ind
	,cdc.rsshpn
	,cdc.rsrssn
	,cdc.rsmot
	,cdc.rsovrm
	,cdc.rsovrm_conv
	,cdc.rscars
	,cdc.rscars_conv
	,cdc.rsovrc
	,cdc.rsovrc_conv
	,cdc.rsrout
	,cdc.rsrtn
	,cdc.rsdlno
	,cdc.rsfrsc
	,cdc.rsczon
	,cdc.rsvmcu
	,cdc.rsvmcu_conv
	,cdc.rsldnm
	,cdc.rstrpl
	,cdc.rstrpl_conv
	,cdc.rsstsq
	,cdc.rsanid
	,cdc.rsorgn
	,cdc.rsancc
	,cdc.rswgts
	,cdc.rswgts_conv
	,cdc.rswtum
	,cdc.rsscvl
	,cdc.rsscvl_conv
	,cdc.rsvlum
	,cdc.rslgts
	,cdc.rslgts_conv
	,cdc.rswths
	,cdc.rswths_conv
	,cdc.rshgts
	,cdc.rshgts_conv
	,cdc.rsgths
	,cdc.rsgths_conv
	,cdc.rsluom
	,cdc.rsnpcs
	,cdc.rsnpcs_conv
	,cdc.rsnctr
	,cdc.rsnctr_conv
	,cdc.rsccub
	,cdc.rsccub_conv
	,cdc.rsdstn
	,cdc.rsumd1
	,cdc.rsdsrc
	,cdc.rseltm
	,cdc.rsum
	,cdc.rsaexp
	,cdc.rsaexp_conv
	,cdc.rsfea
	,cdc.rsfea_conv
	,cdc.rscrcd
	,cdc.rscrcd_conv
	,cdc.rsecst
	,cdc.rsecst_conv
	,cdc.rsppdj
	,cdc.rsppdj_conv
	,cdc.rspmdt
	,cdc.rsrsdj
	,cdc.rsrsdj_conv
	,cdc.rsrsdt
	,cdc.rslddt
	,cdc.rslddt_conv
	,cdc.rsldtm
	,cdc.rsaddj
	,cdc.rsaddj_conv
	,cdc.rsadtm
	,cdc.rsdldt
	,cdc.rsdldt_conv
	,cdc.rsdltm
	,cdc.rsrrtr
	,cdc.rsratr
	,cdc.rsdpcr
	,cdc.rsdpcr_conv
	,cdc.rsrefq
	,cdc.rsrefn
	,cdc.rsrefn_conv
	,cdc.rsfrtd
	,cdc.rsfrtd_conv
	,cdc.rsfrtv
	,cdc.rsfrtv_conv
	,cdc.rsfrvc
	,cdc.rsfrvc_conv
	,cdc.rsfrvf
	,cdc.rsfrvf_conv
	,cdc.rscrcp
	,cdc.rscrcp_conv
	,cdc.rsfrcc
	,cdc.rsfrcc_conv
	,cdc.rsfrcf
	,cdc.rsfrcf_conv
	,cdc.rscrdc
	,cdc.rscrdc_conv
	,cdc.rsintf
	,cdc.rsintf_conv
	,cdc.rsibrs
	,cdc.rsibrs_conv
	,cdc.rslslt
	,cdc.rslsut
	,cdc.rslalt
	,cdc.rslaut
	,cdc.rstpuf
	,cdc.rstput
	,cdc.rstdlf
	,cdc.rstdlt
	,cdc.rsdepu
	,cdc.rsdepu_conv
	,cdc.rsdlpu
	,cdc.rsdlpu_conv
	,cdc.rsdedl
	,cdc.rsdedl_conv
	,cdc.rsdldl
	,cdc.rsdldl_conv
	,cdc.rsdkid
	,cdc.rsdkid_conv
	,cdc.rsprnb
	,cdc.rsprte
	,cdc.rsprte_conv
	,cdc.rslnmb
	,cdc.rscnmr
	,cdc.rscnmr_conv
	,cdc.rsurcd
	,cdc.rsurcd_conv
	,cdc.rsurdt
	,cdc.rsurdt_conv
	,cdc.rsurat
	,cdc.rsurat_conv
	,cdc.rsurab
	,cdc.rsurab_conv
	,cdc.rsurrf
	,cdc.rsurrf_conv
	,cdc.rsuser
	,cdc.rsuser_conv
	,cdc.rspid
	,cdc.rspid_conv
	,cdc.rsjobn
	,cdc.rsjobn_conv
	,cdc.rsupmj
	,cdc.rsupmj_conv
	,cdc.rstday
FROM stg_jde_qat.tmp_upsert_f4941_cdc cdc
LEFT OUTER JOIN rep_jde_qat.f4941_new f ON cdc.sys_integration_id = f.sys_integration_id
WHERE f.sys_integration_id IS NULL
OPTION ( LABEL = 'INSERT_rep_jde_qat.f4941_new AF:{{ task_instance_key_str }}' ) 