-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f4941_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[rsshpn] = cdc.[rsshpn]
	,[rsrssn] = cdc.[rsrssn]
	,[rsmot] = cdc.[rsmot]
	,[rsovrm] = cdc.[rsovrm]
	,[rsovrm_conv] = cdc.[rsovrm_conv]
	,[rscars] = cdc.[rscars]
	,[rscars_conv] = cdc.[rscars_conv]
	,[rsovrc] = cdc.[rsovrc]
	,[rsovrc_conv] = cdc.[rsovrc_conv]
	,[rsrout] = cdc.[rsrout]
	,[rsrtn] = cdc.[rsrtn]
	,[rsdlno] = cdc.[rsdlno]
	,[rsfrsc] = cdc.[rsfrsc]
	,[rsczon] = cdc.[rsczon]
	,[rsvmcu] = cdc.[rsvmcu]
	,[rsvmcu_conv] = cdc.[rsvmcu_conv]
	,[rsldnm] = cdc.[rsldnm]
	,[rstrpl] = cdc.[rstrpl]
	,[rstrpl_conv] = cdc.[rstrpl_conv]
	,[rsstsq] = cdc.[rsstsq]
	,[rsanid] = cdc.[rsanid]
	,[rsorgn] = cdc.[rsorgn]
	,[rsancc] = cdc.[rsancc]
	,[rswgts] = cdc.[rswgts]
	,[rswgts_conv] = cdc.[rswgts_conv]
	,[rswtum] = cdc.[rswtum]
	,[rsscvl] = cdc.[rsscvl]
	,[rsscvl_conv] = cdc.[rsscvl_conv]
	,[rsvlum] = cdc.[rsvlum]
	,[rslgts] = cdc.[rslgts]
	,[rslgts_conv] = cdc.[rslgts_conv]
	,[rswths] = cdc.[rswths]
	,[rswths_conv] = cdc.[rswths_conv]
	,[rshgts] = cdc.[rshgts]
	,[rshgts_conv] = cdc.[rshgts_conv]
	,[rsgths] = cdc.[rsgths]
	,[rsgths_conv] = cdc.[rsgths_conv]
	,[rsluom] = cdc.[rsluom]
	,[rsnpcs] = cdc.[rsnpcs]
	,[rsnpcs_conv] = cdc.[rsnpcs_conv]
	,[rsnctr] = cdc.[rsnctr]
	,[rsnctr_conv] = cdc.[rsnctr_conv]
	,[rsccub] = cdc.[rsccub]
	,[rsccub_conv] = cdc.[rsccub_conv]
	,[rsdstn] = cdc.[rsdstn]
	,[rsumd1] = cdc.[rsumd1]
	,[rsdsrc] = cdc.[rsdsrc]
	,[rseltm] = cdc.[rseltm]
	,[rsum] = cdc.[rsum]
	,[rsaexp] = cdc.[rsaexp]
	,[rsaexp_conv] = cdc.[rsaexp_conv]
	,[rsfea] = cdc.[rsfea]
	,[rsfea_conv] = cdc.[rsfea_conv]
	,[rscrcd] = cdc.[rscrcd]
	,[rscrcd_conv] = cdc.[rscrcd_conv]
	,[rsecst] = cdc.[rsecst]
	,[rsecst_conv] = cdc.[rsecst_conv]
	,[rsppdj] = cdc.[rsppdj]
	,[rsppdj_conv] = cdc.[rsppdj_conv]
	,[rspmdt] = cdc.[rspmdt]
	,[rsrsdj] = cdc.[rsrsdj]
	,[rsrsdj_conv] = cdc.[rsrsdj_conv]
	,[rsrsdt] = cdc.[rsrsdt]
	,[rslddt] = cdc.[rslddt]
	,[rslddt_conv] = cdc.[rslddt_conv]
	,[rsldtm] = cdc.[rsldtm]
	,[rsaddj] = cdc.[rsaddj]
	,[rsaddj_conv] = cdc.[rsaddj_conv]
	,[rsadtm] = cdc.[rsadtm]
	,[rsdldt] = cdc.[rsdldt]
	,[rsdldt_conv] = cdc.[rsdldt_conv]
	,[rsdltm] = cdc.[rsdltm]
	,[rsrrtr] = cdc.[rsrrtr]
	,[rsratr] = cdc.[rsratr]
	,[rsdpcr] = cdc.[rsdpcr]
	,[rsdpcr_conv] = cdc.[rsdpcr_conv]
	,[rsrefq] = cdc.[rsrefq]
	,[rsrefn] = cdc.[rsrefn]
	,[rsrefn_conv] = cdc.[rsrefn_conv]
	,[rsfrtd] = cdc.[rsfrtd]
	,[rsfrtd_conv] = cdc.[rsfrtd_conv]
	,[rsfrtv] = cdc.[rsfrtv]
	,[rsfrtv_conv] = cdc.[rsfrtv_conv]
	,[rsfrvc] = cdc.[rsfrvc]
	,[rsfrvc_conv] = cdc.[rsfrvc_conv]
	,[rsfrvf] = cdc.[rsfrvf]
	,[rsfrvf_conv] = cdc.[rsfrvf_conv]
	,[rscrcp] = cdc.[rscrcp]
	,[rscrcp_conv] = cdc.[rscrcp_conv]
	,[rsfrcc] = cdc.[rsfrcc]
	,[rsfrcc_conv] = cdc.[rsfrcc_conv]
	,[rsfrcf] = cdc.[rsfrcf]
	,[rsfrcf_conv] = cdc.[rsfrcf_conv]
	,[rscrdc] = cdc.[rscrdc]
	,[rscrdc_conv] = cdc.[rscrdc_conv]
	,[rsintf] = cdc.[rsintf]
	,[rsintf_conv] = cdc.[rsintf_conv]
	,[rsibrs] = cdc.[rsibrs]
	,[rsibrs_conv] = cdc.[rsibrs_conv]
	,[rslslt] = cdc.[rslslt]
	,[rslsut] = cdc.[rslsut]
	,[rslalt] = cdc.[rslalt]
	,[rslaut] = cdc.[rslaut]
	,[rstpuf] = cdc.[rstpuf]
	,[rstput] = cdc.[rstput]
	,[rstdlf] = cdc.[rstdlf]
	,[rstdlt] = cdc.[rstdlt]
	,[rsdepu] = cdc.[rsdepu]
	,[rsdepu_conv] = cdc.[rsdepu_conv]
	,[rsdlpu] = cdc.[rsdlpu]
	,[rsdlpu_conv] = cdc.[rsdlpu_conv]
	,[rsdedl] = cdc.[rsdedl]
	,[rsdedl_conv] = cdc.[rsdedl_conv]
	,[rsdldl] = cdc.[rsdldl]
	,[rsdldl_conv] = cdc.[rsdldl_conv]
	,[rsdkid] = cdc.[rsdkid]
	,[rsdkid_conv] = cdc.[rsdkid_conv]
	,[rsprnb] = cdc.[rsprnb]
	,[rsprte] = cdc.[rsprte]
	,[rsprte_conv] = cdc.[rsprte_conv]
	,[rslnmb] = cdc.[rslnmb]
	,[rscnmr] = cdc.[rscnmr]
	,[rscnmr_conv] = cdc.[rscnmr_conv]
	,[rsurcd] = cdc.[rsurcd]
	,[rsurcd_conv] = cdc.[rsurcd_conv]
	,[rsurdt] = cdc.[rsurdt]
	,[rsurdt_conv] = cdc.[rsurdt_conv]
	,[rsurat] = cdc.[rsurat]
	,[rsurat_conv] = cdc.[rsurat_conv]
	,[rsurab] = cdc.[rsurab]
	,[rsurab_conv] = cdc.[rsurab_conv]
	,[rsurrf] = cdc.[rsurrf]
	,[rsurrf_conv] = cdc.[rsurrf_conv]
	,[rsuser] = cdc.[rsuser]
	,[rsuser_conv] = cdc.[rsuser_conv]
	,[rspid] = cdc.[rspid]
	,[rspid_conv] = cdc.[rspid_conv]
	,[rsjobn] = cdc.[rsjobn]
	,[rsjobn_conv] = cdc.[rsjobn_conv]
	,[rsupmj] = cdc.[rsupmj]
	,[rsupmj_conv] = cdc.[rsupmj_conv]
	,[rstday] = cdc.[rstday] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f4941_cdc cdc
WHERE
    rep_jde_qat.f4941_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f4941_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f4941_new AF:{{ task_instance_key_str }}' ) 
