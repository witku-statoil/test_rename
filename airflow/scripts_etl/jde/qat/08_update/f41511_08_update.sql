-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f41511_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[padoc] = cdc.[padoc]
	,[pajeln] = cdc.[pajeln]
	,[padct] = cdc.[padct]
	,[pakco] = cdc.[pakco]
	,[pakco_conv] = cdc.[pakco_conv]
	,[padoco] = cdc.[padoco]
	,[padcto] = cdc.[padcto]
	,[pakcoo] = cdc.[pakcoo]
	,[pakcoo_conv] = cdc.[pakcoo_conv]
	,[palnid] = cdc.[palnid]
	,[palnid_conv] = cdc.[palnid_conv]
	,[panlin] = cdc.[panlin]
	,[padgl] = cdc.[padgl]
	,[padgl_conv] = cdc.[padgl_conv]
	,[patrdj] = cdc.[patrdj]
	,[patrdj_conv] = cdc.[patrdj_conv]
	,[paicu] = cdc.[paicu]
	,[patrcd] = cdc.[patrcd]
	,[patrcd_conv] = cdc.[patrcd_conv]
	,[pamcu] = cdc.[pamcu]
	,[pamcu_conv] = cdc.[pamcu_conv]
	,[patkid] = cdc.[patkid]
	,[patkid_conv] = cdc.[patkid_conv]
	,[paitm] = cdc.[paitm]
	,[patrno] = cdc.[patrno]
	,[patemp] = cdc.[patemp]
	,[patemp_conv] = cdc.[patemp_conv]
	,[pastpu] = cdc.[pastpu]
	,[padnty] = cdc.[padnty]
	,[padnty_conv] = cdc.[padnty_conv]
	,[padntp] = cdc.[padntp]
	,[padetp] = cdc.[padetp]
	,[padetp_conv] = cdc.[padetp_conv]
	,[padtpu] = cdc.[padtpu]
	,[paambr] = cdc.[paambr]
	,[paambr_conv] = cdc.[paambr_conv]
	,[pabum3] = cdc.[pabum3]
	,[paambi] = cdc.[paambi]
	,[paambi_conv] = cdc.[paambi_conv]
	,[paambu] = cdc.[paambu]
	,[pavcf] = cdc.[pavcf]
	,[pavcf_conv] = cdc.[pavcf_conv]
	,[pastok] = cdc.[pastok]
	,[pastok_conv] = cdc.[pastok_conv]
	,[pabum4] = cdc.[pabum4]
	,[pawgtr] = cdc.[pawgtr]
	,[pawgtr_conv] = cdc.[pawgtr_conv]
	,[pabum5] = cdc.[pabum5]
	,[pastum] = cdc.[pastum]
	,[pastum_conv] = cdc.[pastum_conv]
	,[pabum6] = cdc.[pabum6]
	,[parcd] = cdc.[parcd]
	,[paupcf] = cdc.[paupcf]
	,[paupcf_conv] = cdc.[paupcf_conv]
	,[palotn] = cdc.[palotn]
	,[palotn_conv] = cdc.[palotn_conv]
	,[palots] = cdc.[palots]
	,[pammej] = cdc.[pammej]
	,[pammej_conv] = cdc.[pammej_conv]
	,[pauncs] = cdc.[pauncs]
	,[pauncs_conv] = cdc.[pauncs_conv]
	,[paecst] = cdc.[paecst]
	,[paecst_conv] = cdc.[paecst_conv]
	,[patrex] = cdc.[patrex]
	,[patrex_conv] = cdc.[patrex_conv]
	,[paan8] = cdc.[paan8]
	,[padmct] = cdc.[padmct]
	,[padmct_conv] = cdc.[padmct_conv]
	,[padmcs] = cdc.[padmcs]
	,[paacor] = cdc.[paacor]
	,[paacor_conv] = cdc.[paacor_conv]
	,[pahcor] = cdc.[pahcor]
	,[pahcor_conv] = cdc.[pahcor_conv]
	,[padipt] = cdc.[padipt]
	,[pagdip] = cdc.[pagdip]
	,[pagdip_conv] = cdc.[pagdip_conv]
	,[pawdip] = cdc.[pawdip]
	,[pawdip_conv] = cdc.[pawdip_conv]
	,[pavapp] = cdc.[pavapp]
	,[pavapp_conv] = cdc.[pavapp_conv]
	,[papreu] = cdc.[papreu]
	,[palpgv] = cdc.[palpgv]
	,[palpgv_conv] = cdc.[palpgv_conv]
	,[patpu1] = cdc.[patpu1]
	,[paslip] = cdc.[paslip]
	,[pavapw] = cdc.[pavapw]
	,[pavapw_conv] = cdc.[pavapw_conv]
	,[pabum0] = cdc.[pabum0]
	,[pavapv] = cdc.[pavapv]
	,[pavapv_conv] = cdc.[pavapv_conv]
	,[pabum9] = cdc.[pabum9]
	,[paliqw] = cdc.[paliqw]
	,[paliqw_conv] = cdc.[paliqw_conv]
	,[pabum7] = cdc.[pabum7]
	,[paliqv] = cdc.[paliqv]
	,[paliqv_conv] = cdc.[paliqv_conv]
	,[pabum8] = cdc.[pabum8]
	,[paovol] = cdc.[paovol]
	,[paovol_conv] = cdc.[paovol_conv]
	,[pabum2] = cdc.[pabum2]
	,[pardtm] = cdc.[pardtm]
	,[padte] = cdc.[padte]
	,[padte_conv] = cdc.[padte_conv]
	,[pametn] = cdc.[pametn]
	,[pametn_conv] = cdc.[pametn_conv]
	,[paopnr] = cdc.[paopnr]
	,[paopnr_conv] = cdc.[paopnr_conv]
	,[papncr] = cdc.[papncr]
	,[papncr_conv] = cdc.[papncr_conv]
	,[pavehi] = cdc.[pavehi]
	,[pavehi_conv] = cdc.[pavehi_conv]
	,[pavmcu] = cdc.[pavmcu]
	,[pavmcu_conv] = cdc.[pavmcu_conv]
	,[patrp] = cdc.[patrp]
	,[pacmpn] = cdc.[pacmpn]
	,[pacmpn_conv] = cdc.[pacmpn_conv]
	,[pabfwt] = cdc.[pabfwt]
	,[pabfwt_conv] = cdc.[pabfwt_conv]
	,[pabwtu] = cdc.[pabwtu]
	,[paafwt] = cdc.[paafwt]
	,[paafwt_conv] = cdc.[paafwt_conv]
	,[paawtu] = cdc.[paawtu]
	,[pathdt] = cdc.[pathdt]
	,[pathdt_conv] = cdc.[pathdt_conv]
	,[paopdt] = cdc.[paopdt]
	,[paopdt_conv] = cdc.[paopdt_conv]
	,[palrst] = cdc.[palrst]
	,[parecs] = cdc.[parecs]
	,[papgms] = cdc.[papgms]
	,[paglrn] = cdc.[paglrn]
	,[paglrn_conv] = cdc.[paglrn_conv]
	,[paptnr] = cdc.[paptnr]
	,[paurcd] = cdc.[paurcd]
	,[paurcd_conv] = cdc.[paurcd_conv]
	,[paurat] = cdc.[paurat]
	,[paurat_conv] = cdc.[paurat_conv]
	,[paurab] = cdc.[paurab]
	,[paurab_conv] = cdc.[paurab_conv]
	,[paurrf] = cdc.[paurrf]
	,[paurrf_conv] = cdc.[paurrf_conv]
	,[paurdt] = cdc.[paurdt]
	,[paurdt_conv] = cdc.[paurdt_conv]
	,[pauser] = cdc.[pauser]
	,[pauser_conv] = cdc.[pauser_conv]
	,[papid] = cdc.[papid]
	,[papid_conv] = cdc.[papid_conv]
	,[pajobn] = cdc.[pajobn]
	,[pajobn_conv] = cdc.[pajobn_conv]
	,[paupmj] = cdc.[paupmj]
	,[paupmj_conv] = cdc.[paupmj_conv]
	,[patday] = cdc.[patday]
	,[paukid] = cdc.[paukid]
	,[pabpas] = cdc.[pabpas]
	,[pabpas_conv] = cdc.[pabpas_conv]
	,[palotc] = cdc.[palotc]
	,[palotc_conv] = cdc.[palotc_conv] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f41511_cdc cdc
WHERE
    rep_jde_qat.f41511_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f41511_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f41511_new AF:{{ task_instance_key_str }}' ) 
