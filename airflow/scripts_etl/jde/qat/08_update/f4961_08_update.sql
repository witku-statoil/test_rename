-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f4961_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[llvmcu] = cdc.[llvmcu]
	,[llvmcu_conv] = cdc.[llvmcu_conv]
	,[llldnm] = cdc.[llldnm]
	,[lltrpl] = cdc.[lltrpl]
	,[lltrpl_conv] = cdc.[lltrpl_conv]
	,[llorgn] = cdc.[llorgn]
	,[llnmcu] = cdc.[llnmcu]
	,[llnmcu_conv] = cdc.[llnmcu_conv]
	,[llstsq] = cdc.[llstsq]
	,[llscwt] = cdc.[llscwt]
	,[llscwt_conv] = cdc.[llscwt_conv]
	,[llwtum] = cdc.[llwtum]
	,[llscvl] = cdc.[llscvl]
	,[llscvl_conv] = cdc.[llscvl_conv]
	,[llvlum] = cdc.[llvlum]
	,[llsccu] = cdc.[llsccu]
	,[llsccu_conv] = cdc.[llsccu_conv]
	,[llcvum] = cdc.[llcvum]
	,[lllddt] = cdc.[lllddt]
	,[lllddt_conv] = cdc.[lllddt_conv]
	,[llldtm] = cdc.[llldtm]
	,[llload] = cdc.[llload]
	,[llload_conv] = cdc.[llload_conv]
	,[lltmls] = cdc.[lltmls]
	,[llppdj] = cdc.[llppdj]
	,[llppdj_conv] = cdc.[llppdj_conv]
	,[llpmdt] = cdc.[llpmdt]
	,[lladdj] = cdc.[lladdj]
	,[lladdj_conv] = cdc.[lladdj_conv]
	,[lladtm] = cdc.[lladtm]
	,[lllrfg] = cdc.[lllrfg]
	,[lllrfg_conv] = cdc.[lllrfg_conv]
	,[llpcsd] = cdc.[llpcsd]
	,[llpcsd_conv] = cdc.[llpcsd_conv]
	,[lldwnc] = cdc.[lldwnc]
	,[llurcd] = cdc.[llurcd]
	,[llurcd_conv] = cdc.[llurcd_conv]
	,[llurdt] = cdc.[llurdt]
	,[llurdt_conv] = cdc.[llurdt_conv]
	,[llurat] = cdc.[llurat]
	,[llurat_conv] = cdc.[llurat_conv]
	,[llurab] = cdc.[llurab]
	,[llurab_conv] = cdc.[llurab_conv]
	,[llurrf] = cdc.[llurrf]
	,[llurrf_conv] = cdc.[llurrf_conv]
	,[lluser] = cdc.[lluser]
	,[lluser_conv] = cdc.[lluser_conv]
	,[llpid] = cdc.[llpid]
	,[llpid_conv] = cdc.[llpid_conv]
	,[lljobn] = cdc.[lljobn]
	,[lljobn_conv] = cdc.[lljobn_conv]
	,[llupmj] = cdc.[llupmj]
	,[llupmj_conv] = cdc.[llupmj_conv]
	,[lltday] = cdc.[lltday] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f4961_cdc cdc
WHERE
    rep_jde_qat.f4961_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f4961_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f4961_new AF:{{ task_instance_key_str }}' ) 
