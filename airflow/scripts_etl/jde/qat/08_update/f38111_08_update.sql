-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f38111_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[dzdmct] = cdc.[dzdmct]
	,[dzdmct_conv] = cdc.[dzdmct_conv]
	,[dzdmcs] = cdc.[dzdmcs]
	,[dzdmtc] = cdc.[dzdmtc]
	,[dzan8] = cdc.[dzan8]
	,[dzan8r] = cdc.[dzan8r]
	,[dzitm] = cdc.[dzitm]
	,[dzmcu] = cdc.[dzmcu]
	,[dzmcu_conv] = cdc.[dzmcu_conv]
	,[dzco] = cdc.[dzco]
	,[dzco_conv] = cdc.[dzco_conv]
	,[dzlocn] = cdc.[dzlocn]
	,[dzlocn_conv] = cdc.[dzlocn_conv]
	,[dzlot] = cdc.[dzlot]
	,[dzlot_conv] = cdc.[dzlot_conv]
	,[dztcaj] = cdc.[dztcaj]
	,[dztrdj] = cdc.[dztrdj]
	,[dztrdj_conv] = cdc.[dztrdj_conv]
	,[dzadjj] = cdc.[dzadjj]
	,[dzadjj_conv] = cdc.[dzadjj_conv]
	,[dzdct] = cdc.[dzdct]
	,[dzdoc] = cdc.[dzdoc]
	,[dzkco] = cdc.[dzkco]
	,[dzkco_conv] = cdc.[dzkco_conv]
	,[dzjeln] = cdc.[dzjeln]
	,[dzdoco] = cdc.[dzdoco]
	,[dzdcto] = cdc.[dzdcto]
	,[dzkcoo] = cdc.[dzkcoo]
	,[dzkcoo_conv] = cdc.[dzkcoo_conv]
	,[dzlnid] = cdc.[dzlnid]
	,[dzlnid_conv] = cdc.[dzlnid_conv]
	,[dzvehi] = cdc.[dzvehi]
	,[dzvehi_conv] = cdc.[dzvehi_conv]
	,[dzvmcu] = cdc.[dzvmcu]
	,[dzvmcu_conv] = cdc.[dzvmcu_conv]
	,[dztrp] = cdc.[dztrp]
	,[dzcmpn] = cdc.[dzcmpn]
	,[dzcmpn_conv] = cdc.[dzcmpn_conv]
	,[dzdto] = cdc.[dzdto]
	,[dzdes] = cdc.[dzdes]
	,[dzdes_conv] = cdc.[dzdes_conv]
	,[dzdesy] = cdc.[dzdesy]
	,[dzpsr] = cdc.[dzpsr]
	,[dzpsr_conv] = cdc.[dzpsr_conv]
	,[dzpsry] = cdc.[dzpsry]
	,[dzseq] = cdc.[dzseq]
	,[dztrex] = cdc.[dztrex]
	,[dztrex_conv] = cdc.[dztrex_conv]
	,[dztrqt] = cdc.[dztrqt]
	,[dztrqt_conv] = cdc.[dztrqt_conv]
	,[dzuom] = cdc.[dzuom]
	,[dztemp] = cdc.[dztemp]
	,[dztemp_conv] = cdc.[dztemp_conv]
	,[dzstpu] = cdc.[dzstpu]
	,[dzdnty] = cdc.[dzdnty]
	,[dzdnty_conv] = cdc.[dzdnty_conv]
	,[dzdntp] = cdc.[dzdntp]
	,[dzdetp] = cdc.[dzdetp]
	,[dzdetp_conv] = cdc.[dzdetp_conv]
	,[dzdtpu] = cdc.[dzdtpu]
	,[dzambr] = cdc.[dzambr]
	,[dzambr_conv] = cdc.[dzambr_conv]
	,[dzambu] = cdc.[dzambu]
	,[dzvcf] = cdc.[dzvcf]
	,[dzvcf_conv] = cdc.[dzvcf_conv]
	,[dzstok] = cdc.[dzstok]
	,[dzstok_conv] = cdc.[dzstok_conv]
	,[dzbum4] = cdc.[dzbum4]
	,[dzwgtr] = cdc.[dzwgtr]
	,[dzwgtr_conv] = cdc.[dzwgtr_conv]
	,[dzbum5] = cdc.[dzbum5]
	,[dzstum] = cdc.[dzstum]
	,[dzstum_conv] = cdc.[dzstum_conv]
	,[dzbum6] = cdc.[dzbum6]
	,[dzpras] = cdc.[dzpras]
	,[dzaa] = cdc.[dzaa]
	,[dzaa_conv] = cdc.[dzaa_conv]
	,[dzcrcd] = cdc.[dzcrcd]
	,[dzcrcd_conv] = cdc.[dzcrcd_conv]
	,[dzuncs] = cdc.[dzuncs]
	,[dzuncs_conv] = cdc.[dzuncs_conv]
	,[dzpaid] = cdc.[dzpaid]
	,[dzpaid_conv] = cdc.[dzpaid_conv]
	,[dzdgl] = cdc.[dzdgl]
	,[dzdgl_conv] = cdc.[dzdgl_conv]
	,[dzicu] = cdc.[dzicu]
	,[dzicut] = cdc.[dzicut]
	,[dzglpt] = cdc.[dzglpt]
	,[dzadzr] = cdc.[dzadzr]
	,[dzadzr_conv] = cdc.[dzadzr_conv]
	,[dzrcd] = cdc.[dzrcd]
	,[dzrecs] = cdc.[dzrecs]
	,[dzcrdj] = cdc.[dzcrdj]
	,[dzcrdj_conv] = cdc.[dzcrdj_conv]
	,[dzukid] = cdc.[dzukid]
	,[dzupgl] = cdc.[dzupgl]
	,[dzupgl_conv] = cdc.[dzupgl_conv]
	,[dzsvpf] = cdc.[dzsvpf]
	,[dzsvpf_conv] = cdc.[dzsvpf_conv]
	,[dzsvpd] = cdc.[dzsvpd]
	,[dzsvpd_conv] = cdc.[dzsvpd_conv]
	,[dzprtf] = cdc.[dzprtf]
	,[dzcrpo] = cdc.[dzcrpo]
	,[dzcrpo_conv] = cdc.[dzcrpo_conv]
	,[dzcrso] = cdc.[dzcrso]
	,[dzcrso_conv] = cdc.[dzcrso_conv]
	,[dzcdmc] = cdc.[dzcdmc]
	,[dzcdmc_conv] = cdc.[dzcdmc_conv]
	,[dzcand] = cdc.[dzcand]
	,[dzcand_conv] = cdc.[dzcand_conv]
	,[dzcanr] = cdc.[dzcanr]
	,[dztv01] = cdc.[dztv01]
	,[dztv01_conv] = cdc.[dztv01_conv]
	,[dztv02] = cdc.[dztv02]
	,[dztv02_conv] = cdc.[dztv02_conv]
	,[dztv03] = cdc.[dztv03]
	,[dztv03_conv] = cdc.[dztv03_conv]
	,[dzurcd] = cdc.[dzurcd]
	,[dzurcd_conv] = cdc.[dzurcd_conv]
	,[dzurdt] = cdc.[dzurdt]
	,[dzurdt_conv] = cdc.[dzurdt_conv]
	,[dzurat] = cdc.[dzurat]
	,[dzurat_conv] = cdc.[dzurat_conv]
	,[dzurab] = cdc.[dzurab]
	,[dzurab_conv] = cdc.[dzurab_conv]
	,[dzurrf] = cdc.[dzurrf]
	,[dzurrf_conv] = cdc.[dzurrf_conv]
	,[dzuser] = cdc.[dzuser]
	,[dzuser_conv] = cdc.[dzuser_conv]
	,[dzpid] = cdc.[dzpid]
	,[dzpid_conv] = cdc.[dzpid_conv]
	,[dzjobn] = cdc.[dzjobn]
	,[dzjobn_conv] = cdc.[dzjobn_conv]
	,[dzupmj] = cdc.[dzupmj]
	,[dzupmj_conv] = cdc.[dzupmj_conv]
	,[dztday] = cdc.[dztday] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f38111_cdc cdc
WHERE
    rep_jde_qat.f38111_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f38111_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f38111_new AF:{{ task_instance_key_str }}' ) 
