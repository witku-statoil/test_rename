-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f4801t_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[wadoco] = cdc.[wadoco]
	,[waline] = cdc.[waline]
	,[waline_conv] = cdc.[waline_conv]
	,[wamwdh] = cdc.[wamwdh]
	,[wascsp] = cdc.[wascsp]
	,[washft] = cdc.[washft]
	,[wasrcn] = cdc.[wasrcn]
	,[waledg] = cdc.[waledg]
	,[wacts4] = cdc.[wacts4]
	,[wacts4_conv] = cdc.[wacts4_conv]
	,[wacts7] = cdc.[wacts7]
	,[wacts7_conv] = cdc.[wacts7_conv]
	,[wacts8] = cdc.[wacts8]
	,[wacts8_conv] = cdc.[wacts8_conv]
	,[waaid] = cdc.[waaid]
	,[waaid_conv] = cdc.[waaid_conv]
	,[waalse] = cdc.[waalse]
	,[waalse_conv] = cdc.[waalse_conv]
	,[waasid] = cdc.[waasid]
	,[waasid_conv] = cdc.[waasid_conv]
	,[waatst] = cdc.[waatst]
	,[waatst_conv] = cdc.[waatst_conv]
	,[wabseq] = cdc.[wabseq]
	,[wabseq_conv] = cdc.[wabseq_conv]
	,[wachpr] = cdc.[wachpr]
	,[wachpr_conv] = cdc.[wachpr_conv]
	,[wacrcd] = cdc.[wacrcd]
	,[wacrcd_conv] = cdc.[wacrcd_conv]
	,[wacrce] = cdc.[wacrce]
	,[wacrce_conv] = cdc.[wacrce_conv]
	,[wacrcf] = cdc.[wacrcf]
	,[wacrcf_conv] = cdc.[wacrcf_conv]
	,[wad5j] = cdc.[wad5j]
	,[wad5j_conv] = cdc.[wad5j_conv]
	,[wad6j] = cdc.[wad6j]
	,[wad6j_conv] = cdc.[wad6j_conv]
	,[wadraw] = cdc.[wadraw]
	,[wadraw_conv] = cdc.[wadraw_conv]
	,[wadual] = cdc.[wadual]
	,[wadual_conv] = cdc.[wadual_conv]
	,[wampce] = cdc.[wampce]
	,[wamprc] = cdc.[wamprc]
	,[waobj] = cdc.[waobj]
	,[waobj_conv] = cdc.[waobj_conv]
	,[waotam] = cdc.[waotam]
	,[waotam_conv] = cdc.[waotam_conv]
	,[waprjm] = cdc.[waprjm]
	,[waprjm_conv] = cdc.[waprjm_conv]
	,[waprrp] = cdc.[waprrp]
	,[waprrp_conv] = cdc.[waprrp_conv]
	,[washpp] = cdc.[washpp]
	,[wasqor] = cdc.[wasqor]
	,[wasqor_conv] = cdc.[wasqor_conv]
	,[wasrkf] = cdc.[wasrkf]
	,[wasrnk] = cdc.[wasrnk]
	,[wasrnk_conv] = cdc.[wasrnk_conv]
	,[wassoq] = cdc.[wassoq]
	,[wassoq_conv] = cdc.[wassoq_conv]
	,[watraf] = cdc.[watraf]
	,[wauom2] = cdc.[wauom2]
	,[wawr11] = cdc.[wawr11]
	,[wawr12] = cdc.[wawr12]
	,[wawr13] = cdc.[wawr13]
	,[wawr14] = cdc.[wawr14]
	,[wawr15] = cdc.[wawr15]
	,[wawr16] = cdc.[wawr16]
	,[wawr17] = cdc.[wawr17]
	,[wawr18] = cdc.[wawr18]
	,[wawr19] = cdc.[wawr19]
	,[wawr20] = cdc.[wawr20]
	,[wajbcd] = cdc.[wajbcd]
	,[wavfwo] = cdc.[wavfwo]
	,[wavfwo_conv] = cdc.[wavfwo_conv]
	,[wapmtn] = cdc.[wapmtn]
	,[wapmtn_conv] = cdc.[wapmtn_conv]
	,[waissue] = cdc.[waissue]
	,[waissue_conv] = cdc.[waissue_conv]
	,[waprodm] = cdc.[waprodm]
	,[wawho2] = cdc.[wawho2]
	,[wawho2_conv] = cdc.[wawho2_conv]
	,[waar1] = cdc.[waar1]
	,[waar1_conv] = cdc.[waar1_conv]
	,[waphn1] = cdc.[waphn1]
	,[waphn1_conv] = cdc.[waphn1_conv]
	,[watmco] = cdc.[watmco]
	,[wamthpr] = cdc.[wamthpr]
	,[waentck] = cdc.[waentck]
	,[waryin] = cdc.[waryin]
	,[warstm] = cdc.[warstm]
	,[warstm_conv] = cdc.[warstm_conv]
	,[wactr] = cdc.[wactr]
	,[waregion] = cdc.[waregion]
	,[watxa1] = cdc.[watxa1]
	,[watxa1_conv] = cdc.[watxa1_conv]
	,[waexr1] = cdc.[waexr1]
	,[walngp] = cdc.[walngp]
	,[waglccv] = cdc.[waglccv]
	,[waglcnc] = cdc.[waglcnc]
	,[wacovgr] = cdc.[wacovgr]
	,[waasn4] = cdc.[waasn4]
	,[waasn2] = cdc.[waasn2]
	,[wasest] = cdc.[wasest]
	,[waseet] = cdc.[waseet]
	,[wadsavname] = cdc.[wadsavname]
	,[wadsavname_conv] = cdc.[wadsavname_conv]
	,[watimezones] = cdc.[watimezones]
	,[waprodf] = cdc.[waprodf]
	,[wacslprt] = cdc.[wacslprt]
	,[wacslprt_conv] = cdc.[wacslprt_conv]
	,[wamcucsl] = cdc.[wamcucsl]
	,[wamcucsl_conv] = cdc.[wamcucsl_conv]
	,[warlot] = cdc.[warlot]
	,[warlot_conv] = cdc.[warlot_conv]
	,[wafailcd] = cdc.[wafailcd]
	,[wafaildt] = cdc.[wafaildt]
	,[wafaildt_conv] = cdc.[wafaildt_conv]
	,[wafailtm] = cdc.[wafailtm]
	,[wafailtm_conv] = cdc.[wafailtm_conv]
	,[warepdt] = cdc.[warepdt]
	,[warepdt_conv] = cdc.[warepdt_conv]
	,[wareptm] = cdc.[wareptm]
	,[wareptm_conv] = cdc.[wareptm_conv]
	,[wavend] = cdc.[wavend]
	,[wavend_conv] = cdc.[wavend_conv]
	,[waan8as] = cdc.[waan8as]
	,[waan8as_conv] = cdc.[waan8as_conv]
	,[waan8srm] = cdc.[waan8srm]
	,[waan8srm_conv] = cdc.[waan8srm_conv]
	,[wasryn] = cdc.[wasryn]
	,[waentcks] = cdc.[waentcks]
	,[waentcks_conv] = cdc.[waentcks_conv]
	,[wacurbalm1] = cdc.[wacurbalm1]
	,[wacurbalm1_conv] = cdc.[wacurbalm1_conv]
	,[wacurbalm2] = cdc.[wacurbalm2]
	,[wacurbalm2_conv] = cdc.[wacurbalm2_conv]
	,[wacurbalm3] = cdc.[wacurbalm3]
	,[wacurbalm3_conv] = cdc.[wacurbalm3_conv]
	,[wacrdc] = cdc.[wacrdc]
	,[wacrdc_conv] = cdc.[wacrdc_conv]
	,[wacrrm] = cdc.[wacrrm]
	,[wacrr] = cdc.[wacrr]
	,[wavmrs31] = cdc.[wavmrs31]
	,[wavmrs32] = cdc.[wavmrs32]
	,[waseqn] = cdc.[waseqn]
	,[waplmr] = cdc.[waplmr]
	,[waplmr_conv] = cdc.[waplmr_conv]
	,[wapllb] = cdc.[wapllb]
	,[wapllb_conv] = cdc.[wapllb_conv]
	,[waplos] = cdc.[waplos]
	,[waplos_conv] = cdc.[waplos_conv]
	,[wabgtc] = cdc.[wabgtc]
	,[wabgtc_conv] = cdc.[wabgtc_conv]
	,[watoem] = cdc.[watoem]
	,[watoem_conv] = cdc.[watoem_conv]
	,[watopl] = cdc.[watopl]
	,[watopl_conv] = cdc.[watopl_conv]
	,[waplsa] = cdc.[waplsa]
	,[waplsa_conv] = cdc.[waplsa_conv]
	,[waplsu] = cdc.[waplsu]
	,[waplsu_conv] = cdc.[waplsu_conv]
	,[waessa] = cdc.[waessa]
	,[waessa_conv] = cdc.[waessa_conv]
	,[waessu] = cdc.[waessu]
	,[waessu_conv] = cdc.[waessu_conv]
	,[waacsa] = cdc.[waacsa]
	,[waacsa_conv] = cdc.[waacsa_conv]
	,[waacsu] = cdc.[waacsu]
	,[waacsu_conv] = cdc.[waacsu_conv]
	,[waoacm] = cdc.[waoacm]
	,[waoacm_conv] = cdc.[waoacm_conv]
	,[waracm] = cdc.[waracm]
	,[waracm_conv] = cdc.[waracm_conv]
	,[wahplf] = cdc.[wahplf]
	,[wahplf_conv] = cdc.[wahplf_conv]
	,[wavmrs33] = cdc.[wavmrs33]
	,[wascall] = cdc.[wascall]
	,[waisno] = cdc.[waisno]
	,[warmthd] = cdc.[warmthd]
	,[warmthd_conv] = cdc.[warmthd_conv]
	,[wadoc] = cdc.[wadoc]
	,[wadct] = cdc.[wadct]
	,[wakco] = cdc.[wakco]
	,[wakco_conv] = cdc.[wakco_conv]
	,[wacoch] = cdc.[wacoch]
	,[wacoch_conv] = cdc.[wacoch_conv]
	,[walnid] = cdc.[walnid]
	,[walnid_conv] = cdc.[walnid_conv]
	,[wacrtu] = cdc.[wacrtu]
	,[wacrtu_conv] = cdc.[wacrtu_conv]
	,[waxevt] = cdc.[waxevt]
	,[waxevt_conv] = cdc.[waxevt_conv]
	,[wamcult] = cdc.[wamcult]
	,[wamcult_conv] = cdc.[wamcult_conv]
	,[wawschf] = cdc.[wawschf]
	,[wadfmdp] = cdc.[wadfmdp]
	,[wadfmdp_conv] = cdc.[wadfmdp_conv]
	,[wapmpn] = cdc.[wapmpn]
	,[wapmpn_conv] = cdc.[wapmpn_conv]
	,[wapns] = cdc.[wapns] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f4801t_cdc cdc
WHERE
    rep_jde_qat.f4801t_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f4801t_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f4801t_new AF:{{ task_instance_key_str }}' ) 
