-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f554103_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[alresc] = cdc.[alresc]
	,[alresc_conv] = cdc.[alresc_conv]
	,[alukid] = cdc.[alukid]
	,[altrmnum] = cdc.[altrmnum]
	,[altrmnum_conv] = cdc.[altrmnum_conv]
	,[alfrto] = cdc.[alfrto]
	,[alfrto_conv] = cdc.[alfrto_conv]
	,[aledbt] = cdc.[aledbt]
	,[aledbt_conv] = cdc.[aledbt_conv]
	,[aledtn] = cdc.[aledtn]
	,[aledtn_conv] = cdc.[aledtn_conv]
	,[alfrsq] = cdc.[alfrsq]
	,[alfrsq_conv] = cdc.[alfrsq_conv]
	,[aly55sttsl] = cdc.[aly55sttsl]
	,[almcu] = cdc.[almcu]
	,[almcu_conv] = cdc.[almcu_conv]
	,[alddday] = cdc.[alddday]
	,[alddday_conv] = cdc.[alddday_conv]
	,[altday] = cdc.[altday]
	,[alvehi] = cdc.[alvehi]
	,[alvehi_conv] = cdc.[alvehi_conv]
	,[aly55owid] = cdc.[aly55owid]
	,[aly55owid_conv] = cdc.[aly55owid_conv]
	,[alitm] = cdc.[alitm]
	,[allitm] = cdc.[allitm]
	,[allitm_conv] = cdc.[allitm_conv]
	,[alaitm] = cdc.[alaitm]
	,[alaitm_conv] = cdc.[alaitm_conv]
	,[alambr] = cdc.[alambr]
	,[alambr_conv] = cdc.[alambr_conv]
	,[aluom1] = cdc.[aluom1]
	,[album3] = cdc.[album3]
	,[alyshipty] = cdc.[alyshipty]
	,[alyshipty_conv] = cdc.[alyshipty_conv]
	,[allocn] = cdc.[allocn]
	,[allocn_conv] = cdc.[allocn_conv]
	,[aly55aglc] = cdc.[aly55aglc]
	,[aly55agto] = cdc.[aly55agto]
	,[alsid] = cdc.[alsid]
	,[alsid_conv] = cdc.[alsid_conv]
	,[alstok] = cdc.[alstok]
	,[alstok_conv] = cdc.[alstok_conv]
	,[aluom2] = cdc.[aluom2]
	,[album4] = cdc.[album4]
	,[alanby] = cdc.[alanby]
	,[alancc] = cdc.[alancc]
	,[alan8] = cdc.[alan8]
	,[alshan] = cdc.[alshan]
	,[aly55wbno] = cdc.[aly55wbno]
	,[aly55wbno_conv] = cdc.[aly55wbno_conv]
	,[alldty] = cdc.[alldty]
	,[altkid] = cdc.[altkid]
	,[altkid_conv] = cdc.[altkid_conv]
	,[altemp] = cdc.[altemp]
	,[altemp_conv] = cdc.[altemp_conv]
	,[aluom3] = cdc.[aluom3]
	,[alstpu] = cdc.[alstpu]
	,[alvlc1] = cdc.[alvlc1]
	,[alvlc1_conv] = cdc.[alvlc1_conv]
	,[aldnty] = cdc.[aldnty]
	,[aldnty_conv] = cdc.[aldnty_conv]
	,[aldend] = cdc.[aldend]
	,[aldend_conv] = cdc.[aldend_conv]
	,[aldntp] = cdc.[aldntp]
	,[almetn] = cdc.[almetn]
	,[almetn_conv] = cdc.[almetn_conv]
	,[aly55cpnm] = cdc.[aly55cpnm]
	,[aly55crdid] = cdc.[aly55crdid]
	,[aldsc1] = cdc.[aldsc1]
	,[aldsc1_conv] = cdc.[aldsc1_conv]
	,[alflag] = cdc.[alflag]
	,[alflag_conv] = cdc.[alflag_conv]
	,[aly55txt1] = cdc.[aly55txt1]
	,[aly55txt1_conv] = cdc.[aly55txt1_conv]
	,[alev01] = cdc.[alev01]
	,[alev01_conv] = cdc.[alev01_conv]
	,[alev02] = cdc.[alev02]
	,[alev02_conv] = cdc.[alev02_conv]
	,[alev03] = cdc.[alev03]
	,[alev03_conv] = cdc.[alev03_conv]
	,[alev04] = cdc.[alev04]
	,[alev04_conv] = cdc.[alev04_conv]
	,[alev05] = cdc.[alev05]
	,[alev05_conv] = cdc.[alev05_conv]
	,[alkcoo] = cdc.[alkcoo]
	,[alkcoo_conv] = cdc.[alkcoo_conv]
	,[aldcto] = cdc.[aldcto]
	,[aldoco] = cdc.[aldoco]
	,[allnid] = cdc.[allnid]
	,[allnid_conv] = cdc.[allnid_conv]
	,[alrkco] = cdc.[alrkco]
	,[alrkco_conv] = cdc.[alrkco_conv]
	,[alrcto] = cdc.[alrcto]
	,[alrorn] = cdc.[alrorn]
	,[alrorn_conv] = cdc.[alrorn_conv]
	,[alxlin] = cdc.[alxlin]
	,[alxlin_conv] = cdc.[alxlin_conv]
	,[alkco] = cdc.[alkco]
	,[alkco_conv] = cdc.[alkco_conv]
	,[aldct] = cdc.[aldct]
	,[aldoc] = cdc.[aldoc]
	,[allinn] = cdc.[allinn]
	,[allinn_conv] = cdc.[allinn_conv]
	,[alokco] = cdc.[alokco]
	,[alokco_conv] = cdc.[alokco_conv]
	,[alocto] = cdc.[alocto]
	,[aloorn] = cdc.[aloorn]
	,[aloorn_conv] = cdc.[aloorn_conv]
	,[alogno] = cdc.[alogno]
	,[alogno_conv] = cdc.[alogno_conv]
	,[alskco] = cdc.[alskco]
	,[alskco_conv] = cdc.[alskco_conv]
	,[alsdct] = cdc.[alsdct]
	,[alsdoc] = cdc.[alsdoc]
	,[alslne] = cdc.[alslne]
	,[alslne_conv] = cdc.[alslne_conv]
	,[alicu] = cdc.[alicu]
	,[altd1] = cdc.[altd1]
	,[altd1_conv] = cdc.[altd1_conv]
	,[aluser] = cdc.[aluser]
	,[aluser_conv] = cdc.[aluser_conv]
	,[alpid] = cdc.[alpid]
	,[alpid_conv] = cdc.[alpid_conv]
	,[aljobn] = cdc.[aljobn]
	,[aljobn_conv] = cdc.[aljobn_conv]
	,[alupmj] = cdc.[alupmj]
	,[alupmj_conv] = cdc.[alupmj_conv]
	,[alupmt] = cdc.[alupmt]
	,[als1fu] = cdc.[als1fu]
	,[als1fu_conv] = cdc.[als1fu_conv]
	,[als2fu] = cdc.[als2fu]
	,[als2fu_conv] = cdc.[als2fu_conv]
	,[alfuf9] = cdc.[alfuf9]
	,[alfuf9_conv] = cdc.[alfuf9_conv]
	,[alpstm] = cdc.[alpstm]
	,[alcburst1] = cdc.[alcburst1]
	,[alcburst1_conv] = cdc.[alcburst1_conv]
	,[alcburst2] = cdc.[alcburst2]
	,[alcburst2_conv] = cdc.[alcburst2_conv]
	,[aleaurst1] = cdc.[aleaurst1]
	,[aleaurst1_conv] = cdc.[aleaurst1_conv]
	,[aly55amnt1] = cdc.[aly55amnt1]
	,[aly55amnt1_conv] = cdc.[aly55amnt1_conv]
	,[aly55amnt2] = cdc.[aly55amnt2]
	,[aly55amnt2_conv] = cdc.[aly55amnt2_conv]
	,[aly55date1] = cdc.[aly55date1]
	,[aly55date1_conv] = cdc.[aly55date1_conv]
	,[aly55date2] = cdc.[aly55date2]
	,[aly55date2_conv] = cdc.[aly55date2_conv]
	,[aly55time1] = cdc.[aly55time1]
	,[aly55strg1] = cdc.[aly55strg1]
	,[aly55strg1_conv] = cdc.[aly55strg1_conv]
	,[aly55strg2] = cdc.[aly55strg2]
	,[aly55strg2_conv] = cdc.[aly55strg2_conv]
	,[aly55char1] = cdc.[aly55char1]
	,[aly55char1_conv] = cdc.[aly55char1_conv]
	,[aly55char2] = cdc.[aly55char2]
	,[aly55char2_conv] = cdc.[aly55char2_conv] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f554103_cdc cdc
WHERE
    rep_jde_qat.f554103_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f554103_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f554103_new AF:{{ task_instance_key_str }}' ) 
