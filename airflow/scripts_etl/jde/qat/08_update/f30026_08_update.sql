-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f30026_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[ieitm] = cdc.[ieitm]
	,[ielitm] = cdc.[ielitm]
	,[ielitm_conv] = cdc.[ielitm_conv]
	,[ieaitm] = cdc.[ieaitm]
	,[ieaitm_conv] = cdc.[ieaitm_conv]
	,[iemmcu] = cdc.[iemmcu]
	,[iemmcu_conv] = cdc.[iemmcu_conv]
	,[ielocn] = cdc.[ielocn]
	,[ielocn_conv] = cdc.[ielocn_conv]
	,[ielotn] = cdc.[ielotn]
	,[ielotn_conv] = cdc.[ielotn_conv]
	,[ieledg] = cdc.[ieledg]
	,[iecost] = cdc.[iecost]
	,[ielotg] = cdc.[ielotg]
	,[iestdc] = cdc.[iestdc]
	,[iestdc_conv] = cdc.[iestdc_conv]
	,[iexsmc] = cdc.[iexsmc]
	,[iexsmc_conv] = cdc.[iexsmc_conv]
	,[iecsl] = cdc.[iecsl]
	,[iecsl_conv] = cdc.[iecsl_conv]
	,[iexscr] = cdc.[iexscr]
	,[iexscr_conv] = cdc.[iexscr_conv]
	,[iesctc] = cdc.[iesctc]
	,[iesctc_conv] = cdc.[iesctc_conv]
	,[iexsfc] = cdc.[iexsfc]
	,[iexsfc_conv] = cdc.[iexsfc_conv]
	,[iestfc] = cdc.[iestfc]
	,[iestfc_conv] = cdc.[iestfc_conv]
	,[iexsf] = cdc.[iexsf]
	,[iexsf_conv] = cdc.[iexsf_conv]
	,[ierats] = cdc.[ierats]
	,[ierats_conv] = cdc.[ierats_conv]
	,[iexsrc] = cdc.[iexsrc]
	,[iexsrc_conv] = cdc.[iexsrc_conv]
	,[iertsd] = cdc.[iertsd]
	,[iertsd_conv] = cdc.[iertsd_conv]
	,[iexsr] = cdc.[iexsr]
	,[iexsr_conv] = cdc.[iexsr_conv]
	,[iepflg] = cdc.[iepflg]
	,[ieuser] = cdc.[ieuser]
	,[ieuser_conv] = cdc.[ieuser_conv]
	,[iepid] = cdc.[iepid]
	,[iepid_conv] = cdc.[iepid_conv]
	,[iejobn] = cdc.[iejobn]
	,[iejobn_conv] = cdc.[iejobn_conv]
	,[ieupmj] = cdc.[ieupmj]
	,[ieupmj_conv] = cdc.[ieupmj_conv]
	,[ietday] = cdc.[ietday]
	,[ieopsq] = cdc.[ieopsq]
	,[ieopsq_conv] = cdc.[ieopsq_conv]
	,[iemcul] = cdc.[iemcul]
	,[iemcul_conv] = cdc.[iemcul_conv]
	,[iewmcu] = cdc.[iewmcu]
	,[iewmcu_conv] = cdc.[iewmcu_conv]
	,[ielda] = cdc.[ielda]
	,[ielda_conv] = cdc.[ielda_conv]
	,[ietbm] = cdc.[ietbm]
	,[ieacq] = cdc.[ieacq]
	,[ieacq_conv] = cdc.[ieacq_conv]
	,[ief] = cdc.[ief]
	,[ief_conv] = cdc.[ief_conv] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f30026_cdc cdc
WHERE
    rep_jde_qat.f30026_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f30026_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f30026_new AF:{{ task_instance_key_str }}' ) 
