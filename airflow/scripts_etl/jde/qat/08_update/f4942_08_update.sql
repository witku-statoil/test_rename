-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f4942_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[isshpn] = cdc.[isshpn]
	,[isrssn] = cdc.[isrssn]
	,[isdoco] = cdc.[isdoco]
	,[isdcto] = cdc.[isdcto]
	,[iskcoo] = cdc.[iskcoo]
	,[iskcoo_conv] = cdc.[iskcoo_conv]
	,[islnid] = cdc.[islnid]
	,[islnid_conv] = cdc.[islnid_conv]
	,[iswgts] = cdc.[iswgts]
	,[iswgts_conv] = cdc.[iswgts_conv]
	,[iswtum] = cdc.[iswtum]
	,[isscvl] = cdc.[isscvl]
	,[isscvl_conv] = cdc.[isscvl_conv]
	,[isvlum] = cdc.[isvlum]
	,[isitm] = cdc.[isitm]
	,[issoqs] = cdc.[issoqs]
	,[issoqs_conv] = cdc.[issoqs_conv]
	,[isuom] = cdc.[isuom]
	,[isprp1] = cdc.[isprp1]
	,[isnmfc] = cdc.[isnmfc]
	,[isdsgp] = cdc.[isdsgp]
	,[ishzdc] = cdc.[ishzdc]
	,[isfrt1] = cdc.[isfrt1]
	,[isfrt2] = cdc.[isfrt2]
	,[isaexp] = cdc.[isaexp]
	,[isaexp_conv] = cdc.[isaexp_conv]
	,[isfea] = cdc.[isfea]
	,[isfea_conv] = cdc.[isfea_conv]
	,[iscrcd] = cdc.[iscrcd]
	,[iscrcd_conv] = cdc.[iscrcd_conv]
	,[isecst] = cdc.[isecst]
	,[isecst_conv] = cdc.[isecst_conv]
	,[isurcd] = cdc.[isurcd]
	,[isurcd_conv] = cdc.[isurcd_conv]
	,[isurdt] = cdc.[isurdt]
	,[isurdt_conv] = cdc.[isurdt_conv]
	,[isurat] = cdc.[isurat]
	,[isurat_conv] = cdc.[isurat_conv]
	,[isurab] = cdc.[isurab]
	,[isurab_conv] = cdc.[isurab_conv]
	,[isurrf] = cdc.[isurrf]
	,[isurrf_conv] = cdc.[isurrf_conv]
	,[isuser] = cdc.[isuser]
	,[isuser_conv] = cdc.[isuser_conv]
	,[ispid] = cdc.[ispid]
	,[ispid_conv] = cdc.[ispid_conv]
	,[isjobn] = cdc.[isjobn]
	,[isjobn_conv] = cdc.[isjobn_conv]
	,[isupmj] = cdc.[isupmj]
	,[isupmj_conv] = cdc.[isupmj_conv]
	,[istday] = cdc.[istday]
	,[iscums] = cdc.[iscums]
	,[iscums_conv] = cdc.[iscums_conv] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f4942_cdc cdc
WHERE
    rep_jde_qat.f4942_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f4942_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f4942_new AF:{{ task_instance_key_str }}' ) 
