-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f553402_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[mfy55fornu] = cdc.[mfy55fornu]
	,[mfy55fornu_conv] = cdc.[mfy55fornu_conv]
	,[mfitm] = cdc.[mfitm]
	,[mfan8] = cdc.[mfan8]
	,[mfky] = cdc.[mfky]
	,[mfky_conv] = cdc.[mfky_conv]
	,[mfalph] = cdc.[mfalph]
	,[mfalph_conv] = cdc.[mfalph_conv]
	,[mfbncv] = cdc.[mfbncv]
	,[mfbncv_conv] = cdc.[mfbncv_conv]
	,[mfc9dtpr] = cdc.[mfc9dtpr]
	,[mfc9dtpr_conv] = cdc.[mfc9dtpr_conv]
	,[mfc9perfrom] = cdc.[mfc9perfrom]
	,[mfc9perfrom_conv] = cdc.[mfc9perfrom_conv]
	,[mfc9perthru] = cdc.[mfc9perthru]
	,[mfc9perthru_conv] = cdc.[mfc9perthru_conv]
	,[mfbcnt] = cdc.[mfbcnt]
	,[mfbcnt_conv] = cdc.[mfbcnt_conv]
	,[mfalph2] = cdc.[mfalph2]
	,[mfalph2_conv] = cdc.[mfalph2_conv]
	,[mfemailfrom] = cdc.[mfemailfrom]
	,[mfemailfrom_conv] = cdc.[mfemailfrom_conv]
	,[mfalph3] = cdc.[mfalph3]
	,[mfalph3_conv] = cdc.[mfalph3_conv]
	,[mfemal] = cdc.[mfemal]
	,[mfemal_conv] = cdc.[mfemal_conv]
	,[mfmcu] = cdc.[mfmcu]
	,[mfmcu_conv] = cdc.[mfmcu_conv]
	,[mfcnr1] = cdc.[mfcnr1]
	,[mfcnr2] = cdc.[mfcnr2]
	,[mfcntf] = cdc.[mfcntf]
	,[mfcntf_conv] = cdc.[mfcntf_conv]
	,[mfrrqj] = cdc.[mfrrqj]
	,[mfrrqj_conv] = cdc.[mfrrqj_conv]
	,[mfyn] = cdc.[mfyn]
	,[mfyn_conv] = cdc.[mfyn_conv]
	,[mfdl01] = cdc.[mfdl01]
	,[mfdl01_conv] = cdc.[mfdl01_conv]
	,[mfansif] = cdc.[mfansif]
	,[mfansif_conv] = cdc.[mfansif_conv]
	,[mfdl02] = cdc.[mfdl02]
	,[mfdl02_conv] = cdc.[mfdl02_conv]
	,[mfdl03] = cdc.[mfdl03]
	,[mfdl03_conv] = cdc.[mfdl03_conv]
	,[mfdl04] = cdc.[mfdl04]
	,[mfdl04_conv] = cdc.[mfdl04_conv]
	,[mfabcs] = cdc.[mfabcs]
	,[mflitm] = cdc.[mflitm]
	,[mflitm_conv] = cdc.[mflitm_conv]
	,[mfdsc1] = cdc.[mfdsc1]
	,[mfdsc1_conv] = cdc.[mfdsc1_conv]
	,[mfcitm] = cdc.[mfcitm]
	,[mfcitm_conv] = cdc.[mfcitm_conv]
	,[mflnid] = cdc.[mflnid]
	,[mflnid_conv] = cdc.[mflnid_conv]
	,[mfuom] = cdc.[mfuom]
	,[mfy55plqty1] = cdc.[mfy55plqty1]
	,[mfy55plqty1_conv] = cdc.[mfy55plqty1_conv]
	,[mfy55cmqty1] = cdc.[mfy55cmqty1]
	,[mfy55cmqty1_conv] = cdc.[mfy55cmqty1_conv]
	,[mfy55plqty2] = cdc.[mfy55plqty2]
	,[mfy55plqty2_conv] = cdc.[mfy55plqty2_conv]
	,[mfy55cmqty2] = cdc.[mfy55cmqty2]
	,[mfy55cmqty2_conv] = cdc.[mfy55cmqty2_conv]
	,[mfy55plqty3] = cdc.[mfy55plqty3]
	,[mfy55plqty3_conv] = cdc.[mfy55plqty3_conv]
	,[mfy55cmqty3] = cdc.[mfy55cmqty3]
	,[mfy55cmqty3_conv] = cdc.[mfy55cmqty3_conv]
	,[mfy55plqty4] = cdc.[mfy55plqty4]
	,[mfy55plqty4_conv] = cdc.[mfy55plqty4_conv]
	,[mfy55cmqty4] = cdc.[mfy55cmqty4]
	,[mfy55cmqty4_conv] = cdc.[mfy55cmqty4_conv]
	,[mfy55plqty5] = cdc.[mfy55plqty5]
	,[mfy55plqty5_conv] = cdc.[mfy55plqty5_conv]
	,[mfy55cmqty5] = cdc.[mfy55cmqty5]
	,[mfy55cmqty5_conv] = cdc.[mfy55cmqty5_conv]
	,[mfy55plqty6] = cdc.[mfy55plqty6]
	,[mfy55plqty6_conv] = cdc.[mfy55plqty6_conv]
	,[mfy55cmqty6] = cdc.[mfy55cmqty6]
	,[mfy55cmqty6_conv] = cdc.[mfy55cmqty6_conv]
	,[mfy55plqty7] = cdc.[mfy55plqty7]
	,[mfy55plqty7_conv] = cdc.[mfy55plqty7_conv]
	,[mfy55cmqty7] = cdc.[mfy55cmqty7]
	,[mfy55cmqty7_conv] = cdc.[mfy55cmqty7_conv]
	,[mfy55plqty8] = cdc.[mfy55plqty8]
	,[mfy55plqty8_conv] = cdc.[mfy55plqty8_conv]
	,[mfy55cmqty8] = cdc.[mfy55cmqty8]
	,[mfy55cmqty8_conv] = cdc.[mfy55cmqty8_conv]
	,[mfy55plqty9] = cdc.[mfy55plqty9]
	,[mfy55plqty9_conv] = cdc.[mfy55plqty9_conv]
	,[mfy55cmqty9] = cdc.[mfy55cmqty9]
	,[mfy55cmqty9_conv] = cdc.[mfy55cmqty9_conv]
	,[mfy55plqty10] = cdc.[mfy55plqty10]
	,[mfy55plqty10_conv] = cdc.[mfy55plqty10_conv]
	,[mfy55cmqty10] = cdc.[mfy55cmqty10]
	,[mfy55cmqty10_conv] = cdc.[mfy55cmqty10_conv]
	,[mfy55plqty11] = cdc.[mfy55plqty11]
	,[mfy55plqty11_conv] = cdc.[mfy55plqty11_conv]
	,[mfy55cmqty11] = cdc.[mfy55cmqty11]
	,[mfy55cmqty11_conv] = cdc.[mfy55cmqty11_conv]
	,[mfy55plqty12] = cdc.[mfy55plqty12]
	,[mfy55plqty12_conv] = cdc.[mfy55plqty12_conv]
	,[mfy55cmqty12] = cdc.[mfy55cmqty12]
	,[mfy55cmqty12_conv] = cdc.[mfy55cmqty12_conv]
	,[mfplqty] = cdc.[mfplqty]
	,[mfplqty_conv] = cdc.[mfplqty_conv]
	,[mfflag] = cdc.[mfflag]
	,[mfflag_conv] = cdc.[mfflag_conv]
	,[mfnotiflg] = cdc.[mfnotiflg]
	,[mfnotiflg_conv] = cdc.[mfnotiflg_conv]
	,[mfcomments] = cdc.[mfcomments]
	,[mfcomments_conv] = cdc.[mfcomments_conv]
	,[mfurcd] = cdc.[mfurcd]
	,[mfurcd_conv] = cdc.[mfurcd_conv]
	,[mfurdt] = cdc.[mfurdt]
	,[mfurdt_conv] = cdc.[mfurdt_conv]
	,[mfurat] = cdc.[mfurat]
	,[mfurat_conv] = cdc.[mfurat_conv]
	,[mfurab] = cdc.[mfurab]
	,[mfurab_conv] = cdc.[mfurab_conv]
	,[mfurrf] = cdc.[mfurrf]
	,[mfurrf_conv] = cdc.[mfurrf_conv]
	,[mfuser] = cdc.[mfuser]
	,[mfuser_conv] = cdc.[mfuser_conv]
	,[mfpid] = cdc.[mfpid]
	,[mfpid_conv] = cdc.[mfpid_conv]
	,[mfupmj] = cdc.[mfupmj]
	,[mfupmj_conv] = cdc.[mfupmj_conv]
	,[mfjobn] = cdc.[mfjobn]
	,[mfjobn_conv] = cdc.[mfjobn_conv]
	,[mfupmt] = cdc.[mfupmt] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f553402_cdc cdc
WHERE
    rep_jde_qat.f553402_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f553402_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f553402_new AF:{{ task_instance_key_str }}' ) 
