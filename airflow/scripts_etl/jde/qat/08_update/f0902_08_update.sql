-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f0902_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[gbaid] = cdc.[gbaid]
	,[gbaid_conv] = cdc.[gbaid_conv]
	,[gbctry] = cdc.[gbctry]
	,[gbfy] = cdc.[gbfy]
	,[gbfy_conv] = cdc.[gbfy_conv]
	,[gbfq] = cdc.[gbfq]
	,[gblt] = cdc.[gblt]
	,[gbsbl] = cdc.[gbsbl]
	,[gbsbl_conv] = cdc.[gbsbl_conv]
	,[gbco] = cdc.[gbco]
	,[gbco_conv] = cdc.[gbco_conv]
	,[gbapyc] = cdc.[gbapyc]
	,[gbapyc_conv] = cdc.[gbapyc_conv]
	,[gban01] = cdc.[gban01]
	,[gban01_conv] = cdc.[gban01_conv]
	,[gban02] = cdc.[gban02]
	,[gban02_conv] = cdc.[gban02_conv]
	,[gban03] = cdc.[gban03]
	,[gban03_conv] = cdc.[gban03_conv]
	,[gban04] = cdc.[gban04]
	,[gban04_conv] = cdc.[gban04_conv]
	,[gban05] = cdc.[gban05]
	,[gban05_conv] = cdc.[gban05_conv]
	,[gban06] = cdc.[gban06]
	,[gban06_conv] = cdc.[gban06_conv]
	,[gban07] = cdc.[gban07]
	,[gban07_conv] = cdc.[gban07_conv]
	,[gban08] = cdc.[gban08]
	,[gban08_conv] = cdc.[gban08_conv]
	,[gban09] = cdc.[gban09]
	,[gban09_conv] = cdc.[gban09_conv]
	,[gban10] = cdc.[gban10]
	,[gban10_conv] = cdc.[gban10_conv]
	,[gban11] = cdc.[gban11]
	,[gban11_conv] = cdc.[gban11_conv]
	,[gban12] = cdc.[gban12]
	,[gban12_conv] = cdc.[gban12_conv]
	,[gban13] = cdc.[gban13]
	,[gban13_conv] = cdc.[gban13_conv]
	,[gban14] = cdc.[gban14]
	,[gban14_conv] = cdc.[gban14_conv]
	,[gbapyn] = cdc.[gbapyn]
	,[gbapyn_conv] = cdc.[gbapyn_conv]
	,[gbawtd] = cdc.[gbawtd]
	,[gbawtd_conv] = cdc.[gbawtd_conv]
	,[gbborg] = cdc.[gbborg]
	,[gbborg_conv] = cdc.[gbborg_conv]
	,[gbpou] = cdc.[gbpou]
	,[gbpou_conv] = cdc.[gbpou_conv]
	,[gbpc] = cdc.[gbpc]
	,[gbtker] = cdc.[gbtker]
	,[gbtker_conv] = cdc.[gbtker_conv]
	,[gbbreq] = cdc.[gbbreq]
	,[gbbreq_conv] = cdc.[gbbreq_conv]
	,[gbbapr] = cdc.[gbbapr]
	,[gbbapr_conv] = cdc.[gbbapr_conv]
	,[gbmcu] = cdc.[gbmcu]
	,[gbmcu_conv] = cdc.[gbmcu_conv]
	,[gbobj] = cdc.[gbobj]
	,[gbobj_conv] = cdc.[gbobj_conv]
	,[gbsub] = cdc.[gbsub]
	,[gbsub_conv] = cdc.[gbsub_conv]
	,[gbuser] = cdc.[gbuser]
	,[gbuser_conv] = cdc.[gbuser_conv]
	,[gbpid] = cdc.[gbpid]
	,[gbpid_conv] = cdc.[gbpid_conv]
	,[gbupmj] = cdc.[gbupmj]
	,[gbupmj_conv] = cdc.[gbupmj_conv]
	,[gbjobn] = cdc.[gbjobn]
	,[gbjobn_conv] = cdc.[gbjobn_conv]
	,[gbsblt] = cdc.[gbsblt]
	,[gbupmt] = cdc.[gbupmt]
	,[gbcrcd] = cdc.[gbcrcd]
	,[gbcrcd_conv] = cdc.[gbcrcd_conv]
	,[gbcrcx] = cdc.[gbcrcx]
	,[gbcrcx_conv] = cdc.[gbcrcx_conv]
	,[gbprgf] = cdc.[gbprgf]
	,[gbprgf_conv] = cdc.[gbprgf_conv]
	,[gband01] = cdc.[gband01]
	,[gband01_conv] = cdc.[gband01_conv]
	,[gband02] = cdc.[gband02]
	,[gband02_conv] = cdc.[gband02_conv]
	,[gband03] = cdc.[gband03]
	,[gband03_conv] = cdc.[gband03_conv]
	,[gband04] = cdc.[gband04]
	,[gband04_conv] = cdc.[gband04_conv]
	,[gband05] = cdc.[gband05]
	,[gband05_conv] = cdc.[gband05_conv]
	,[gband06] = cdc.[gband06]
	,[gband06_conv] = cdc.[gband06_conv]
	,[gband07] = cdc.[gband07]
	,[gband07_conv] = cdc.[gband07_conv]
	,[gband08] = cdc.[gband08]
	,[gband08_conv] = cdc.[gband08_conv]
	,[gband09] = cdc.[gband09]
	,[gband09_conv] = cdc.[gband09_conv]
	,[gband10] = cdc.[gband10]
	,[gband10_conv] = cdc.[gband10_conv]
	,[gband11] = cdc.[gband11]
	,[gband11_conv] = cdc.[gband11_conv]
	,[gband12] = cdc.[gband12]
	,[gband12_conv] = cdc.[gband12_conv]
	,[gband13] = cdc.[gband13]
	,[gband13_conv] = cdc.[gband13_conv]
	,[gband14] = cdc.[gband14]
	,[gband14_conv] = cdc.[gband14_conv] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f0902_cdc cdc
WHERE
    rep_jde_qat.f0902_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f0902_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f0902_new AF:{{ task_instance_key_str }}' ) 
