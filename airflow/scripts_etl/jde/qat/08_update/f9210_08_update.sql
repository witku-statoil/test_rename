-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f9210_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[frdtai] = cdc.[frdtai]
	,[frdtai_conv] = cdc.[frdtai_conv]
	,[frclas] = cdc.[frclas]
	,[frclas_conv] = cdc.[frclas_conv]
	,[frdtat] = cdc.[frdtat]
	,[frdtas] = cdc.[frdtas]
	,[frdtad] = cdc.[frdtad]
	,[frpdta] = cdc.[frpdta]
	,[frpdta_conv] = cdc.[frpdta_conv]
	,[frarrn] = cdc.[frarrn]
	,[frdval] = cdc.[frdval]
	,[frdval_conv] = cdc.[frdval_conv]
	,[frlr] = cdc.[frlr]
	,[frcdec] = cdc.[frcdec]
	,[frcdec_conv] = cdc.[frcdec_conv]
	,[frdrul] = cdc.[frdrul]
	,[frdro1] = cdc.[frdro1]
	,[frdro1_conv] = cdc.[frdro1_conv]
	,[frerul] = cdc.[frerul]
	,[frero1] = cdc.[frero1]
	,[frero1_conv] = cdc.[frero1_conv]
	,[frero2] = cdc.[frero2]
	,[frero2_conv] = cdc.[frero2_conv]
	,[frhlp1] = cdc.[frhlp1]
	,[frhlp1_conv] = cdc.[frhlp1_conv]
	,[frhlp2] = cdc.[frhlp2]
	,[frhlp2_conv] = cdc.[frhlp2_conv]
	,[frnnix] = cdc.[frnnix]
	,[frnsy] = cdc.[frnsy]
	,[frrls] = cdc.[frrls]
	,[fruser] = cdc.[fruser]
	,[fruser_conv] = cdc.[fruser_conv]
	,[frupmj] = cdc.[frupmj]
	,[frupmj_conv] = cdc.[frupmj_conv]
	,[frpid] = cdc.[frpid]
	,[frpid_conv] = cdc.[frpid_conv]
	,[frjobn] = cdc.[frjobn]
	,[frjobn_conv] = cdc.[frjobn_conv]
	,[frupmt] = cdc.[frupmt]
	,[frowdi] = cdc.[frowdi]
	,[frowdi_conv] = cdc.[frowdi_conv]
	,[frowtp] = cdc.[frowtp]
	,[frcntt] = cdc.[frcntt]
	,[frcntt_conv] = cdc.[frcntt_conv]
	,[frscfg] = cdc.[frscfg]
	,[frscfg_conv] = cdc.[frscfg_conv]
	,[fruper] = cdc.[fruper]
	,[fruper_conv] = cdc.[fruper_conv]
	,[fralbk] = cdc.[fralbk]
	,[fralbk_conv] = cdc.[fralbk_conv]
	,[frower] = cdc.[frower]
	,[froer1] = cdc.[froer1]
	,[froer1_conv] = cdc.[froer1_conv]
	,[froer2] = cdc.[froer2]
	,[froer2_conv] = cdc.[froer2_conv]
	,[frowdr] = cdc.[frowdr]
	,[frodr1] = cdc.[frodr1]
	,[frodr1_conv] = cdc.[frodr1_conv]
	,[frdbid] = cdc.[frdbid]
	,[frdbid_conv] = cdc.[frdbid_conv]
	,[frbfdn] = cdc.[frbfdn]
	,[frbfdn_conv] = cdc.[frbfdn_conv]
	,[frebid] = cdc.[frebid]
	,[frebid_conv] = cdc.[frebid_conv]
	,[frbfen] = cdc.[frbfen]
	,[frbfen_conv] = cdc.[frbfen_conv]
	,[frsfid] = cdc.[frsfid]
	,[frsfid_conv] = cdc.[frsfid_conv]
	,[frsfmn] = cdc.[frsfmn]
	,[frsfmn_conv] = cdc.[frsfmn_conv]
	,[frbvid] = cdc.[frbvid]
	,[frbvid_conv] = cdc.[frbvid_conv]
	,[frbvnm] = cdc.[frbvnm]
	,[frbvnm_conv] = cdc.[frbvnm_conv]
	,[frplfg] = cdc.[frplfg]
	,[frplfg_conv] = cdc.[frplfg_conv]
	,[frddid] = cdc.[frddid]
	,[frddid_conv] = cdc.[frddid_conv]
	,[frauin] = cdc.[frauin]
	,[frauin_conv] = cdc.[frauin_conv] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f9210_cdc cdc
WHERE
    rep_jde_qat.f9210_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f9210_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f9210_new AF:{{ task_instance_key_str }}' ) 
