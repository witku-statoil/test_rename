-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f0111_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[wwan8] = cdc.[wwan8]
	,[wwidln] = cdc.[wwidln]
	,[wwidln_conv] = cdc.[wwidln_conv]
	,[wwdss5] = cdc.[wwdss5]
	,[wwmlnm] = cdc.[wwmlnm]
	,[wwmlnm_conv] = cdc.[wwmlnm_conv]
	,[wwattl] = cdc.[wwattl]
	,[wwattl_conv] = cdc.[wwattl_conv]
	,[wwrem1] = cdc.[wwrem1]
	,[wwrem1_conv] = cdc.[wwrem1_conv]
	,[wwslnm] = cdc.[wwslnm]
	,[wwslnm_conv] = cdc.[wwslnm_conv]
	,[wwalph] = cdc.[wwalph]
	,[wwalph_conv] = cdc.[wwalph_conv]
	,[wwdc] = cdc.[wwdc]
	,[wwdc_conv] = cdc.[wwdc_conv]
	,[wwgnnm] = cdc.[wwgnnm]
	,[wwgnnm_conv] = cdc.[wwgnnm_conv]
	,[wwmdnm] = cdc.[wwmdnm]
	,[wwmdnm_conv] = cdc.[wwmdnm_conv]
	,[wwsrnm] = cdc.[wwsrnm]
	,[wwsrnm_conv] = cdc.[wwsrnm_conv]
	,[wwtyc] = cdc.[wwtyc]
	,[www001] = cdc.[www001]
	,[www002] = cdc.[www002]
	,[www003] = cdc.[www003]
	,[www004] = cdc.[www004]
	,[www005] = cdc.[www005]
	,[www006] = cdc.[www006]
	,[www007] = cdc.[www007]
	,[www008] = cdc.[www008]
	,[www009] = cdc.[www009]
	,[www010] = cdc.[www010]
	,[wwmln1] = cdc.[wwmln1]
	,[wwmln1_conv] = cdc.[wwmln1_conv]
	,[wwalp1] = cdc.[wwalp1]
	,[wwalp1_conv] = cdc.[wwalp1_conv]
	,[wwuser] = cdc.[wwuser]
	,[wwuser_conv] = cdc.[wwuser_conv]
	,[wwpid] = cdc.[wwpid]
	,[wwpid_conv] = cdc.[wwpid_conv]
	,[wwupmj] = cdc.[wwupmj]
	,[wwupmj_conv] = cdc.[wwupmj_conv]
	,[wwjobn] = cdc.[wwjobn]
	,[wwjobn_conv] = cdc.[wwjobn_conv]
	,[wwupmt] = cdc.[wwupmt]
	,[wwntyp] = cdc.[wwntyp]
	,[wwnick] = cdc.[wwnick]
	,[wwnick_conv] = cdc.[wwnick_conv]
	,[wwgend] = cdc.[wwgend]
	,[wwddate] = cdc.[wwddate]
	,[wwdmon] = cdc.[wwdmon]
	,[wwdyr] = cdc.[wwdyr]
	,[wwdyr_conv] = cdc.[wwdyr_conv]
	,[wwwn001] = cdc.[wwwn001]
	,[wwwn002] = cdc.[wwwn002]
	,[wwwn003] = cdc.[wwwn003]
	,[wwwn004] = cdc.[wwwn004]
	,[wwwn005] = cdc.[wwwn005]
	,[wwwn006] = cdc.[wwwn006]
	,[wwwn007] = cdc.[wwwn007]
	,[wwwn008] = cdc.[wwwn008]
	,[wwwn009] = cdc.[wwwn009]
	,[wwwn010] = cdc.[wwwn010]
	,[wwfuco] = cdc.[wwfuco]
	,[wwpcm] = cdc.[wwpcm]
	,[wwpcf] = cdc.[wwpcf]
	,[wwpcf_conv] = cdc.[wwpcf_conv]
	,[wwactin] = cdc.[wwactin]
	,[wwactin_conv] = cdc.[wwactin_conv]
	,[wwcfrguid] = cdc.[wwcfrguid]
	,[wwcfrguid_conv] = cdc.[wwcfrguid_conv]
	,[wwsyncs] = cdc.[wwsyncs]
	,[wwcaad] = cdc.[wwcaad] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f0111_cdc cdc
WHERE
    rep_jde_qat.f0111_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f0111_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f0111_new AF:{{ task_instance_key_str }}' ) 
