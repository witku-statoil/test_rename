-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f1201_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[faco] = cdc.[faco]
	,[faco_conv] = cdc.[faco_conv]
	,[fanumb] = cdc.[fanumb]
	,[faapid] = cdc.[faapid]
	,[faapid_conv] = cdc.[faapid_conv]
	,[faaaid] = cdc.[faaaid]
	,[faasid] = cdc.[faasid]
	,[faasid_conv] = cdc.[faasid_conv]
	,[faseq] = cdc.[faseq]
	,[faacl1] = cdc.[faacl1]
	,[faacl2] = cdc.[faacl2]
	,[faacl3] = cdc.[faacl3]
	,[faacl4] = cdc.[faacl4]
	,[faacl5] = cdc.[faacl5]
	,[famcu] = cdc.[famcu]
	,[famcu_conv] = cdc.[famcu_conv]
	,[fadl01] = cdc.[fadl01]
	,[fadl01_conv] = cdc.[fadl01_conv]
	,[fadl02] = cdc.[fadl02]
	,[fadl02_conv] = cdc.[fadl02_conv]
	,[fadl03] = cdc.[fadl03]
	,[fadl03_conv] = cdc.[fadl03_conv]
	,[fadscc] = cdc.[fadscc]
	,[fadscc_conv] = cdc.[fadscc_conv]
	,[fadaj] = cdc.[fadaj]
	,[fadaj_conv] = cdc.[fadaj_conv]
	,[fadsp] = cdc.[fadsp]
	,[fadsp_conv] = cdc.[fadsp_conv]
	,[faeqst] = cdc.[faeqst]
	,[fanoru] = cdc.[fanoru]
	,[faaesv] = cdc.[faaesv]
	,[faaesv_conv] = cdc.[faaesv_conv]
	,[faarpc] = cdc.[faarpc]
	,[faarpc_conv] = cdc.[faarpc_conv]
	,[faalrc] = cdc.[faalrc]
	,[faalrc_conv] = cdc.[faalrc_conv]
	,[faamcu] = cdc.[faamcu]
	,[faamcu_conv] = cdc.[faamcu_conv]
	,[faaobj] = cdc.[faaobj]
	,[faaobj_conv] = cdc.[faaobj_conv]
	,[faasub] = cdc.[faasub]
	,[faasub_conv] = cdc.[faasub_conv]
	,[fadmcu] = cdc.[fadmcu]
	,[fadmcu_conv] = cdc.[fadmcu_conv]
	,[fadobj] = cdc.[fadobj]
	,[fadobj_conv] = cdc.[fadobj_conv]
	,[fadsub] = cdc.[fadsub]
	,[fadsub_conv] = cdc.[fadsub_conv]
	,[faxmcu] = cdc.[faxmcu]
	,[faxmcu_conv] = cdc.[faxmcu_conv]
	,[faxobj] = cdc.[faxobj]
	,[faxobj_conv] = cdc.[faxobj_conv]
	,[faxsub] = cdc.[faxsub]
	,[faxsub_conv] = cdc.[faxsub_conv]
	,[farmcu] = cdc.[farmcu]
	,[farmcu_conv] = cdc.[farmcu_conv]
	,[farobj] = cdc.[farobj]
	,[farobj_conv] = cdc.[farobj_conv]
	,[farsub] = cdc.[farsub]
	,[farsub_conv] = cdc.[farsub_conv]
	,[faarcq] = cdc.[faarcq]
	,[faarcq_conv] = cdc.[faarcq_conv]
	,[faaroq] = cdc.[faaroq]
	,[faaroq_conv] = cdc.[faaroq_conv]
	,[fatxjs] = cdc.[fatxjs]
	,[faaity] = cdc.[faaity]
	,[faaity_conv] = cdc.[faaity_conv]
	,[faaitp] = cdc.[faaitp]
	,[faaitp_conv] = cdc.[faaitp_conv]
	,[fafinc] = cdc.[fafinc]
	,[faitco] = cdc.[faitco]
	,[fapuro] = cdc.[fapuro]
	,[faapur] = cdc.[faapur]
	,[faapur_conv] = cdc.[faapur_conv]
	,[fapurp] = cdc.[fapurp]
	,[fapurp_conv] = cdc.[fapurp_conv]
	,[faapom] = cdc.[faapom]
	,[faapom_conv] = cdc.[faapom_conv]
	,[falano] = cdc.[falano]
	,[fajcd] = cdc.[fajcd]
	,[fajcd_conv] = cdc.[fajcd_conv]
	,[fadexj] = cdc.[fadexj]
	,[fadexj_conv] = cdc.[fadexj_conv]
	,[faamf] = cdc.[faamf]
	,[faamf_conv] = cdc.[faamf_conv]
	,[farmk] = cdc.[farmk]
	,[farmk_conv] = cdc.[farmk_conv]
	,[farmk2] = cdc.[farmk2]
	,[farmk2_conv] = cdc.[farmk2_conv]
	,[fainsp] = cdc.[fainsp]
	,[fainsp_conv] = cdc.[fainsp_conv]
	,[fainsc] = cdc.[fainsc]
	,[fainsc_conv] = cdc.[fainsc_conv]
	,[fainsm] = cdc.[fainsm]
	,[fainsa] = cdc.[fainsa]
	,[fainsa_conv] = cdc.[fainsa_conv]
	,[faaiv] = cdc.[faaiv]
	,[faaiv_conv] = cdc.[faaiv_conv]
	,[fainsi] = cdc.[fainsi]
	,[fauser] = cdc.[fauser]
	,[fauser_conv] = cdc.[fauser_conv]
	,[falct] = cdc.[falct]
	,[falct_conv] = cdc.[falct_conv]
	,[faloc] = cdc.[faloc]
	,[faloc_conv] = cdc.[faloc_conv]
	,[faadds] = cdc.[faadds]
	,[fapid] = cdc.[fapid]
	,[fapid_conv] = cdc.[fapid_conv]
	,[faeftb] = cdc.[faeftb]
	,[faeftb_conv] = cdc.[faeftb_conv]
	,[fader] = cdc.[fader]
	,[fader_conv] = cdc.[fader_conv]
	,[famsga] = cdc.[famsga]
	,[faex] = cdc.[faex]
	,[faex_conv] = cdc.[faex_conv]
	,[faexr] = cdc.[faexr]
	,[faexr_conv] = cdc.[faexr_conv]
	,[faan8] = cdc.[faan8]
	,[faacl6] = cdc.[faacl6]
	,[faacl7] = cdc.[faacl7]
	,[faacl8] = cdc.[faacl8]
	,[faacl9] = cdc.[faacl9]
	,[faacl0] = cdc.[faacl0]
	,[fasfc] = cdc.[fasfc]
	,[fasfc_conv] = cdc.[fasfc_conv]
	,[fadadc] = cdc.[fadadc]
	,[fadadc_conv] = cdc.[fadadc_conv]
	,[fadado] = cdc.[fadado]
	,[fadado_conv] = cdc.[fadado_conv]
	,[fadads] = cdc.[fadads]
	,[fadads_conv] = cdc.[fadads_conv]
	,[faunit] = cdc.[faunit]
	,[faunit_conv] = cdc.[faunit_conv]
	,[fakit] = cdc.[fakit]
	,[fakitl] = cdc.[fakitl]
	,[fakitl_conv] = cdc.[fakitl_conv]
	,[faafe] = cdc.[faafe]
	,[faafe_conv] = cdc.[faafe_conv]
	,[fajbcd] = cdc.[fajbcd]
	,[fajbst] = cdc.[fajbst]
	,[faun] = cdc.[faun]
	,[fasbli] = cdc.[fasbli]
	,[faupmj] = cdc.[faupmj]
	,[faupmj_conv] = cdc.[faupmj_conv]
	,[fajobn] = cdc.[fajobn]
	,[fajobn_conv] = cdc.[fajobn_conv]
	,[faupmt] = cdc.[faupmt]
	,[fafa0] = cdc.[fafa0]
	,[fafa1] = cdc.[fafa1]
	,[fafa2] = cdc.[fafa2]
	,[fafa3] = cdc.[fafa3]
	,[fafa4] = cdc.[fafa4]
	,[fafa5] = cdc.[fafa5]
	,[fafa6] = cdc.[fafa6]
	,[fafa7] = cdc.[fafa7]
	,[fafa8] = cdc.[fafa8]
	,[fafa9] = cdc.[fafa9]
	,[fafa21] = cdc.[fafa21]
	,[fafa22] = cdc.[fafa22]
	,[fafa23] = cdc.[fafa23]
	,[fawoyn] = cdc.[fawoyn]
	,[fawoyn_conv] = cdc.[fawoyn_conv]
	,[facrtl] = cdc.[facrtl]
	,[facrtl_conv] = cdc.[facrtl_conv]
	,[fawrfl] = cdc.[fawrfl]
	,[fawarj] = cdc.[fawarj]
	,[fawarj_conv] = cdc.[fawarj_conv] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f1201_cdc cdc
WHERE
    rep_jde_qat.f1201_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f1201_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f1201_new AF:{{ task_instance_key_str }}' ) 
