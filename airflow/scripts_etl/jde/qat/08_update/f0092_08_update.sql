-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f0092_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[uluser] = cdc.[uluser]
	,[uluser_conv] = cdc.[uluser_conv]
	,[ulmni] = cdc.[ulmni]
	,[ulmni_conv] = cdc.[ulmni_conv]
	,[uloutq] = cdc.[uloutq]
	,[uloutq_conv] = cdc.[uloutq_conv]
	,[uljobq] = cdc.[uljobq]
	,[uljobq_conv] = cdc.[uljobq_conv]
	,[uljsp] = cdc.[uljsp]
	,[uljsp_conv] = cdc.[uljsp_conv]
	,[uloutp] = cdc.[uloutp]
	,[uloutp_conv] = cdc.[uloutp_conv]
	,[ulllvl] = cdc.[ulllvl]
	,[ullsev] = cdc.[ullsev]
	,[ullsev_conv] = cdc.[ullsev_conv]
	,[ullmsg] = cdc.[ullmsg]
	,[ulprtl] = cdc.[ulprtl]
	,[ulprtl_conv] = cdc.[ulprtl_conv]
	,[ulul01] = cdc.[ulul01]
	,[ulul02] = cdc.[ulul02]
	,[ulul03] = cdc.[ulul03]
	,[ulul03_conv] = cdc.[ulul03_conv]
	,[ulul04] = cdc.[ulul04]
	,[ulul04_conv] = cdc.[ulul04_conv]
	,[ulul05] = cdc.[ulul05]
	,[ulul05_conv] = cdc.[ulul05_conv]
	,[ulul06] = cdc.[ulul06]
	,[ulul06_conv] = cdc.[ulul06_conv]
	,[ulul07] = cdc.[ulul07]
	,[ulul07_conv] = cdc.[ulul07_conv]
	,[ulul08] = cdc.[ulul08]
	,[ulul08_conv] = cdc.[ulul08_conv]
	,[ulul09] = cdc.[ulul09]
	,[ulul09_conv] = cdc.[ulul09_conv]
	,[ulul10] = cdc.[ulul10]
	,[ulul10_conv] = cdc.[ulul10_conv]
	,[ulul11] = cdc.[ulul11]
	,[ulul11_conv] = cdc.[ulul11_conv]
	,[ulul12] = cdc.[ulul12]
	,[ulul12_conv] = cdc.[ulul12_conv]
	,[ulul13] = cdc.[ulul13]
	,[ulul13_conv] = cdc.[ulul13_conv]
	,[ulul14] = cdc.[ulul14]
	,[ulul14_conv] = cdc.[ulul14_conv]
	,[ulul15] = cdc.[ulul15]
	,[ulul15_conv] = cdc.[ulul15_conv]
	,[ulul16] = cdc.[ulul16]
	,[ulul16_conv] = cdc.[ulul16_conv]
	,[ulul17] = cdc.[ulul17]
	,[ulul17_conv] = cdc.[ulul17_conv]
	,[ulul18] = cdc.[ulul18]
	,[ulul18_conv] = cdc.[ulul18_conv]
	,[ulul19] = cdc.[ulul19]
	,[ulul19_conv] = cdc.[ulul19_conv]
	,[ulul20] = cdc.[ulul20]
	,[ulul20_conv] = cdc.[ulul20_conv]
	,[ulul21] = cdc.[ulul21]
	,[ulul21_conv] = cdc.[ulul21_conv]
	,[ulul22] = cdc.[ulul22]
	,[ulul22_conv] = cdc.[ulul22_conv]
	,[ulul23] = cdc.[ulul23]
	,[ulul23_conv] = cdc.[ulul23_conv]
	,[ulul24] = cdc.[ulul24]
	,[ulul24_conv] = cdc.[ulul24_conv]
	,[ulul25] = cdc.[ulul25]
	,[ulul25_conv] = cdc.[ulul25_conv]
	,[ulmska] = cdc.[ulmska]
	,[ulmska_conv] = cdc.[ulmska_conv]
	,[ulmskj] = cdc.[ulmskj]
	,[ulmskj_conv] = cdc.[ulmskj_conv]
	,[ulmskk] = cdc.[ulmskk]
	,[ulmskk_conv] = cdc.[ulmskk_conv]
	,[ulmskd] = cdc.[ulmskd]
	,[ulmskd_conv] = cdc.[ulmskd_conv]
	,[ulmskf] = cdc.[ulmskf]
	,[ulan8] = cdc.[ulan8]
	,[ulutyp] = cdc.[ulutyp]
	,[ulutyp_conv] = cdc.[ulutyp_conv]
	,[ulpid] = cdc.[ulpid]
	,[ulpid_conv] = cdc.[ulpid_conv]
	,[ulmtvl] = cdc.[ulmtvl]
	,[ulmtvl_conv] = cdc.[ulmtvl_conv]
	,[ulcmde] = cdc.[ulcmde]
	,[ulcmde_conv] = cdc.[ulcmde_conv]
	,[ulclib] = cdc.[ulclib]
	,[ulclib_conv] = cdc.[ulclib_conv]
	,[ulugrp] = cdc.[ulugrp]
	,[ulugrp_conv] = cdc.[ulugrp_conv]
	,[ulipgm] = cdc.[ulipgm]
	,[ulipgm_conv] = cdc.[ulipgm_conv]
	,[ullod] = cdc.[ullod]
	,[ulfstp] = cdc.[ulfstp]
	,[ulfstp_conv] = cdc.[ulfstp_conv] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f0092_cdc cdc
WHERE
    rep_jde_qat.f0092_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f0092_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f0092_new AF:{{ task_instance_key_str }}' ) 
