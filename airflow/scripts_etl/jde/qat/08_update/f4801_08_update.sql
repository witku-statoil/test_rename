-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f4801_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[wadcto] = cdc.[wadcto]
	,[wadoco] = cdc.[wadoco]
	,[wasfxo] = cdc.[wasfxo]
	,[wasfxo_conv] = cdc.[wasfxo_conv]
	,[warcto] = cdc.[warcto]
	,[warorn] = cdc.[warorn]
	,[warorn_conv] = cdc.[warorn_conv]
	,[walnid] = cdc.[walnid]
	,[walnid_conv] = cdc.[walnid_conv]
	,[waptwo] = cdc.[waptwo]
	,[wapars] = cdc.[wapars]
	,[wapars_conv] = cdc.[wapars_conv]
	,[watyps] = cdc.[watyps]
	,[waprts] = cdc.[waprts]
	,[wadl01] = cdc.[wadl01]
	,[wadl01_conv] = cdc.[wadl01_conv]
	,[wastcm] = cdc.[wastcm]
	,[wastcm_conv] = cdc.[wastcm_conv]
	,[waco] = cdc.[waco]
	,[waco_conv] = cdc.[waco_conv]
	,[wamcu] = cdc.[wamcu]
	,[wamcu_conv] = cdc.[wamcu_conv]
	,[wammcu] = cdc.[wammcu]
	,[wammcu_conv] = cdc.[wammcu_conv]
	,[walocn] = cdc.[walocn]
	,[walocn_conv] = cdc.[walocn_conv]
	,[waaisl] = cdc.[waaisl]
	,[waaisl_conv] = cdc.[waaisl_conv]
	,[wabin] = cdc.[wabin]
	,[wabin_conv] = cdc.[wabin_conv]
	,[wasrst] = cdc.[wasrst]
	,[wadcg] = cdc.[wadcg]
	,[wadcg_conv] = cdc.[wadcg_conv]
	,[wasub] = cdc.[wasub]
	,[wasub_conv] = cdc.[wasub_conv]
	,[waan8] = cdc.[waan8]
	,[waano] = cdc.[waano]
	,[waansa] = cdc.[waansa]
	,[waanpa] = cdc.[waanpa]
	,[waanp] = cdc.[waanp]
	,[wadpl] = cdc.[wadpl]
	,[wadpl_conv] = cdc.[wadpl_conv]
	,[waant] = cdc.[waant]
	,[wanan8] = cdc.[wanan8]
	,[watrdj] = cdc.[watrdj]
	,[watrdj_conv] = cdc.[watrdj_conv]
	,[wastrt] = cdc.[wastrt]
	,[wastrt_conv] = cdc.[wastrt_conv]
	,[wadrqj] = cdc.[wadrqj]
	,[wadrqj_conv] = cdc.[wadrqj_conv]
	,[wastrx] = cdc.[wastrx]
	,[wastrx_conv] = cdc.[wastrx_conv]
	,[wadap] = cdc.[wadap]
	,[wadap_conv] = cdc.[wadap_conv]
	,[wadat] = cdc.[wadat]
	,[wadat_conv] = cdc.[wadat_conv]
	,[wappdt] = cdc.[wappdt]
	,[wappdt_conv] = cdc.[wappdt_conv]
	,[wawr01] = cdc.[wawr01]
	,[wawr02] = cdc.[wawr02]
	,[wawr03] = cdc.[wawr03]
	,[wawr04] = cdc.[wawr04]
	,[wawr05] = cdc.[wawr05]
	,[wawr06] = cdc.[wawr06]
	,[wawr07] = cdc.[wawr07]
	,[wawr08] = cdc.[wawr08]
	,[wawr09] = cdc.[wawr09]
	,[wawr10] = cdc.[wawr10]
	,[wavr01] = cdc.[wavr01]
	,[wavr01_conv] = cdc.[wavr01_conv]
	,[wavr02] = cdc.[wavr02]
	,[wavr02_conv] = cdc.[wavr02_conv]
	,[waamto] = cdc.[waamto]
	,[waamto_conv] = cdc.[waamto_conv]
	,[wasetc] = cdc.[wasetc]
	,[wabrt] = cdc.[wabrt]
	,[wabrt_conv] = cdc.[wabrt_conv]
	,[wapayt] = cdc.[wapayt]
	,[wapayt_conv] = cdc.[wapayt_conv]
	,[waamtc] = cdc.[waamtc]
	,[waamtc_conv] = cdc.[waamtc_conv]
	,[wahrso] = cdc.[wahrso]
	,[wahrso_conv] = cdc.[wahrso_conv]
	,[wahrsc] = cdc.[wahrsc]
	,[wahrsc_conv] = cdc.[wahrsc_conv]
	,[waamta] = cdc.[waamta]
	,[waamta_conv] = cdc.[waamta_conv]
	,[wahrsa] = cdc.[wahrsa]
	,[wahrsa_conv] = cdc.[wahrsa_conv]
	,[waitm] = cdc.[waitm]
	,[waaitm] = cdc.[waaitm]
	,[waaitm_conv] = cdc.[waaitm_conv]
	,[walitm] = cdc.[walitm]
	,[walitm_conv] = cdc.[walitm_conv]
	,[wanumb] = cdc.[wanumb]
	,[waapid] = cdc.[waapid]
	,[waapid_conv] = cdc.[waapid_conv]
	,[wauorg] = cdc.[wauorg]
	,[wauorg_conv] = cdc.[wauorg_conv]
	,[wasobk] = cdc.[wasobk]
	,[wasobk_conv] = cdc.[wasobk_conv]
	,[wasocn] = cdc.[wasocn]
	,[wasocn_conv] = cdc.[wasocn_conv]
	,[wasoqs] = cdc.[wasoqs]
	,[wasoqs_conv] = cdc.[wasoqs_conv]
	,[waqtyt] = cdc.[waqtyt]
	,[waqtyt_conv] = cdc.[waqtyt_conv]
	,[wauom] = cdc.[wauom]
	,[washno] = cdc.[washno]
	,[washno_conv] = cdc.[washno_conv]
	,[wapbtm] = cdc.[wapbtm]
	,[watbm] = cdc.[watbm]
	,[watrt] = cdc.[watrt]
	,[washty] = cdc.[washty]
	,[wapec] = cdc.[wapec]
	,[wappfg] = cdc.[wappfg]
	,[wabm] = cdc.[wabm]
	,[wabm_conv] = cdc.[wabm_conv]
	,[wartg] = cdc.[wartg]
	,[wartg_conv] = cdc.[wartg_conv]
	,[wasprt] = cdc.[wasprt]
	,[wauncd] = cdc.[wauncd]
	,[waindc] = cdc.[waindc]
	,[waindc_conv] = cdc.[waindc_conv]
	,[waresc] = cdc.[waresc]
	,[waresc_conv] = cdc.[waresc_conv]
	,[wamoh] = cdc.[wamoh]
	,[wamoh_conv] = cdc.[wamoh_conv]
	,[watdt] = cdc.[watdt]
	,[watdt_conv] = cdc.[watdt_conv]
	,[wapou] = cdc.[wapou]
	,[wapou_conv] = cdc.[wapou_conv]
	,[wapc] = cdc.[wapc]
	,[waltlv] = cdc.[waltlv]
	,[waltlv_conv] = cdc.[waltlv_conv]
	,[waltcm] = cdc.[waltcm]
	,[waltcm_conv] = cdc.[waltcm_conv]
	,[wacts1] = cdc.[wacts1]
	,[wacts1_conv] = cdc.[wacts1_conv]
	,[walotn] = cdc.[walotn]
	,[walotn_conv] = cdc.[walotn_conv]
	,[walotp] = cdc.[walotp]
	,[walotp_conv] = cdc.[walotp_conv]
	,[walotg] = cdc.[walotg]
	,[warat1] = cdc.[warat1]
	,[warat1_conv] = cdc.[warat1_conv]
	,[warat2] = cdc.[warat2]
	,[warat2_conv] = cdc.[warat2_conv]
	,[wadct] = cdc.[wadct]
	,[wasbli] = cdc.[wasbli]
	,[warkco] = cdc.[warkco]
	,[warkco_conv] = cdc.[warkco_conv]
	,[wabrev] = cdc.[wabrev]
	,[wabrev_conv] = cdc.[wabrev_conv]
	,[warrev] = cdc.[warrev]
	,[warrev_conv] = cdc.[warrev_conv]
	,[wadrwc] = cdc.[wadrwc]
	,[wadrwc_conv] = cdc.[wadrwc_conv]
	,[wartch] = cdc.[wartch]
	,[wartch_conv] = cdc.[wartch_conv]
	,[wapnrq] = cdc.[wapnrq]
	,[wapnrq_conv] = cdc.[wapnrq_conv]
	,[wareas] = cdc.[wareas]
	,[waphse] = cdc.[waphse]
	,[waxdsp] = cdc.[waxdsp]
	,[wabomc] = cdc.[wabomc]
	,[wabomc_conv] = cdc.[wabomc_conv]
	,[waurcd] = cdc.[waurcd]
	,[waurcd_conv] = cdc.[waurcd_conv]
	,[waurdt] = cdc.[waurdt]
	,[waurdt_conv] = cdc.[waurdt_conv]
	,[waurat] = cdc.[waurat]
	,[waurat_conv] = cdc.[waurat_conv]
	,[waurab] = cdc.[waurab]
	,[waurab_conv] = cdc.[waurab_conv]
	,[waurrf] = cdc.[waurrf]
	,[waurrf_conv] = cdc.[waurrf_conv]
	,[wauser] = cdc.[wauser]
	,[wauser_conv] = cdc.[wauser_conv]
	,[wapid] = cdc.[wapid]
	,[wapid_conv] = cdc.[wapid_conv]
	,[wajobn] = cdc.[wajobn]
	,[wajobn_conv] = cdc.[wajobn_conv]
	,[waupmj] = cdc.[waupmj]
	,[waupmj_conv] = cdc.[waupmj_conv]
	,[watday] = cdc.[watday]
	,[waaaid] = cdc.[waaaid]
	,[wantst] = cdc.[wantst]
	,[waxrto] = cdc.[waxrto]
	,[waxrto_conv] = cdc.[waxrto_conv]
	,[waesdn] = cdc.[waesdn]
	,[waesdn_conv] = cdc.[waesdn_conv]
	,[waacdn] = cdc.[waacdn]
	,[waacdn_conv] = cdc.[waacdn_conv]
	,[wasaid] = cdc.[wasaid]
	,[wampos] = cdc.[wampos]
	,[wampos_conv] = cdc.[wampos_conv]
	,[waaprt] = cdc.[waaprt]
	,[waamlc] = cdc.[waamlc]
	,[waamlc_conv] = cdc.[waamlc_conv]
	,[waammc] = cdc.[waammc]
	,[waammc_conv] = cdc.[waammc_conv]
	,[waamot] = cdc.[waamot]
	,[waamot_conv] = cdc.[waamot_conv]
	,[walbam] = cdc.[walbam]
	,[walbam_conv] = cdc.[walbam_conv]
	,[wamtam] = cdc.[wamtam]
	,[wamtam_conv] = cdc.[wamtam_conv] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f4801_cdc cdc
WHERE
    rep_jde_qat.f4801_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f4801_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f4801_new AF:{{ task_instance_key_str }}' ) 
