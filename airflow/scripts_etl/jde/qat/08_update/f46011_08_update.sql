-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f46011_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[iqmcu] = cdc.[iqmcu]
	,[iqmcu_conv] = cdc.[iqmcu_conv]
	,[iqprp6] = cdc.[iqprp6]
	,[iqitm] = cdc.[iqitm]
	,[iquom] = cdc.[iquom]
	,[iqgwid] = cdc.[iqgwid]
	,[iqgwid_conv] = cdc.[iqgwid_conv]
	,[iqgdep] = cdc.[iqgdep]
	,[iqgdep_conv] = cdc.[iqgdep_conv]
	,[iqghet] = cdc.[iqghet]
	,[iqghet_conv] = cdc.[iqghet_conv]
	,[iqwium] = cdc.[iqwium]
	,[iqgcub] = cdc.[iqgcub]
	,[iqgcub_conv] = cdc.[iqgcub_conv]
	,[iqvumd] = cdc.[iqvumd]
	,[iqgwei] = cdc.[iqgwei]
	,[iqgwei_conv] = cdc.[iqgwei_conv]
	,[iquwum] = cdc.[iquwum]
	,[iqdmth] = cdc.[iqdmth]
	,[iqcrmt] = cdc.[iqcrmt]
	,[iqequs] = cdc.[iqequs]
	,[iqarot] = cdc.[iqarot]
	,[iqarot_conv] = cdc.[iqarot_conv]
	,[iqabkd] = cdc.[iqabkd]
	,[iqabkd_conv] = cdc.[iqabkd_conv]
	,[iqarol] = cdc.[iqarol]
	,[iqarol_conv] = cdc.[iqarol_conv]
	,[iqslim] = cdc.[iqslim]
	,[iqslim_conv] = cdc.[iqslim_conv]
	,[iqeqty] = cdc.[iqeqty]
	,[iqrpck] = cdc.[iqrpck]
	,[iqrpck_conv] = cdc.[iqrpck_conv]
	,[iqpack] = cdc.[iqpack]
	,[iqlipl] = cdc.[iqlipl]
	,[iqlipl_conv] = cdc.[iqlipl_conv]
	,[iqpptg] = cdc.[iqpptg]
	,[iqpktg] = cdc.[iqpktg]
	,[iqprtg] = cdc.[iqprtg]
	,[iqptra] = cdc.[iqptra]
	,[iqptra_conv] = cdc.[iqptra_conv]
	,[iqktra] = cdc.[iqktra]
	,[iqktra_conv] = cdc.[iqktra_conv]
	,[iqrtra] = cdc.[iqrtra]
	,[iqrtra_conv] = cdc.[iqrtra_conv]
	,[iquser] = cdc.[iquser]
	,[iquser_conv] = cdc.[iquser_conv]
	,[iqpid] = cdc.[iqpid]
	,[iqpid_conv] = cdc.[iqpid_conv]
	,[iqjobn] = cdc.[iqjobn]
	,[iqjobn_conv] = cdc.[iqjobn_conv]
	,[iqupmj] = cdc.[iqupmj]
	,[iqupmj_conv] = cdc.[iqupmj_conv]
	,[iqtday] = cdc.[iqtday]
	,[iquccu] = cdc.[iquccu]
	,[iquccu_conv] = cdc.[iquccu_conv] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f46011_cdc cdc
WHERE
    rep_jde_qat.f46011_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f46011_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f46011_new AF:{{ task_instance_key_str }}' ) 
