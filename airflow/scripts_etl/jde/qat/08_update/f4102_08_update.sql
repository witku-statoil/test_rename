-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f4102_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[ibitm] = cdc.[ibitm]
	,[iblitm] = cdc.[iblitm]
	,[iblitm_conv] = cdc.[iblitm_conv]
	,[ibaitm] = cdc.[ibaitm]
	,[ibaitm_conv] = cdc.[ibaitm_conv]
	,[ibmcu] = cdc.[ibmcu]
	,[ibmcu_conv] = cdc.[ibmcu_conv]
	,[ibsrp1] = cdc.[ibsrp1]
	,[ibsrp2] = cdc.[ibsrp2]
	,[ibsrp3] = cdc.[ibsrp3]
	,[ibsrp4] = cdc.[ibsrp4]
	,[ibsrp5] = cdc.[ibsrp5]
	,[ibsrp6] = cdc.[ibsrp6]
	,[ibsrp7] = cdc.[ibsrp7]
	,[ibsrp8] = cdc.[ibsrp8]
	,[ibsrp9] = cdc.[ibsrp9]
	,[ibsrp0] = cdc.[ibsrp0]
	,[ibprp1] = cdc.[ibprp1]
	,[ibprp2] = cdc.[ibprp2]
	,[ibprp3] = cdc.[ibprp3]
	,[ibprp4] = cdc.[ibprp4]
	,[ibprp5] = cdc.[ibprp5]
	,[ibprp6] = cdc.[ibprp6]
	,[ibprp7] = cdc.[ibprp7]
	,[ibprp8] = cdc.[ibprp8]
	,[ibprp9] = cdc.[ibprp9]
	,[ibprp0] = cdc.[ibprp0]
	,[ibcdcd] = cdc.[ibcdcd]
	,[ibcdcd_conv] = cdc.[ibcdcd_conv]
	,[ibpdgr] = cdc.[ibpdgr]
	,[ibdsgp] = cdc.[ibdsgp]
	,[ibvend] = cdc.[ibvend]
	,[ibvend_conv] = cdc.[ibvend_conv]
	,[ibanpl] = cdc.[ibanpl]
	,[ibbuyr] = cdc.[ibbuyr]
	,[ibbuyr_conv] = cdc.[ibbuyr_conv]
	,[ibglpt] = cdc.[ibglpt]
	,[iborig] = cdc.[iborig]
	,[ibropi] = cdc.[ibropi]
	,[ibropi_conv] = cdc.[ibropi_conv]
	,[ibroqi] = cdc.[ibroqi]
	,[ibroqi_conv] = cdc.[ibroqi_conv]
	,[ibrqmx] = cdc.[ibrqmx]
	,[ibrqmx_conv] = cdc.[ibrqmx_conv]
	,[ibrqmn] = cdc.[ibrqmn]
	,[ibrqmn_conv] = cdc.[ibrqmn_conv]
	,[ibwomo] = cdc.[ibwomo]
	,[ibwomo_conv] = cdc.[ibwomo_conv]
	,[ibserv] = cdc.[ibserv]
	,[ibsafe] = cdc.[ibsafe]
	,[ibsafe_conv] = cdc.[ibsafe_conv]
	,[ibsld] = cdc.[ibsld]
	,[ibsld_conv] = cdc.[ibsld_conv]
	,[ibckav] = cdc.[ibckav]
	,[ibckav_conv] = cdc.[ibckav_conv]
	,[ibsrce] = cdc.[ibsrce]
	,[iblots] = cdc.[iblots]
	,[ibot1y] = cdc.[ibot1y]
	,[ibot1y_conv] = cdc.[ibot1y_conv]
	,[ibot2y] = cdc.[ibot2y]
	,[ibot2y_conv] = cdc.[ibot2y_conv]
	,[ibstdp] = cdc.[ibstdp]
	,[ibstdp_conv] = cdc.[ibstdp_conv]
	,[ibfrmp] = cdc.[ibfrmp]
	,[ibfrmp_conv] = cdc.[ibfrmp_conv]
	,[ibthrp] = cdc.[ibthrp]
	,[ibthrp_conv] = cdc.[ibthrp_conv]
	,[ibstdg] = cdc.[ibstdg]
	,[ibfrgd] = cdc.[ibfrgd]
	,[ibthgd] = cdc.[ibthgd]
	,[ibcoty] = cdc.[ibcoty]
	,[ibmmpc] = cdc.[ibmmpc]
	,[ibmmpc_conv] = cdc.[ibmmpc_conv]
	,[ibprgr] = cdc.[ibprgr]
	,[ibrprc] = cdc.[ibrprc]
	,[iborpr] = cdc.[iborpr]
	,[ibback] = cdc.[ibback]
	,[ibback_conv] = cdc.[ibback_conv]
	,[ibifla] = cdc.[ibifla]
	,[ibabcs] = cdc.[ibabcs]
	,[ibabcm] = cdc.[ibabcm]
	,[ibabci] = cdc.[ibabci]
	,[ibovr] = cdc.[ibovr]
	,[ibovr_conv] = cdc.[ibovr_conv]
	,[ibshcm] = cdc.[ibshcm]
	,[ibcars] = cdc.[ibcars]
	,[ibcars_conv] = cdc.[ibcars_conv]
	,[ibcarp] = cdc.[ibcarp]
	,[ibcarp_conv] = cdc.[ibcarp_conv]
	,[ibshcn] = cdc.[ibshcn]
	,[ibstkt] = cdc.[ibstkt]
	,[iblnty] = cdc.[iblnty]
	,[iblnty_conv] = cdc.[iblnty_conv]
	,[ibfifo] = cdc.[ibfifo]
	,[ibfifo_conv] = cdc.[ibfifo_conv]
	,[ibcycl] = cdc.[ibcycl]
	,[ibinmg] = cdc.[ibinmg]
	,[ibwarr] = cdc.[ibwarr]
	,[ibwarr_conv] = cdc.[ibwarr_conv]
	,[ibsrnr] = cdc.[ibsrnr]
	,[ibpctm] = cdc.[ibpctm]
	,[ibpctm_conv] = cdc.[ibpctm_conv]
	,[ibcmcg] = cdc.[ibcmcg]
	,[ibcmcg_conv] = cdc.[ibcmcg_conv]
	,[ibfuf1] = cdc.[ibfuf1]
	,[ibtx] = cdc.[ibtx]
	,[ibtax1] = cdc.[ibtax1]
	,[ibmpst] = cdc.[ibmpst]
	,[ibmrpd] = cdc.[ibmrpd]
	,[ibmrpc] = cdc.[ibmrpc]
	,[ibupc] = cdc.[ibupc]
	,[ibupc_conv] = cdc.[ibupc_conv]
	,[ibsns] = cdc.[ibsns]
	,[ibmerl] = cdc.[ibmerl]
	,[ibmerl_conv] = cdc.[ibmerl_conv]
	,[ibltlv] = cdc.[ibltlv]
	,[ibltlv_conv] = cdc.[ibltlv_conv]
	,[ibltmf] = cdc.[ibltmf]
	,[ibltmf_conv] = cdc.[ibltmf_conv]
	,[ibltcm] = cdc.[ibltcm]
	,[ibltcm_conv] = cdc.[ibltcm_conv]
	,[ibopc] = cdc.[ibopc]
	,[ibopv] = cdc.[ibopv]
	,[ibopv_conv] = cdc.[ibopv_conv]
	,[ibacq] = cdc.[ibacq]
	,[ibacq_conv] = cdc.[ibacq_conv]
	,[ibmlq] = cdc.[ibmlq]
	,[ibmlq_conv] = cdc.[ibmlq_conv]
	,[ibltpu] = cdc.[ibltpu]
	,[ibltpu_conv] = cdc.[ibltpu_conv]
	,[ibmpsp] = cdc.[ibmpsp]
	,[ibmrpp] = cdc.[ibmrpp]
	,[ibitc] = cdc.[ibitc]
	,[ibeco] = cdc.[ibeco]
	,[ibeco_conv] = cdc.[ibeco_conv]
	,[ibecty] = cdc.[ibecty]
	,[ibecod] = cdc.[ibecod]
	,[ibecod_conv] = cdc.[ibecod_conv]
	,[ibmtf1] = cdc.[ibmtf1]
	,[ibmtf1_conv] = cdc.[ibmtf1_conv]
	,[ibmtf2] = cdc.[ibmtf2]
	,[ibmtf2_conv] = cdc.[ibmtf2_conv]
	,[ibmtf3] = cdc.[ibmtf3]
	,[ibmtf3_conv] = cdc.[ibmtf3_conv]
	,[ibmtf4] = cdc.[ibmtf4]
	,[ibmtf4_conv] = cdc.[ibmtf4_conv]
	,[ibmtf5] = cdc.[ibmtf5]
	,[ibmtf5_conv] = cdc.[ibmtf5_conv]
	,[ibmovd] = cdc.[ibmovd]
	,[ibmovd_conv] = cdc.[ibmovd_conv]
	,[ibqued] = cdc.[ibqued]
	,[ibqued_conv] = cdc.[ibqued_conv]
	,[ibsetl] = cdc.[ibsetl]
	,[ibsetl_conv] = cdc.[ibsetl_conv]
	,[ibsrnk] = cdc.[ibsrnk]
	,[ibsrnk_conv] = cdc.[ibsrnk_conv]
	,[ibsrkf] = cdc.[ibsrkf]
	,[ibtimb] = cdc.[ibtimb]
	,[ibbqty] = cdc.[ibbqty]
	,[ibbqty_conv] = cdc.[ibbqty_conv]
	,[ibordw] = cdc.[ibordw]
	,[ibordw_conv] = cdc.[ibordw_conv]
	,[ibexpd] = cdc.[ibexpd]
	,[ibexpd_conv] = cdc.[ibexpd_conv]
	,[ibdefd] = cdc.[ibdefd]
	,[ibdefd_conv] = cdc.[ibdefd_conv]
	,[ibmult] = cdc.[ibmult]
	,[ibmult_conv] = cdc.[ibmult_conv]
	,[ibsflt] = cdc.[ibsflt]
	,[ibsflt_conv] = cdc.[ibsflt_conv]
	,[ibmake] = cdc.[ibmake]
	,[iblfdj] = cdc.[iblfdj]
	,[iblfdj_conv] = cdc.[iblfdj_conv]
	,[ibllx] = cdc.[ibllx]
	,[ibcmgl] = cdc.[ibcmgl]
	,[iburcd] = cdc.[iburcd]
	,[iburcd_conv] = cdc.[iburcd_conv]
	,[iburdt] = cdc.[iburdt]
	,[iburdt_conv] = cdc.[iburdt_conv]
	,[iburat] = cdc.[iburat]
	,[iburat_conv] = cdc.[iburat_conv]
	,[iburab] = cdc.[iburab]
	,[iburab_conv] = cdc.[iburab_conv]
	,[iburrf] = cdc.[iburrf]
	,[iburrf_conv] = cdc.[iburrf_conv]
	,[ibuser] = cdc.[ibuser]
	,[ibuser_conv] = cdc.[ibuser_conv]
	,[ibpid] = cdc.[ibpid]
	,[ibpid_conv] = cdc.[ibpid_conv]
	,[ibjobn] = cdc.[ibjobn]
	,[ibjobn_conv] = cdc.[ibjobn_conv]
	,[ibupmj] = cdc.[ibupmj]
	,[ibupmj_conv] = cdc.[ibupmj_conv]
	,[ibtday] = cdc.[ibtday]
	,[ibtfla] = cdc.[ibtfla]
	,[ibcomh] = cdc.[ibcomh]
	,[ibavrt] = cdc.[ibavrt]
	,[ibavrt_conv] = cdc.[ibavrt_conv]
	,[ibpoc] = cdc.[ibpoc]
	,[ibaing] = cdc.[ibaing]
	,[ibaing_conv] = cdc.[ibaing_conv]
	,[ibbbdd] = cdc.[ibbbdd]
	,[ibbbdd_conv] = cdc.[ibbbdd_conv]
	,[ibcmdm] = cdc.[ibcmdm]
	,[iblecm] = cdc.[iblecm]
	,[ibledd] = cdc.[ibledd]
	,[ibledd_conv] = cdc.[ibledd_conv]
	,[ibmlot] = cdc.[ibmlot]
	,[ibmlot_conv] = cdc.[ibmlot_conv]
	,[ibpefd] = cdc.[ibpefd]
	,[ibpefd_conv] = cdc.[ibpefd_conv]
	,[ibsbdd] = cdc.[ibsbdd]
	,[ibsbdd_conv] = cdc.[ibsbdd_conv]
	,[ibu1dd] = cdc.[ibu1dd]
	,[ibu1dd_conv] = cdc.[ibu1dd_conv]
	,[ibu2dd] = cdc.[ibu2dd]
	,[ibu2dd_conv] = cdc.[ibu2dd_conv]
	,[ibu3dd] = cdc.[ibu3dd]
	,[ibu3dd_conv] = cdc.[ibu3dd_conv]
	,[ibu4dd] = cdc.[ibu4dd]
	,[ibu4dd_conv] = cdc.[ibu4dd_conv]
	,[ibu5dd] = cdc.[ibu5dd]
	,[ibu5dd_conv] = cdc.[ibu5dd_conv]
	,[ibxdck] = cdc.[ibxdck]
	,[ibxdck_conv] = cdc.[ibxdck_conv]
	,[iblaf] = cdc.[iblaf]
	,[iblaf_conv] = cdc.[iblaf_conv]
	,[ibltfm] = cdc.[ibltfm]
	,[ibltfm_conv] = cdc.[ibltfm_conv]
	,[ibrwla] = cdc.[ibrwla]
	,[ibrwla_conv] = cdc.[ibrwla_conv]
	,[iblnpa] = cdc.[iblnpa]
	,[iblnpa_conv] = cdc.[iblnpa_conv]
	,[iblotc] = cdc.[iblotc]
	,[iblotc_conv] = cdc.[iblotc_conv]
	,[ibapsc] = cdc.[ibapsc]
	,[ibpri1] = cdc.[ibpri1]
	,[ibpri1_conv] = cdc.[ibpri1_conv]
	,[ibpri2] = cdc.[ibpri2]
	,[ibpri2_conv] = cdc.[ibpri2_conv]
	,[ibltcv] = cdc.[ibltcv]
	,[ibltcv_conv] = cdc.[ibltcv_conv]
	,[ibashl] = cdc.[ibashl]
	,[ibashl_conv] = cdc.[ibashl_conv]
	,[ibopth] = cdc.[ibopth]
	,[ibopth_conv] = cdc.[ibopth_conv]
	,[ibcuth] = cdc.[ibcuth]
	,[ibcuth_conv] = cdc.[ibcuth_conv]
	,[ibumth] = cdc.[ibumth]
	,[iblmfg] = cdc.[iblmfg]
	,[iblmfg_conv] = cdc.[iblmfg_conv]
	,[ibline] = cdc.[ibline]
	,[ibline_conv] = cdc.[ibline_conv]
	,[ibdftpct] = cdc.[ibdftpct]
	,[ibdftpct_conv] = cdc.[ibdftpct_conv]
	,[ibkbit] = cdc.[ibkbit]
	,[ibkbit_conv] = cdc.[ibkbit_conv]
	,[ibdfenditm] = cdc.[ibdfenditm]
	,[ibdfenditm_conv] = cdc.[ibdfenditm_conv]
	,[ibkanexll] = cdc.[ibkanexll]
	,[ibkanexll_conv] = cdc.[ibkanexll_conv]
	,[ibscpsell] = cdc.[ibscpsell]
	,[ibmopth] = cdc.[ibmopth]
	,[ibmopth_conv] = cdc.[ibmopth_conv]
	,[ibmcuth] = cdc.[ibmcuth]
	,[ibmcuth_conv] = cdc.[ibmcuth_conv]
	,[ibcumth] = cdc.[ibcumth]
	,[ibatprn] = cdc.[ibatprn]
	,[ibatprn_conv] = cdc.[ibatprn_conv]
	,[ibatpca] = cdc.[ibatpca]
	,[ibatpac] = cdc.[ibatpac]
	,[ibcoore] = cdc.[ibcoore]
	,[ibcoore_conv] = cdc.[ibcoore_conv]
	,[ibvcpfc] = cdc.[ibvcpfc]
	,[ibpnyn] = cdc.[ibpnyn]
	,[ibpnyn_conv] = cdc.[ibpnyn_conv] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f4102_cdc cdc
WHERE
    rep_jde_qat.f4102_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f4102_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f4102_new AF:{{ task_instance_key_str }}' ) 
