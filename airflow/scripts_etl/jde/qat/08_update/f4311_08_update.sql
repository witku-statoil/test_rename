-- Apply updates from upsert table onto rep new table
UPDATE rep_jde_qat.f4311_new
SET
	[sys_file_name] = cdc.[sys_file_name]
	,[sys_file_ln] = cdc.[sys_file_ln]
	,[sys_extract_dt] = cdc.[sys_extract_dt]
	,[sys_cdc_dt] = cdc.[sys_cdc_dt]
	,[sys_cdc_scn] = cdc.[sys_cdc_scn]
	,[sys_cdc_operation_type] = cdc.[sys_cdc_operation_type]
	,[sys_cdc_before_after] = cdc.[sys_cdc_before_after]
	,[sys_line_modified_ind] = cdc.[sys_line_modified_ind]
	,[pdkcoo] = cdc.[pdkcoo]
	,[pdkcoo_conv] = cdc.[pdkcoo_conv]
	,[pddoco] = cdc.[pddoco]
	,[pddcto] = cdc.[pddcto]
	,[pdsfxo] = cdc.[pdsfxo]
	,[pdsfxo_conv] = cdc.[pdsfxo_conv]
	,[pdlnid] = cdc.[pdlnid]
	,[pdlnid_conv] = cdc.[pdlnid_conv]
	,[pdmcu] = cdc.[pdmcu]
	,[pdmcu_conv] = cdc.[pdmcu_conv]
	,[pdco] = cdc.[pdco]
	,[pdco_conv] = cdc.[pdco_conv]
	,[pdokco] = cdc.[pdokco]
	,[pdokco_conv] = cdc.[pdokco_conv]
	,[pdoorn] = cdc.[pdoorn]
	,[pdoorn_conv] = cdc.[pdoorn_conv]
	,[pdocto] = cdc.[pdocto]
	,[pdogno] = cdc.[pdogno]
	,[pdogno_conv] = cdc.[pdogno_conv]
	,[pdrkco] = cdc.[pdrkco]
	,[pdrkco_conv] = cdc.[pdrkco_conv]
	,[pdrorn] = cdc.[pdrorn]
	,[pdrorn_conv] = cdc.[pdrorn_conv]
	,[pdrcto] = cdc.[pdrcto]
	,[pdrlln] = cdc.[pdrlln]
	,[pdrlln_conv] = cdc.[pdrlln_conv]
	,[pddmct] = cdc.[pddmct]
	,[pddmct_conv] = cdc.[pddmct_conv]
	,[pddmcs] = cdc.[pddmcs]
	,[pdbalu] = cdc.[pdbalu]
	,[pdbalu_conv] = cdc.[pdbalu_conv]
	,[pdan8] = cdc.[pdan8]
	,[pdshan] = cdc.[pdshan]
	,[pddrqj] = cdc.[pddrqj]
	,[pddrqj_conv] = cdc.[pddrqj_conv]
	,[pdtrdj] = cdc.[pdtrdj]
	,[pdtrdj_conv] = cdc.[pdtrdj_conv]
	,[pdpddj] = cdc.[pdpddj]
	,[pdpddj_conv] = cdc.[pdpddj_conv]
	,[pdopdj] = cdc.[pdopdj]
	,[pdopdj_conv] = cdc.[pdopdj_conv]
	,[pdaddj] = cdc.[pdaddj]
	,[pdaddj_conv] = cdc.[pdaddj_conv]
	,[pdcndj] = cdc.[pdcndj]
	,[pdcndj_conv] = cdc.[pdcndj_conv]
	,[pdpefj] = cdc.[pdpefj]
	,[pdpefj_conv] = cdc.[pdpefj_conv]
	,[pdppdj] = cdc.[pdppdj]
	,[pdppdj_conv] = cdc.[pdppdj_conv]
	,[pdpsdj] = cdc.[pdpsdj]
	,[pdpsdj_conv] = cdc.[pdpsdj_conv]
	,[pddsvj] = cdc.[pddsvj]
	,[pddsvj_conv] = cdc.[pddsvj_conv]
	,[pddgl] = cdc.[pddgl]
	,[pddgl_conv] = cdc.[pddgl_conv]
	,[pdpn] = cdc.[pdpn]
	,[pdvr01] = cdc.[pdvr01]
	,[pdvr01_conv] = cdc.[pdvr01_conv]
	,[pdvr02] = cdc.[pdvr02]
	,[pdvr02_conv] = cdc.[pdvr02_conv]
	,[pditm] = cdc.[pditm]
	,[pdlitm] = cdc.[pdlitm]
	,[pdlitm_conv] = cdc.[pdlitm_conv]
	,[pdaitm] = cdc.[pdaitm]
	,[pdaitm_conv] = cdc.[pdaitm_conv]
	,[pdlocn] = cdc.[pdlocn]
	,[pdlocn_conv] = cdc.[pdlocn_conv]
	,[pdlotn] = cdc.[pdlotn]
	,[pdlotn_conv] = cdc.[pdlotn_conv]
	,[pdfrgd] = cdc.[pdfrgd]
	,[pdthgd] = cdc.[pdthgd]
	,[pdfrmp] = cdc.[pdfrmp]
	,[pdfrmp_conv] = cdc.[pdfrmp_conv]
	,[pdthrp] = cdc.[pdthrp]
	,[pdthrp_conv] = cdc.[pdthrp_conv]
	,[pddsc1] = cdc.[pddsc1]
	,[pddsc1_conv] = cdc.[pddsc1_conv]
	,[pddsc2] = cdc.[pddsc2]
	,[pddsc2_conv] = cdc.[pddsc2_conv]
	,[pdlnty] = cdc.[pdlnty]
	,[pdlnty_conv] = cdc.[pdlnty_conv]
	,[pdnxtr] = cdc.[pdnxtr]
	,[pdlttr] = cdc.[pdlttr]
	,[pdrlit] = cdc.[pdrlit]
	,[pdrlit_conv] = cdc.[pdrlit_conv]
	,[pdpds1] = cdc.[pdpds1]
	,[pdpds1_conv] = cdc.[pdpds1_conv]
	,[pdpds2] = cdc.[pdpds2]
	,[pdpds2_conv] = cdc.[pdpds2_conv]
	,[pdpds3] = cdc.[pdpds3]
	,[pdpds3_conv] = cdc.[pdpds3_conv]
	,[pdpds4] = cdc.[pdpds4]
	,[pdpds4_conv] = cdc.[pdpds4_conv]
	,[pdpds5] = cdc.[pdpds5]
	,[pdpds5_conv] = cdc.[pdpds5_conv]
	,[pdpdp1] = cdc.[pdpdp1]
	,[pdpdp2] = cdc.[pdpdp2]
	,[pdpdp3] = cdc.[pdpdp3]
	,[pdpdp4] = cdc.[pdpdp4]
	,[pdpdp5] = cdc.[pdpdp5]
	,[pduom] = cdc.[pduom]
	,[pduorg] = cdc.[pduorg]
	,[pduorg_conv] = cdc.[pduorg_conv]
	,[pduchg] = cdc.[pduchg]
	,[pduchg_conv] = cdc.[pduchg_conv]
	,[pduopn] = cdc.[pduopn]
	,[pduopn_conv] = cdc.[pduopn_conv]
	,[pdurec] = cdc.[pdurec]
	,[pdurec_conv] = cdc.[pdurec_conv]
	,[pdcrec] = cdc.[pdcrec]
	,[pdcrec_conv] = cdc.[pdcrec_conv]
	,[pdurlv] = cdc.[pdurlv]
	,[pdurlv_conv] = cdc.[pdurlv_conv]
	,[pdotqy] = cdc.[pdotqy]
	,[pdprrc] = cdc.[pdprrc]
	,[pdprrc_conv] = cdc.[pdprrc_conv]
	,[pdaexp] = cdc.[pdaexp]
	,[pdaexp_conv] = cdc.[pdaexp_conv]
	,[pdachg] = cdc.[pdachg]
	,[pdachg_conv] = cdc.[pdachg_conv]
	,[pdaopn] = cdc.[pdaopn]
	,[pdaopn_conv] = cdc.[pdaopn_conv]
	,[pdarec] = cdc.[pdarec]
	,[pdarec_conv] = cdc.[pdarec_conv]
	,[pdarlv] = cdc.[pdarlv]
	,[pdarlv_conv] = cdc.[pdarlv_conv]
	,[pdftn1] = cdc.[pdftn1]
	,[pdftn1_conv] = cdc.[pdftn1_conv]
	,[pdtrlv] = cdc.[pdtrlv]
	,[pdtrlv_conv] = cdc.[pdtrlv_conv]
	,[pdprov] = cdc.[pdprov]
	,[pdprov_conv] = cdc.[pdprov_conv]
	,[pdamc3] = cdc.[pdamc3]
	,[pdamc3_conv] = cdc.[pdamc3_conv]
	,[pdecst] = cdc.[pdecst]
	,[pdecst_conv] = cdc.[pdecst_conv]
	,[pdcsto] = cdc.[pdcsto]
	,[pdcsto_conv] = cdc.[pdcsto_conv]
	,[pdcsmp] = cdc.[pdcsmp]
	,[pdcsmp_conv] = cdc.[pdcsmp_conv]
	,[pdinmg] = cdc.[pdinmg]
	,[pdasn] = cdc.[pdasn]
	,[pdprgr] = cdc.[pdprgr]
	,[pdclvl] = cdc.[pdclvl]
	,[pdclvl_conv] = cdc.[pdclvl_conv]
	,[pdcatn] = cdc.[pdcatn]
	,[pddspr] = cdc.[pddspr]
	,[pddspr_conv] = cdc.[pddspr_conv]
	,[pdptc] = cdc.[pdptc]
	,[pdptc_conv] = cdc.[pdptc_conv]
	,[pdtx] = cdc.[pdtx]
	,[pdexr1] = cdc.[pdexr1]
	,[pdtxa1] = cdc.[pdtxa1]
	,[pdtxa1_conv] = cdc.[pdtxa1_conv]
	,[pdatxt] = cdc.[pdatxt]
	,[pdatxt_conv] = cdc.[pdatxt_conv]
	,[pdcnid] = cdc.[pdcnid]
	,[pdcnid_conv] = cdc.[pdcnid_conv]
	,[pdcdcd] = cdc.[pdcdcd]
	,[pdcdcd_conv] = cdc.[pdcdcd_conv]
	,[pdntr] = cdc.[pdntr]
	,[pdfrth] = cdc.[pdfrth]
	,[pdfrtc] = cdc.[pdfrtc]
	,[pdfrtc_conv] = cdc.[pdfrtc_conv]
	,[pdzon] = cdc.[pdzon]
	,[pdfrat] = cdc.[pdfrat]
	,[pdratt] = cdc.[pdratt]
	,[pdratt_conv] = cdc.[pdratt_conv]
	,[pdanby] = cdc.[pdanby]
	,[pdancr] = cdc.[pdancr]
	,[pdmot] = cdc.[pdmot]
	,[pdcot] = cdc.[pdcot]
	,[pdshcm] = cdc.[pdshcm]
	,[pdshcn] = cdc.[pdshcn]
	,[pduom1] = cdc.[pduom1]
	,[pdpqor] = cdc.[pdpqor]
	,[pdpqor_conv] = cdc.[pdpqor_conv]
	,[pduom2] = cdc.[pduom2]
	,[pdsqor] = cdc.[pdsqor]
	,[pdsqor_conv] = cdc.[pdsqor_conv]
	,[pduom3] = cdc.[pduom3]
	,[pditwt] = cdc.[pditwt]
	,[pditwt_conv] = cdc.[pditwt_conv]
	,[pdwtum] = cdc.[pdwtum]
	,[pditvl] = cdc.[pditvl]
	,[pditvl_conv] = cdc.[pditvl_conv]
	,[pdvlum] = cdc.[pdvlum]
	,[pdglc] = cdc.[pdglc]
	,[pdglc_conv] = cdc.[pdglc_conv]
	,[pdctry] = cdc.[pdctry]
	,[pdfy] = cdc.[pdfy]
	,[pdfy_conv] = cdc.[pdfy_conv]
	,[pdstts] = cdc.[pdstts]
	,[pdstts_conv] = cdc.[pdstts_conv]
	,[pdrcd] = cdc.[pdrcd]
	,[pdfuf1] = cdc.[pdfuf1]
	,[pdfuf2] = cdc.[pdfuf2]
	,[pdfuf2_conv] = cdc.[pdfuf2_conv]
	,[pdgrwt] = cdc.[pdgrwt]
	,[pdgrwt_conv] = cdc.[pdgrwt_conv]
	,[pdgwum] = cdc.[pdgwum]
	,[pdlt] = cdc.[pdlt]
	,[pdani] = cdc.[pdani]
	,[pdani_conv] = cdc.[pdani_conv]
	,[pdaid] = cdc.[pdaid]
	,[pdaid_conv] = cdc.[pdaid_conv]
	,[pdomcu] = cdc.[pdomcu]
	,[pdomcu_conv] = cdc.[pdomcu_conv]
	,[pdobj] = cdc.[pdobj]
	,[pdobj_conv] = cdc.[pdobj_conv]
	,[pdsub] = cdc.[pdsub]
	,[pdsub_conv] = cdc.[pdsub_conv]
	,[pdsblt] = cdc.[pdsblt]
	,[pdsbl] = cdc.[pdsbl]
	,[pdsbl_conv] = cdc.[pdsbl_conv]
	,[pdasid] = cdc.[pdasid]
	,[pdasid_conv] = cdc.[pdasid_conv]
	,[pdccmp] = cdc.[pdccmp]
	,[pdccmp_conv] = cdc.[pdccmp_conv]
	,[pdtag] = cdc.[pdtag]
	,[pdtag_conv] = cdc.[pdtag_conv]
	,[pdwr01] = cdc.[pdwr01]
	,[pdpl] = cdc.[pdpl]
	,[pdpl_conv] = cdc.[pdpl_conv]
	,[pdelev] = cdc.[pdelev]
	,[pdelev_conv] = cdc.[pdelev_conv]
	,[pdr001] = cdc.[pdr001]
	,[pdrtnr] = cdc.[pdrtnr]
	,[pdrtnr_conv] = cdc.[pdrtnr_conv]
	,[pdlcod] = cdc.[pdlcod]
	,[pdpurg] = cdc.[pdpurg]
	,[pdpurg_conv] = cdc.[pdpurg_conv]
	,[pdprom] = cdc.[pdprom]
	,[pdfnlp] = cdc.[pdfnlp]
	,[pdfnlp_conv] = cdc.[pdfnlp_conv]
	,[pdavch] = cdc.[pdavch]
	,[pdprpy] = cdc.[pdprpy]
	,[pdprpy_conv] = cdc.[pdprpy_conv]
	,[pduncd] = cdc.[pduncd]
	,[pdmaty] = cdc.[pdmaty]
	,[pdrtgc] = cdc.[pdrtgc]
	,[pdrtgc_conv] = cdc.[pdrtgc_conv]
	,[pdrcpf] = cdc.[pdrcpf]
	,[pdrcpf_conv] = cdc.[pdrcpf_conv]
	,[pdps01] = cdc.[pdps01]
	,[pdps01_conv] = cdc.[pdps01_conv]
	,[pdps02] = cdc.[pdps02]
	,[pdps02_conv] = cdc.[pdps02_conv]
	,[pdps03] = cdc.[pdps03]
	,[pdps03_conv] = cdc.[pdps03_conv]
	,[pdps04] = cdc.[pdps04]
	,[pdps04_conv] = cdc.[pdps04_conv]
	,[pdps05] = cdc.[pdps05]
	,[pdps05_conv] = cdc.[pdps05_conv]
	,[pdps06] = cdc.[pdps06]
	,[pdps06_conv] = cdc.[pdps06_conv]
	,[pdps07] = cdc.[pdps07]
	,[pdps07_conv] = cdc.[pdps07_conv]
	,[pdps08] = cdc.[pdps08]
	,[pdps08_conv] = cdc.[pdps08_conv]
	,[pdps09] = cdc.[pdps09]
	,[pdps09_conv] = cdc.[pdps09_conv]
	,[pdps10] = cdc.[pdps10]
	,[pdps10_conv] = cdc.[pdps10_conv]
	,[pdcrmd] = cdc.[pdcrmd]
	,[pdartg] = cdc.[pdartg]
	,[pdartg_conv] = cdc.[pdartg_conv]
	,[pdcord] = cdc.[pdcord]
	,[pdchdt] = cdc.[pdchdt]
	,[pddocc] = cdc.[pddocc]
	,[pdchln] = cdc.[pdchln]
	,[pdchln_conv] = cdc.[pdchln_conv]
	,[pdcrcd] = cdc.[pdcrcd]
	,[pdcrcd_conv] = cdc.[pdcrcd_conv]
	,[pdcrr] = cdc.[pdcrr]
	,[pdfrrc] = cdc.[pdfrrc]
	,[pdfrrc_conv] = cdc.[pdfrrc_conv]
	,[pdfea] = cdc.[pdfea]
	,[pdfea_conv] = cdc.[pdfea_conv]
	,[pdfuc] = cdc.[pdfuc]
	,[pdfuc_conv] = cdc.[pdfuc_conv]
	,[pdfec] = cdc.[pdfec]
	,[pdfec_conv] = cdc.[pdfec_conv]
	,[pdfchg] = cdc.[pdfchg]
	,[pdfchg_conv] = cdc.[pdfchg_conv]
	,[pdfap] = cdc.[pdfap]
	,[pdfap_conv] = cdc.[pdfap_conv]
	,[pdfrec] = cdc.[pdfrec]
	,[pdfrec_conv] = cdc.[pdfrec_conv]
	,[pdurcd] = cdc.[pdurcd]
	,[pdurcd_conv] = cdc.[pdurcd_conv]
	,[pdurdt] = cdc.[pdurdt]
	,[pdurdt_conv] = cdc.[pdurdt_conv]
	,[pdurat] = cdc.[pdurat]
	,[pdurat_conv] = cdc.[pdurat_conv]
	,[pdurab] = cdc.[pdurab]
	,[pdurab_conv] = cdc.[pdurab_conv]
	,[pdurrf] = cdc.[pdurrf]
	,[pdurrf_conv] = cdc.[pdurrf_conv]
	,[pdtorg] = cdc.[pdtorg]
	,[pdtorg_conv] = cdc.[pdtorg_conv]
	,[pduser] = cdc.[pduser]
	,[pduser_conv] = cdc.[pduser_conv]
	,[pdpid] = cdc.[pdpid]
	,[pdpid_conv] = cdc.[pdpid_conv]
	,[pdjobn] = cdc.[pdjobn]
	,[pdjobn_conv] = cdc.[pdjobn_conv]
	,[pdupmj] = cdc.[pdupmj]
	,[pdupmj_conv] = cdc.[pdupmj_conv]
	,[pdtday] = cdc.[pdtday]
	,[pdvr05] = cdc.[pdvr05]
	,[pdvr05_conv] = cdc.[pdvr05_conv]
	,[pdvr04] = cdc.[pdvr04]
	,[pdvr04_conv] = cdc.[pdvr04_conv]
	,[pdshpn] = cdc.[pdshpn]
	,[pdrsht] = cdc.[pdrsht]
	,[pdrsht_conv] = cdc.[pdrsht_conv]
	,[pdprjm] = cdc.[pdprjm]
	,[pdprjm_conv] = cdc.[pdprjm_conv]
	,[pdosfx] = cdc.[pdosfx]
	,[pdosfx_conv] = cdc.[pdosfx_conv]
	,[pdmerl] = cdc.[pdmerl]
	,[pdmerl_conv] = cdc.[pdmerl_conv]
	,[pdmcln] = cdc.[pdmcln]
	,[pdmcln_conv] = cdc.[pdmcln_conv]
	,[pdmact] = cdc.[pdmact]
	,[pdktln] = cdc.[pdktln]
	,[pdktln_conv] = cdc.[pdktln_conv]
	,[pdftrl] = cdc.[pdftrl]
	,[pdftrl_conv] = cdc.[pdftrl_conv]
	,[pddual] = cdc.[pddual]
	,[pddual_conv] = cdc.[pddual_conv]
	,[pddrqt] = cdc.[pddrqt]
	,[pddlej] = cdc.[pddlej]
	,[pddlej_conv] = cdc.[pddlej_conv]
	,[pdctam] = cdc.[pdctam]
	,[pdctam_conv] = cdc.[pdctam_conv]
	,[pdcpnt] = cdc.[pdcpnt]
	,[pdcht] = cdc.[pdcht]
	,[pdchrt] = cdc.[pdchrt]
	,[pdchrs] = cdc.[pdchrs]
	,[pdchmj] = cdc.[pdchmj]
	,[pdchmj_conv] = cdc.[pdchmj_conv]
	,[pdbcrc] = cdc.[pdbcrc]
	,[pdbcrc_conv] = cdc.[pdbcrc_conv]
	,[pdvr03] = cdc.[pdvr03]
	,[pdvr03_conv] = cdc.[pdvr03_conv]
	,[pdldnm] = cdc.[pdldnm]
	,[pdmkfr] = cdc.[pdmkfr]
	,[pdpmtn] = cdc.[pdpmtn]
	,[pdpmtn_conv] = cdc.[pdpmtn_conv]
	,[pdukid] = cdc.[pdukid]
	,[pdunspsc] = cdc.[pdunspsc]
	,[pdunspsc_conv] = cdc.[pdunspsc_conv]
	,[pdcmdcde] = cdc.[pdcmdcde]
	,[pdcmdcde_conv] = cdc.[pdcmdcde_conv]
	,[pdrsfx] = cdc.[pdrsfx]
	,[pdrsfx_conv] = cdc.[pdrsfx_conv]
	,[pdwvid] = cdc.[pdwvid]
	,[pdwvid_conv] = cdc.[pdwvid_conv]
	,[pdcntrtid] = cdc.[pdcntrtid]
	,[pdcntrtid_conv] = cdc.[pdcntrtid_conv]
	,[pdcntrtdid] = cdc.[pdcntrtdid]
	,[pdmoadj] = cdc.[pdmoadj]
	,[pdmoadj_conv] = cdc.[pdmoadj_conv]
	,[pdpodc01] = cdc.[pdpodc01]
	,[pdpodc02] = cdc.[pdpodc02]
	,[pdpodc03] = cdc.[pdpodc03]
	,[pdpodc04] = cdc.[pdpodc04]
	,[pdjbcd] = cdc.[pdjbcd]
	,[pdsrqty] = cdc.[pdsrqty]
	,[pdsrqty_conv] = cdc.[pdsrqty_conv]
	,[pdsruom] = cdc.[pdsruom]
	,[pdcfgfl] = cdc.[pdcfgfl]
	,[pdcfgfl_conv] = cdc.[pdcfgfl_conv]
	,[pdpmpn] = cdc.[pdpmpn]
	,[pdpmpn_conv] = cdc.[pdpmpn_conv]
	,[pdpns] = cdc.[pdpns] -- exclude distribution column
FROM stg_jde_qat.tmp_upsert_f4311_cdc cdc
WHERE
    rep_jde_qat.f4311_new.sys_integration_id = cdc.sys_integration_id
    AND rep_jde_qat.f4311_new.sys_cdc_scn < cdc.sys_cdc_scn 
OPTION ( LABEL = 'UPDATE_rep_jde_qat.f4311_new AF:{{ task_instance_key_str }}' ) 
